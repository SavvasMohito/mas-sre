identify_ai_security_requirements:
  description: >
    Review the requirements and existing security controls:
    
    Original Requirements:
    {requirements_text}
    
    Requirements Analysis:
    {analyzed_requirements}
    
    Determine if the application involves:
    1. Natural language processing or generation
    2. Large Language Models (LLMs) or AI assistants
    3. Machine learning models or AI-powered features
    4. Chatbots or conversational interfaces
    5. Content generation or summarization
    6. Recommendation systems
    7. Image/video generation or analysis
    
    If AI/ML components are present or likely, identify and recommend controls for:
    - Prompt injection prevention
    - Input validation for AI inputs
    - Output filtering and sanitization
    - Data leakage prevention (PII in training/prompts)
    - Model access controls
    - Rate limiting and abuse prevention
    - Monitoring for adversarial inputs
    - Model versioning and rollback capabilities
    - Supply chain security for models
    - Bias and fairness considerations
  expected_output: >
    A specialized AI/ML security requirements document in JSON format containing:
    - ai_components_detected: List of AI/ML features identified
    - ai_threat_model: Specific threats for each AI component
    - ai_security_controls: Specialized controls for AI/ML risks
    - integration_notes: How AI controls integrate with standard controls
    - monitoring_requirements: AI-specific monitoring and alerting needs
    
    If no AI/ML components detected, return a brief note stating this.
  agent: llm_security_specialist

