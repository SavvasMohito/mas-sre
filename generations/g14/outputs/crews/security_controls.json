{
  "raw": "{\n  \"requirements_mapping\": [\n    {\n      \"high_level_requirement\": \"Role-based access control with Employee, Manager, Delegate, and Administrator roles\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-02\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.\",\n          \"relevance\": \"This control describes the need to manage user accounts and implement role-based access controls which directly maps to defining Employee, Manager, Delegate, and Administrator roles and their lifecycle.\",\n          \"integration_tips\": \"Implement an account management module to create, modify, disable and remove accounts, with role assignment workflows for Employee/Manager/Delegate/Admin. Tie account lifecycle events to HR/ID provider events to auto-deactivate accounts when necessary.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review account management procedures, inspect role assignment workflows, and test create/modify/disable/delete operations for each role; verify role enforcement in code and access control lists.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.1.2\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Access to networks and network services\",\n          \"level\": null,\n          \"requirement\": \"Users shall only be provided with access to the network and network services that they have been specifically authorized to use.\",\n          \"relevance\": \"Ensures that each role is granted only the specific access required, aligning with role separation between Employees, Managers, Delegates and Administrators.\",\n          \"integration_tips\": \"Define an access control policy that enumerates permitted actions for each role and ensure technical enforcement in application and API layers. Maintain documentation linking roles to authorized services and verify provisioning matches policy.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit role-to-permission mappings, perform access control tests (positive and negative) for each role, and verify that unauthorized actions are blocked.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.1\",\n          \"chapter\": \"Authentication Verification Requirements\",\n          \"section\": \"Ensure role-based access control enforcement\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that role-based access control is implemented and enforced server-side.\",\n          \"relevance\": \"Directly mandates server-side enforcement of RBAC which is essential to prevent client-side bypass of role restrictions for Employees, Managers, Delegates and Administrators.\",\n          \"integration_tips\": \"Enforce RBAC checks in server-side business logic and APIs, centralize authorization logic, and avoid relying on client-side UI restrictions. Use policy-driven access checks and test for privilege escalation.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Code review of authorization checks, automated tests simulating role-based access attempts, and penetration testing for role escalation vulnerabilities.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Azure SSO integration for authentication and single sign-on\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.3\",\n          \"chapter\": \"Authentication Verification Requirements\",\n          \"section\": \"Federated Authentication and Single Sign-On\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify correct implementation of federated authentication (SAML, OAuth2/OIDC) and that the application properly validates assertions and tokens from identity providers.\",\n          \"relevance\": \"Azure SSO relies on federated protocols (OIDC/OAuth2/SAML); this control ensures tokens/assertions from Azure AD are validated to prevent impersonation and token forgery.\",\n          \"integration_tips\": \"Use a tested OIDC/SAML library, validate issuer, audience, token signatures and claims, enforce token expiration and revocation, and implement proper redirect URIs. Integrate Azure AD metadata and rotate keys per provider guidance.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review integration code/configuration, verify token validation logic, test with malformed tokens and revoked credentials, and perform federated auth flow penetration testing.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-08\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Identification and Authentication (Non-Organizational Users)\",\n          \"level\": null,\n          \"requirement\": \"The information system supports organizational users leveraging federated identities and authenticates via approved identity providers.\",\n          \"relevance\": \"Specifies support for federated authentication which maps to using Azure AD as the identity provider for SSO.\",\n          \"integration_tips\": \"Document and restrict approved identity providers to Azure AD, ensure trust anchors and metadata are configured, and include fallback/incident procedures for IdP outages.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Validate configuration against Azure AD metadata, test sign-on flows for multiple scenarios (fresh login, SSO, logout), and review IdP trust settings.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.2\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Secure log-on procedures\",\n          \"level\": null,\n          \"requirement\": \"Where required by the business, users shall be provided with a secure log-on procedure which may include SSO solutions.\",\n          \"relevance\": \"Supports SSO as a recognized secure logon mechanism to be used when integrating Azure SSO for authentication.\",\n          \"integration_tips\": \"Ensure SSO configuration follows secure logon procedures, include multi-factor authentication where required, and document SSO use in access control policy.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review secure logon procedure documentation, test SSO flows for MFA and session handling, and confirm configuration meets organizational security requirements.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User management and team hierarchy mapping (assign managers, teams, delegates)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-02\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.\",\n          \"relevance\": \"Account Management covers provisioning and role assignments required for mapping team hierarchies and assigning manager/delegate relationships.\",\n          \"integration_tips\": \"Implement structured account provisioning with attributes for team, manager, and delegate fields; integrate with HR/IdP to synchronize hierarchies and automate lifecycle actions.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Audit provisioning logs, test automated synchronization against HR records, and review the process for creating/updating hierarchical relationships.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.2\",\n          \"chapter\": \"Access control\",\n          \"section\": \"User access provisioning\",\n          \"level\": null,\n          \"requirement\": \"The allocation and use of privileges shall be restricted and controlled. A formal user access provisioning process shall be implemented to assign roles and privileges.\",\n          \"relevance\": \"Formal provisioning is needed to ensure teams and managers are assigned consistent privileges and that delegation is controlled.\",\n          \"integration_tips\": \"Establish documented provisioning procedures, include approvals for manager/delegate assignments, and implement access reviews to validate team mappings periodically.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review provisioning workflow documentation, sample user profiles for correct team/manager attributes, and examine periodic access review records.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.5\",\n          \"chapter\": \"Authentication and Session Management\",\n          \"section\": \"Account and user management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that user account management functions (create, update, disable, delete) are implemented with role-based constraints and administrative controls.\",\n          \"relevance\": \"Mandates secure account management features which are necessary to implement hierarchical relationships and delegation safely.\",\n          \"integration_tips\": \"Provide admin UI/API that enforces role-based constraints, log all changes to user/team assignments, and require approvals for sensitive changes like manager/delegate reassignment.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Code and configuration review of account management APIs, functional tests for reassigning managers/delegates, and logs verifying change history.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Daily and weekly timesheet entry supporting multiple projects/tasks\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-12\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"The information system validates the accuracy and integrity of data inputs and detects input errors or malicious inputs.\",\n          \"relevance\": \"Timesheet entries are user inputs that must be validated for integrity, format and allowed values (projects/tasks) to prevent data corruption or abuse.\",\n          \"integration_tips\": \"Implement server-side validation for project/task identifiers, check hours totals against configured rules, and sanitize inputs to prevent injection or malformed data.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Run automated input validation tests, review validation code, and attempt injection and malformed input tests against timesheet entry endpoints.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.1\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Application Functionality Verification\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify business logic functions, including multi-step workflows and data correctness for application-specific processes like timesheet entries.\",\n          \"relevance\": \"Ensures the application enforces correct business logic for multi-project/task timesheets and captures intended behaviour for daily/weekly entries.\",\n          \"integration_tips\": \"Model workflows for daily/weekly entry, include project/task validation and cross-field checks, and implement unit/integration tests covering typical and edge cases.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional testing of timesheet workflows, review test coverage for multiple projects/tasks, and validate business rule enforcement during entry.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-12\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"User/Device Attribution\",\n          \"level\": null,\n          \"requirement\": \"The system associates user identities with actions, ensuring timesheet entries can be attributed and audited.\",\n          \"relevance\": \"Attribution ensures entries are tied to the submitting user, supporting accountability for daily/weekly timesheet data.\",\n          \"integration_tips\": \"Record user identifiers and session details with each timesheet entry, and ensure audit trails are immutable and retained per policy.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect logs and entries to confirm user attribution fields are recorded and cannot be altered by normal users.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Save draft timesheets with validation preventing submission until required fields completed\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.3\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Input Validation and Business Rules Enforcement\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that input validation and business rule enforcement prevents invalid state transitions (e.g., prevent submission until required fields are completed).\",\n          \"relevance\": \"Directly addresses preventing invalid state transitions between draft and submitted timesheet states until validation passes.\",\n          \"integration_tips\": \"Implement server-side state machine enforcing 'draft' vs 'submitted' states, validate required fields on submission API calls, and disallow client-only validations.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Attempt to submit incomplete drafts via API, review server-side validation code and test state transitions with automated tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"The application checks and validates input data for completeness and correctness before processing or submission.\",\n          \"relevance\": \"Requires completeness checks on inputs which align with preventing submissions of incomplete timesheets.\",\n          \"integration_tips\": \"Enforce required-field checks on submission endpoints, and log validation failures for monitoring and user feedback.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review validation rules, attempt invalid submissions, and confirm server rejects submissions until fields are complete.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure system engineering principles\",\n          \"level\": null,\n          \"requirement\": \"Security requirements for applications including validation and error handling shall be addressed during development.\",\n          \"relevance\": \"Mandates considering validation/error handling in development, ensuring draft-save vs submit behaviors are securely implemented.\",\n          \"integration_tips\": \"Include validation and state-change rules in security requirements, perform threat modeling for state transitions, and include validation tests in CI/CD.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review development artefacts and tests for validation logic and confirm error handling prevents submission of incomplete drafts.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Timesheet submission workflow with submission timestamp and read-only state after submission\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"The information system determines which events (such as submission) are to be audited and records sufficient information including timestamps.\",\n          \"relevance\": \"Specifies that submissions must be audited with timestamps which supports the requirement for submission timestamps.\",\n          \"integration_tips\": \"Record submission events with user ID, timestamp, and submission metadata in an append-only audit log, and ensure timestamp source is trusted (e.g., server time).\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review audit logs for submission events and timestamps; verify logs are tamper-evident and properly correlated to submission records.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.2\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"State Management and Workflow Controls\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that state transitions are enforced server-side and that submitted records become immutable/read-only if required by business rules.\",\n          \"relevance\": \"Directly mandates server-side enforcement of read-only state post-submission to prevent unauthorized edits.\",\n          \"integration_tips\": \"Implement immutability by enforcing access control checks and storing a submitted flag preventing modification; use DB constraints or write-once storage for submitted records.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Attempt to alter a submitted timesheet via UI and API; review server-side checks and database constraints ensuring immutability.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Logging and monitoring\",\n          \"section\": \"Event logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities and timestamps shall be maintained to support later review and investigations.\",\n          \"relevance\": \"Supports retention of submission timestamps and event records to enable audits and investigations for submitted timesheets.\",\n          \"integration_tips\": \"Ensure submission events are logged centrally and retained per retention policy; log who changed status and when.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review logging configuration, confirm logs include submission events/timestamps, and test retention/archival processes.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Approval/rejection workflow for managers and delegates, including comments and logging\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-6\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Review, Analysis, and Reporting\",\n          \"level\": null,\n          \"requirement\": \"The organization reviews and analyzes audit records for indications of inappropriate activity; approvals/rejections should be auditable.\",\n          \"relevance\": \"Mandates auditability of approval/rejection actions which is required for manager/delegate workflows including comments.\",\n          \"integration_tips\": \"Log approval/rejection events with user id, role, timestamp and comment; integrate with audit review processes to detect anomalies in approvals.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect logs for approval/rejection entries, verify comments are stored and reviewers can reconstruct the decision chain.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.2\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Workflow and Authorization Controls\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that workflow actions (approve/reject) are properly authorized, logged, and include support for comments and evidence.\",\n          \"relevance\": \"Specifies that approval actions must be authorized and logged and support comments \u2014 directly mapping to the requirement.\",\n          \"integration_tips\": \"Enforce authorization checks that confirm approver is manager/delegate for the employee, persist comments and evidence, and ensure UI/API present required metadata.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test approval/rejection flows, attempt unauthorized approvals, and review audit entries for comments and evidence retention.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.3\",\n          \"chapter\": \"Operational controls\",\n          \"section\": \"Capacity management\",\n          \"level\": null,\n          \"requirement\": \"Ensure operations are controlled and that changes and approvals are managed and recorded.\",\n          \"relevance\": \"Reinforces operational control over changes and approvals which supports structured approval workflows with logging.\",\n          \"integration_tips\": \"Document approval procedures and ensure system enforces required approvals and captures comments; include these in operational runbooks.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review procedural documents, sample approvals to confirm process adherence, and verify logs for completeness.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Manager delegation with start/end dates, scope of permissions, revocation, and notifications\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-05\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"The organization separates duties of individuals as necessary, and implements delegation controls to define scope and limits of permissions.\",\n          \"relevance\": \"Addresses the need to control delegation scope and ensure duties are appropriately segregated and limited in time and scope.\",\n          \"integration_tips\": \"Implement delegation records with start/end timestamps and scoped permissions; ensure separation-of-duty checks prevent conflict-of-interest delegations.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review delegation records, test enforcement of scope and time boundaries, and perform conflict-of-interest checks.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.5\",\n          \"chapter\": \"Authentication and Session Management\",\n          \"section\": \"Account and Role Management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure that delegation and temporary role assignments are time-bound and auditable, and support revocation.\",\n          \"relevance\": \"Directly requires time-bound delegation, auditable assignments and revocation mechanisms matching the requirement's needs.\",\n          \"integration_tips\": \"Provide UI/APIs to create time-bound delegation entries, implement automatic expiry and immediate revocation endpoints, and generate notifications on changes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Create delegated roles, verify automatic expiry, execute revocation and confirm notifications and audit entries are generated.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.6.1.2\",\n          \"chapter\": \"Organisation of information security\",\n          \"section\": \"Segregation of duties\",\n          \"level\": null,\n          \"requirement\": \"Conflicts of interest are reduced by segregating duties and defining responsibilities, including delegation rules.\",\n          \"relevance\": \"Supports defining delegation rules and responsibilities to reduce conflicts when delegating managerial tasks.\",\n          \"integration_tips\": \"Document delegation policies with approval steps, maintain a registry of active delegations, and send notifications for assignment/revocation.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect delegation registry and policy documents, and confirm notifications are issued on changes.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Holiday and leave request management with leave balance tracking and manager approval\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.7.2.2\",\n          \"chapter\": \"Human resource security\",\n          \"section\": \"During employment\",\n          \"level\": null,\n          \"requirement\": \"Employees should be made aware of information security responsibilities; HR processes should include leave and absence management controls.\",\n          \"relevance\": \"Links HR processes (leave management) with security responsibilities and supports integrating leave tracking securely in systems.\",\n          \"integration_tips\": \"Integrate leave management with HR systems, enforce approval workflows with manager authorization, and protect leave balance data as personal information.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review HR integration points, test leave request workflows and manager approvals, and verify PII protections for leave balances.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-02\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"The information system manages accounts including attributes; systems supporting leave should manage state and approvals.\",\n          \"relevance\": \"Account attributes and state management apply to leave status and approvals linked to user accounts.\",\n          \"integration_tips\": \"Store leave balances as account attributes and enforce manager approval before state changes; log changes for audit.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Examine account attributes for leave balance fields, review approval logs, and confirm state transitions require manager action.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.1\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Application Functionality Verification\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify business processes like leave requests and balance calculations are implemented correctly and prevent abuse.\",\n          \"relevance\": \"Ensures leave balances and approval logic are implemented correctly to prevent fraudulent requests or incorrect balances.\",\n          \"integration_tips\": \"Implement server-side calculation of balances, include checks against overlapping leaves, and require manager approval with audit trail.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional tests of leave balance computations, attempts to bypass approvals, and verify audit trails for approvals.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Public holiday preload and auto-application to timesheets\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.1\",\n          \"chapter\": \"Operational controls\",\n          \"section\": \"Documented operating procedures\",\n          \"level\": null,\n          \"requirement\": \"Operating procedures should be documented; application configuration (like public holidays) must be managed and documented.\",\n          \"relevance\": \"Requires documenting procedures for preloading public holidays and how they are applied to timesheets, useful for configuration control and auditing.\",\n          \"integration_tips\": \"Maintain documented configuration procedures for public holiday datasets, include change approval for holiday lists, and ensure changes are logged and tested.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review documentation, inspect configuration change logs, and verify that holiday preload processes are followed and auditable.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"CM-2\",\n          \"chapter\": \"Configuration Management\",\n          \"section\": \"Baseline Configuration\",\n          \"level\": null,\n          \"requirement\": \"Establish and maintain baseline configurations for information systems including configurable data sets.\",\n          \"relevance\": \"Public holiday datasets are configurable data; baselining ensures controlled updates and integrity of this data.\",\n          \"integration_tips\": \"Treat public holiday data as configuration items with versioning, approvals for changes, and rollback procedures for erroneous updates.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect configuration baselines and version history for holiday data and test rollback and update processes.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.1\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Application Functionality Verification\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify system-provided data and configurable presets (e.g., public holidays) are applied consistently and cannot be tampered with by unauthorized users.\",\n          \"relevance\": \"Ensures preloaded public holiday data cannot be altered by unprivileged users and is applied consistently to timesheets.\",\n          \"integration_tips\": \"Restrict modification of holiday data to administrators, sign or checksum holiday datasets to detect tampering, and log changes with approvals.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt unauthorized modification of holiday data, review access controls, and verify integrity checks for datasets.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Business rules enforcement: configurable workweek, min/max hours, working patterns\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.3\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Input Validation and Business Rules Enforcement\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify business rule enforcement (configurable policies like workweek, min/max hours) is applied server-side and cannot be bypassed.\",\n          \"relevance\": \"Directly maps to ensuring business rules (workweek, hours) are enforced server-side and are configurable in a controlled manner.\",\n          \"integration_tips\": \"Model business rules as policy objects enforced in backend services, provide administrative UI for configuration with approvals, and validate rules on every submission.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test rule configuration changes, attempt to submit timesheets violating rules, and review server-side enforcement in logs and code.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-06\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Least Privilege\",\n          \"level\": null,\n          \"requirement\": \"The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.\",\n          \"relevance\": \"Applies to who can configure business rules; restrict configuration changes to privileged admin roles following least privilege.\",\n          \"integration_tips\": \"Restrict business rule configuration to administrators with documented approvals and enforce separation of duties between config and approval roles.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review role permissions for configuration actions and validate that non-admin users cannot alter business rules.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure system engineering principles\",\n          \"level\": null,\n          \"requirement\": \"Security requirements for applications including enforcement of business rules and validation shall be addressed during development.\",\n          \"relevance\": \"Mandates embedding business rule enforcement into secure development lifecycle to prevent bypasses.\",\n          \"integration_tips\": \"Include business rule enforcement tests in development pipelines and perform security reviews focusing on rule bypass risks.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review secure development artefacts and test suites for business rule enforcement coverage.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Notifications via email for reminders, approval requests, approvals/rejections, and delegation changes\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-4\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information System Monitoring\",\n          \"level\": null,\n          \"requirement\": \"Implement mechanisms to monitor system notifications and ensure integrity of messaging.\",\n          \"relevance\": \"Covers monitoring to ensure notification system integrity and detect anomalies in email delivery for reminders and approvals.\",\n          \"integration_tips\": \"Monitor notification delivery logs, set alerts for failures/unexpected volumes, and ensure traceability from event to sent notification.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review notification logs, monitor alerting, and test end-to-end notification delivery and error handling.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 14.1\",\n          \"chapter\": \"Data Protection\",\n          \"section\": \"Sensitive Data Exposure\",\n          \"level\": \"L1\",\n          \"requirement\": \"Ensure sensitive data transmitted via notifications (email) is protected and minimized (avoid including sensitive data in emails).\",\n          \"relevance\": \"Email notifications often contain PII or timesheet details; this control ensures sensitive content is minimized and protected.\",\n          \"integration_tips\": \"Avoid including sensitive details in emails \u2014 include links to the secure portal instead; if data is sent, use encryption and redaction as appropriate.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit email templates for sensitive content, test that emails contain minimal data and links require authentication to view details.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.10.1.1\",\n          \"chapter\": \"Cryptography\",\n          \"section\": \"Policy on the use of cryptographic controls\",\n          \"level\": null,\n          \"requirement\": \"Use cryptographic controls to protect the confidentiality, integrity and availability of information, including notifications where appropriate.\",\n          \"relevance\": \"Applied to protect content of emails (when sensitive) and ensure SMTP channels or message stores use encryption and integrity controls.\",\n          \"integration_tips\": \"Use TLS for SMTP, sign emails or use secure notification services, and store notification records encrypted if they include PII.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect email transport configuration for TLS, review encryption policy for stored notifications, and test interception resistance.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Reporting: weekly, monthly, and custom time reports for employees and managers\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-03\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access Enforcement\",\n          \"level\": null,\n          \"requirement\": \"The system enforces approved authorizations for logical access to information and system resources (apply to reports and exports).\",\n          \"relevance\": \"Reports and exports must be subject to access enforcement so employees/managers only see authorized data.\",\n          \"integration_tips\": \"Enforce RBAC/attribute-based checks at report generation time, filter results by viewer's team scope and permissions, and restrict export endpoints.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test report access for various roles, attempt to access others' reports, and review enforcement logic in reporting services.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 10.1\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Business Function Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that access control is applied to business functions such as report generation and data exports to ensure only authorized personnel can run them.\",\n          \"relevance\": \"Ensures reporting functions require appropriate authorization and respect role/team boundaries.\",\n          \"integration_tips\": \"Implement authorization checks inline with report generation functions; include masking/aggregation for non-authorized detail levels.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review access control checks in reporting code and attempt to retrieve reports beyond assigned scope.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.1\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Information access restriction\",\n          \"level\": null,\n          \"requirement\": \"Access to information and application system functions should be restricted in accordance with the access control policy (applies to reports and exports).\",\n          \"relevance\": \"Supports restricting access to reports per policy and aligns with data access requirements for managers and employees.\",\n          \"integration_tips\": \"Define report access policies and implement technical controls to restrict data exports and downloaden capabilities to authorized roles only.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit report access policies, review permission enforcement, and test enforcement across report types.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Audit logging of timesheet lifecycle events, approvals/rejections, delegation changes, and admin amendments\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"The information system determines which events (such as timesheet lifecycle events) are to be audited and records them.\",\n          \"relevance\": \"Specifies selecting and recording audit events, directly mapping to timesheet lifecycle and admin actions logging.\",\n          \"integration_tips\": \"Define an audit event catalog for lifecycle events, ensure logs capture user identity, timestamp, action and context, and protect logs from tampering.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review event catalog, examine logs for required events, and confirm tamper-evidence and retention settings.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Logging and monitoring\",\n          \"section\": \"Event logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities and changes shall be maintained to support monitoring and investigation.\",\n          \"relevance\": \"Reinforces maintaining logs for activities like approvals, delegations and admin amendments to support investigations.\",\n          \"integration_tips\": \"Centralize logs, apply access controls to log access, and include procedures for log review and incident correlation.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect centralized log store, test log integrity controls, and review monitoring procedures.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 10.5\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Audit Logging Requirements\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify sufficient logging is implemented to support reconstruction of events such as approvals, rejections and administrative changes.\",\n          \"relevance\": \"Specifies log content and sufficiency for reconstructing events related to timesheet lifecycle and admin changes.\",\n          \"integration_tips\": \"Ensure log entries include actor, timestamp, target resource, previous and new values, and reason/comment where applicable.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Reconstruct sample incidents from logs to ensure all necessary data is present and verify logs against event catalog.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Administrator capabilities to configure system settings, working patterns, public holidays, and amend submitted timesheets\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-5\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"The organization separates duties of individuals as necessary and implements controls over privileged accounts (administrators).\",\n          \"relevance\": \"Requires separation and control of administrative privileges needed for configuration and amendment capabilities.\",\n          \"integration_tips\": \"Apply least privilege for admin roles, segregate duties across multiple admin roles (config vs amendments), and require approvals for high-impact changes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review admin role definitions, test segregation of duties, and inspect authorization requirements for admin actions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.5\",\n          \"chapter\": \"Authentication and Session Management\",\n          \"section\": \"Account and Role Management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify administrative functions are protected and that only authorized administrators can change system configuration and amend data.\",\n          \"relevance\": \"Mandates that admin functions be tightly controlled \u2014 mapping to configuration and amendment capabilities in the requirement.\",\n          \"integration_tips\": \"Protect admin interfaces with strong authentication (MFA), log all admin actions, and require re-authentication or approvals for critical amendments.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test admin access controls, verify MFA enforcement, and review audit records for admin amendments.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.3\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Management of privileged access rights\",\n          \"level\": null,\n          \"requirement\": \"The allocation and use of privileged access rights shall be restricted and controlled.\",\n          \"relevance\": \"Specifies controlling privileged access which is required for admin capabilities to configure and amend submitted timesheets.\",\n          \"integration_tips\": \"Implement privileged access management (PAM) controls for admin accounts, maintain an approval trail for privilege grants, and periodically review privileged accounts.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect PAM configuration and privileged account reviews, and test that privileged operations require appropriate authorization and logging.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Responsive and accessible UI compliant with WCAG guidelines\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 14.2\",\n          \"chapter\": \"Privacy and Integrity\",\n          \"section\": \"Privacy and Accessibility Considerations\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that privacy and accessibility considerations are addressed in application design to prevent exclusion and leakage of private data.\",\n          \"relevance\": \"Addresses accessibility and privacy considerations in UI design; supports WCAG compliance to ensure accessible and privacy-preserving UI.\",\n          \"integration_tips\": \"Include accessibility checks in design and testing, avoid exposing sensitive data in UI components, and follow WCAG guidance for responsive layouts and alternatives.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Perform WCAG conformance testing, accessibility audits, and review UI designs for privacy exposures.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-8\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Information Security Architecture\",\n          \"level\": null,\n          \"requirement\": \"Consider accessibility and usability as part of secure system architecture and design.\",\n          \"relevance\": \"Encourages including accessibility in the security architecture to ensure accessible systems meet security and compliance needs.\",\n          \"integration_tips\": \"Incorporate accessibility requirements into system architecture and threat models, and include assistive technology testing in QA.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Review architecture documents for accessibility considerations and test with assistive technologies.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.1\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure development policy\",\n          \"level\": null,\n          \"requirement\": \"Security and quality requirements for systems (including usability and accessibility) should be defined and implemented.\",\n          \"relevance\": \"Requires defining usability and accessibility as quality/security requirements in development, supporting WCAG compliance.\",\n          \"integration_tips\": \"Document WCAG targets in requirements, perform accessibility testing during development, and maintain remediation plans for issues found.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review requirement documents, test plans, and evidence of WCAG testing and remediation activities.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Data access restrictions based on team hierarchy and least-privilege principles\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-06\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Least Privilege\",\n          \"level\": null,\n          \"requirement\": \"The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.\",\n          \"relevance\": \"Directly requires least-privilege principles be applied to restrict data access per team hierarchy.\",\n          \"integration_tips\": \"Implement attribute-based access controls combining role and team attributes, periodically review privileges, and restrict admin capabilities.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Audit role assignments and permissions, perform privilege escalation tests, and validate enforcement of team-based filters.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.1\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Information access restriction\",\n          \"level\": null,\n          \"requirement\": \"Access to information and application system functions should be restricted in accordance with the access control policy (supports team hierarchy restrictions).\",\n          \"relevance\": \"Mandates access restrictions aligned with policy, supporting hierarchy-based restrictions required by the application.\",\n          \"integration_tips\": \"Define access control policy reflecting team hierarchies and implement enforcement in application and data layers with logging.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review policy and enforcement mechanisms, test cross-team access attempts, and confirm access logs reflect restrictions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 10.1\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Business Function Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify access control is applied to business functions and data based on roles and attributes, supporting least privilege and hierarchical restrictions.\",\n          \"relevance\": \"Specifies applying access control to business functions and data using roles and attributes, essential for team-hierarchy enforcement.\",\n          \"integration_tips\": \"Use centralized policy engine for attribute-based decisions (role + team), apply data filtering at query time, and protect APIs against elevation attempts.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test attribute-based access control decisions in diverse scenarios and review implementation for gaps.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Data retention, encryption, and export capabilities to support compliance and integrations with payroll/HR\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"MP-6\",\n          \"chapter\": \"Media Protection\",\n          \"section\": \"Media Sanitization\",\n          \"level\": null,\n          \"requirement\": \"Protect and sanitize media containing sensitive information prior to disposal; retention policies shall be enforced.\",\n          \"relevance\": \"Covers enforcing retention policies and sanitization for data exported or stored for payroll/HR integrations.\",\n          \"integration_tips\": \"Define retention schedules for timesheet and payroll data, implement scheduled purging and secure disposal, and document retention justifications for compliance.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review retention policies, confirm automated purging processes, and verify proper sanitization/destruction procedures.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.8.3.3\",\n          \"chapter\": \"Asset management\",\n          \"section\": \"Information classification\",\n          \"level\": null,\n          \"requirement\": \"Information shall be handled in accordance with its classification including retention and protection rules; support secure export.\",\n          \"relevance\": \"Requires classifying timesheet/payroll data and handling exports according to classification to meet compliance needs.\",\n          \"integration_tips\": \"Classify data, enforce encryption at rest and in transit for exports, and require contractual/technical controls for HR/payroll integration endpoints.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review classification rules, inspect encryption controls, and test secure export workflows to payroll/HR.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 14.1\",\n          \"chapter\": \"Data Protection\",\n          \"section\": \"Data at Rest and in Transit\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that sensitive data is protected at rest and in transit using appropriate cryptography, and that export mechanisms are secure and auditable.\",\n          \"relevance\": \"Directly addresses encryption and secure export capabilities required for payroll/HR integrations.\",\n          \"integration_tips\": \"Use strong, up-to-date cryptographic algorithms for data at rest and TLS for transports, and log/export events with integrity checks and access controls.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect encryption configurations, test secure export endpoints, and verify audit trails of export operations.\"\n        }\n      ]\n    }\n  ],\n  \"cross_functional_controls\": [\n    {\n      \"control_name\": \"Audit Logging and Monitoring\",\n      \"description\": \"Centralized logging of critical events including account lifecycle, timesheet submissions, approvals, delegations, admin changes, exports and notifications to support investigations and compliance.\",\n      \"applies_to\": [\n        \"All requirements that involve user actions, approvals, delegation, admin changes, submissions and exports\"\n      ],\n      \"implementation_guidance\": \"Implement centralized, tamper-evident logging (SIEM or log store), standardize event schemas (actor, timestamp, action, context), protect log access, and establish log retention and review processes.\"\n    },\n    {\n      \"control_name\": \"Encryption (Data at Rest and in Transit)\",\n      \"description\": \"Protect sensitive timesheet, personal and payroll/HR-related data using strong cryptography while stored and transmitted.\",\n      \"applies_to\": [\n        \"Authentication/SSO tokens, notifications, stored timesheets, exports and integration endpoints\"\n      ],\n      \"implementation_guidance\": \"Use TLS for transport, AES-256 or equivalent for data at rest, manage keys securely (KMS/PAM), and ensure integrations also use encrypted channels and signed payloads.\"\n    },\n    {\n      \"control_name\": \"Access Control and RBAC Enforcement\",\n      \"description\": \"Centralized role-based and attribute-based access control enforcing least privilege across UI, APIs and data layers.\",\n      \"applies_to\": [\n        \"User management, reporting, admin functions, delegation, and data access restrictions\"\n      ],\n      \"implementation_guidance\": \"Use a centralized authorization service/policy engine, enforce checks server-side, maintain role/permission catalog, and require approval workflows for privileged changes.\"\n    },\n    {\n      \"control_name\": \"Secure Development and Business Logic Validation\",\n      \"description\": \"Embed validation, business rule enforcement, and threat modeling into the SDLC to prevent logic bypasses and ensure correct state transitions.\",\n      \"applies_to\": [\n        \"Timesheet entry, draft/save/submit workflows, business rules, holiday application and leave management\"\n      ],\n      \"implementation_guidance\": \"Include server-side validation, automated tests for business rules, code reviews, and include business logic abuse cases in threat models and pentests.\"\n    }\n  ],\n  \"recommended_asvs_level\": \"L2\"\n}",
  "pydantic": {
    "requirements_mapping": [
      {
        "high_level_requirement": "Role-based access control with Employee, Manager, Delegate, and Administrator roles",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-02",
            "chapter": "Access Control",
            "section": "Account Management",
            "level": null,
            "requirement": "The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.",
            "relevance": "This control describes the need to manage user accounts and implement role-based access controls which directly maps to defining Employee, Manager, Delegate, and Administrator roles and their lifecycle.",
            "integration_tips": "Implement an account management module to create, modify, disable and remove accounts, with role assignment workflows for Employee/Manager/Delegate/Admin. Tie account lifecycle events to HR/ID provider events to auto-deactivate accounts when necessary.",
            "priority": "Critical",
            "verification_method": "Review account management procedures, inspect role assignment workflows, and test create/modify/disable/delete operations for each role; verify role enforcement in code and access control lists."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.1.2",
            "chapter": "Access control",
            "section": "Access to networks and network services",
            "level": null,
            "requirement": "Users shall only be provided with access to the network and network services that they have been specifically authorized to use.",
            "relevance": "Ensures that each role is granted only the specific access required, aligning with role separation between Employees, Managers, Delegates and Administrators.",
            "integration_tips": "Define an access control policy that enumerates permitted actions for each role and ensure technical enforcement in application and API layers. Maintain documentation linking roles to authorized services and verify provisioning matches policy.",
            "priority": "High",
            "verification_method": "Audit role-to-permission mappings, perform access control tests (positive and negative) for each role, and verify that unauthorized actions are blocked."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 2.1",
            "chapter": "Authentication Verification Requirements",
            "section": "Ensure role-based access control enforcement",
            "level": "L2",
            "requirement": "Verify that role-based access control is implemented and enforced server-side.",
            "relevance": "Directly mandates server-side enforcement of RBAC which is essential to prevent client-side bypass of role restrictions for Employees, Managers, Delegates and Administrators.",
            "integration_tips": "Enforce RBAC checks in server-side business logic and APIs, centralize authorization logic, and avoid relying on client-side UI restrictions. Use policy-driven access checks and test for privilege escalation.",
            "priority": "Critical",
            "verification_method": "Code review of authorization checks, automated tests simulating role-based access attempts, and penetration testing for role escalation vulnerabilities."
          }
        ]
      },
      {
        "high_level_requirement": "Azure SSO integration for authentication and single sign-on",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "ASVS 2.3",
            "chapter": "Authentication Verification Requirements",
            "section": "Federated Authentication and Single Sign-On",
            "level": "L2",
            "requirement": "Verify correct implementation of federated authentication (SAML, OAuth2/OIDC) and that the application properly validates assertions and tokens from identity providers.",
            "relevance": "Azure SSO relies on federated protocols (OIDC/OAuth2/SAML); this control ensures tokens/assertions from Azure AD are validated to prevent impersonation and token forgery.",
            "integration_tips": "Use a tested OIDC/SAML library, validate issuer, audience, token signatures and claims, enforce token expiration and revocation, and implement proper redirect URIs. Integrate Azure AD metadata and rotate keys per provider guidance.",
            "priority": "Critical",
            "verification_method": "Review integration code/configuration, verify token validation logic, test with malformed tokens and revoked credentials, and perform federated auth flow penetration testing."
          },
          {
            "standard": "NIST",
            "req_id": "IA-08",
            "chapter": "Identification and Authentication",
            "section": "Identification and Authentication (Non-Organizational Users)",
            "level": null,
            "requirement": "The information system supports organizational users leveraging federated identities and authenticates via approved identity providers.",
            "relevance": "Specifies support for federated authentication which maps to using Azure AD as the identity provider for SSO.",
            "integration_tips": "Document and restrict approved identity providers to Azure AD, ensure trust anchors and metadata are configured, and include fallback/incident procedures for IdP outages.",
            "priority": "High",
            "verification_method": "Validate configuration against Azure AD metadata, test sign-on flows for multiple scenarios (fresh login, SSO, logout), and review IdP trust settings."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.4.2",
            "chapter": "Access control",
            "section": "Secure log-on procedures",
            "level": null,
            "requirement": "Where required by the business, users shall be provided with a secure log-on procedure which may include SSO solutions.",
            "relevance": "Supports SSO as a recognized secure logon mechanism to be used when integrating Azure SSO for authentication.",
            "integration_tips": "Ensure SSO configuration follows secure logon procedures, include multi-factor authentication where required, and document SSO use in access control policy.",
            "priority": "High",
            "verification_method": "Review secure logon procedure documentation, test SSO flows for MFA and session handling, and confirm configuration meets organizational security requirements."
          }
        ]
      },
      {
        "high_level_requirement": "User management and team hierarchy mapping (assign managers, teams, delegates)",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-02",
            "chapter": "Access Control",
            "section": "Account Management",
            "level": null,
            "requirement": "The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.",
            "relevance": "Account Management covers provisioning and role assignments required for mapping team hierarchies and assigning manager/delegate relationships.",
            "integration_tips": "Implement structured account provisioning with attributes for team, manager, and delegate fields; integrate with HR/IdP to synchronize hierarchies and automate lifecycle actions.",
            "priority": "Critical",
            "verification_method": "Audit provisioning logs, test automated synchronization against HR records, and review the process for creating/updating hierarchical relationships."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.2",
            "chapter": "Access control",
            "section": "User access provisioning",
            "level": null,
            "requirement": "The allocation and use of privileges shall be restricted and controlled. A formal user access provisioning process shall be implemented to assign roles and privileges.",
            "relevance": "Formal provisioning is needed to ensure teams and managers are assigned consistent privileges and that delegation is controlled.",
            "integration_tips": "Establish documented provisioning procedures, include approvals for manager/delegate assignments, and implement access reviews to validate team mappings periodically.",
            "priority": "High",
            "verification_method": "Review provisioning workflow documentation, sample user profiles for correct team/manager attributes, and examine periodic access review records."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 2.5",
            "chapter": "Authentication and Session Management",
            "section": "Account and user management",
            "level": "L2",
            "requirement": "Verify that user account management functions (create, update, disable, delete) are implemented with role-based constraints and administrative controls.",
            "relevance": "Mandates secure account management features which are necessary to implement hierarchical relationships and delegation safely.",
            "integration_tips": "Provide admin UI/API that enforces role-based constraints, log all changes to user/team assignments, and require approvals for sensitive changes like manager/delegate reassignment.",
            "priority": "High",
            "verification_method": "Code and configuration review of account management APIs, functional tests for reassigning managers/delegates, and logs verifying change history."
          }
        ]
      },
      {
        "high_level_requirement": "Daily and weekly timesheet entry supporting multiple projects/tasks",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "SI-12",
            "chapter": "System and Information Integrity",
            "section": "Information Input Validation",
            "level": null,
            "requirement": "The information system validates the accuracy and integrity of data inputs and detects input errors or malicious inputs.",
            "relevance": "Timesheet entries are user inputs that must be validated for integrity, format and allowed values (projects/tasks) to prevent data corruption or abuse.",
            "integration_tips": "Implement server-side validation for project/task identifiers, check hours totals against configured rules, and sanitize inputs to prevent injection or malformed data.",
            "priority": "Critical",
            "verification_method": "Run automated input validation tests, review validation code, and attempt injection and malformed input tests against timesheet entry endpoints."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.1",
            "chapter": "Business Logic Controls",
            "section": "Application Functionality Verification",
            "level": "L2",
            "requirement": "Verify business logic functions, including multi-step workflows and data correctness for application-specific processes like timesheet entries.",
            "relevance": "Ensures the application enforces correct business logic for multi-project/task timesheets and captures intended behaviour for daily/weekly entries.",
            "integration_tips": "Model workflows for daily/weekly entry, include project/task validation and cross-field checks, and implement unit/integration tests covering typical and edge cases.",
            "priority": "High",
            "verification_method": "Functional testing of timesheet workflows, review test coverage for multiple projects/tasks, and validate business rule enforcement during entry."
          },
          {
            "standard": "NIST",
            "req_id": "AU-12",
            "chapter": "Audit and Accountability",
            "section": "User/Device Attribution",
            "level": null,
            "requirement": "The system associates user identities with actions, ensuring timesheet entries can be attributed and audited.",
            "relevance": "Attribution ensures entries are tied to the submitting user, supporting accountability for daily/weekly timesheet data.",
            "integration_tips": "Record user identifiers and session details with each timesheet entry, and ensure audit trails are immutable and retained per policy.",
            "priority": "High",
            "verification_method": "Inspect logs and entries to confirm user attribution fields are recorded and cannot be altered by normal users."
          }
        ]
      },
      {
        "high_level_requirement": "Save draft timesheets with validation preventing submission until required fields completed",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.3",
            "chapter": "Business Logic Controls",
            "section": "Input Validation and Business Rules Enforcement",
            "level": "L2",
            "requirement": "Verify that input validation and business rule enforcement prevents invalid state transitions (e.g., prevent submission until required fields are completed).",
            "relevance": "Directly addresses preventing invalid state transitions between draft and submitted timesheet states until validation passes.",
            "integration_tips": "Implement server-side state machine enforcing 'draft' vs 'submitted' states, validate required fields on submission API calls, and disallow client-only validations.",
            "priority": "Critical",
            "verification_method": "Attempt to submit incomplete drafts via API, review server-side validation code and test state transitions with automated tests."
          },
          {
            "standard": "NIST",
            "req_id": "SI-10",
            "chapter": "System and Information Integrity",
            "section": "Information Input Validation",
            "level": null,
            "requirement": "The application checks and validates input data for completeness and correctness before processing or submission.",
            "relevance": "Requires completeness checks on inputs which align with preventing submissions of incomplete timesheets.",
            "integration_tips": "Enforce required-field checks on submission endpoints, and log validation failures for monitoring and user feedback.",
            "priority": "High",
            "verification_method": "Review validation rules, attempt invalid submissions, and confirm server rejects submissions until fields are complete."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.5",
            "chapter": "System acquisition, development and maintenance",
            "section": "Secure system engineering principles",
            "level": null,
            "requirement": "Security requirements for applications including validation and error handling shall be addressed during development.",
            "relevance": "Mandates considering validation/error handling in development, ensuring draft-save vs submit behaviors are securely implemented.",
            "integration_tips": "Include validation and state-change rules in security requirements, perform threat modeling for state transitions, and include validation tests in CI/CD.",
            "priority": "Medium",
            "verification_method": "Review development artefacts and tests for validation logic and confirm error handling prevents submission of incomplete drafts."
          }
        ]
      },
      {
        "high_level_requirement": "Timesheet submission workflow with submission timestamp and read-only state after submission",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AU-2",
            "chapter": "Audit and Accountability",
            "section": "Audit Events",
            "level": null,
            "requirement": "The information system determines which events (such as submission) are to be audited and records sufficient information including timestamps.",
            "relevance": "Specifies that submissions must be audited with timestamps which supports the requirement for submission timestamps.",
            "integration_tips": "Record submission events with user ID, timestamp, and submission metadata in an append-only audit log, and ensure timestamp source is trusted (e.g., server time).",
            "priority": "Critical",
            "verification_method": "Review audit logs for submission events and timestamps; verify logs are tamper-evident and properly correlated to submission records."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.2",
            "chapter": "Business Logic Controls",
            "section": "State Management and Workflow Controls",
            "level": "L2",
            "requirement": "Verify that state transitions are enforced server-side and that submitted records become immutable/read-only if required by business rules.",
            "relevance": "Directly mandates server-side enforcement of read-only state post-submission to prevent unauthorized edits.",
            "integration_tips": "Implement immutability by enforcing access control checks and storing a submitted flag preventing modification; use DB constraints or write-once storage for submitted records.",
            "priority": "Critical",
            "verification_method": "Attempt to alter a submitted timesheet via UI and API; review server-side checks and database constraints ensuring immutability."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.1",
            "chapter": "Logging and monitoring",
            "section": "Event logging",
            "level": null,
            "requirement": "Event logs recording user activities and timestamps shall be maintained to support later review and investigations.",
            "relevance": "Supports retention of submission timestamps and event records to enable audits and investigations for submitted timesheets.",
            "integration_tips": "Ensure submission events are logged centrally and retained per retention policy; log who changed status and when.",
            "priority": "High",
            "verification_method": "Review logging configuration, confirm logs include submission events/timestamps, and test retention/archival processes."
          }
        ]
      },
      {
        "high_level_requirement": "Approval/rejection workflow for managers and delegates, including comments and logging",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AU-6",
            "chapter": "Audit and Accountability",
            "section": "Audit Review, Analysis, and Reporting",
            "level": null,
            "requirement": "The organization reviews and analyzes audit records for indications of inappropriate activity; approvals/rejections should be auditable.",
            "relevance": "Mandates auditability of approval/rejection actions which is required for manager/delegate workflows including comments.",
            "integration_tips": "Log approval/rejection events with user id, role, timestamp and comment; integrate with audit review processes to detect anomalies in approvals.",
            "priority": "Critical",
            "verification_method": "Inspect logs for approval/rejection entries, verify comments are stored and reviewers can reconstruct the decision chain."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.2",
            "chapter": "Business Logic Controls",
            "section": "Workflow and Authorization Controls",
            "level": "L2",
            "requirement": "Verify that workflow actions (approve/reject) are properly authorized, logged, and include support for comments and evidence.",
            "relevance": "Specifies that approval actions must be authorized and logged and support comments \u2014 directly mapping to the requirement.",
            "integration_tips": "Enforce authorization checks that confirm approver is manager/delegate for the employee, persist comments and evidence, and ensure UI/API present required metadata.",
            "priority": "Critical",
            "verification_method": "Test approval/rejection flows, attempt unauthorized approvals, and review audit entries for comments and evidence retention."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.1.3",
            "chapter": "Operational controls",
            "section": "Capacity management",
            "level": null,
            "requirement": "Ensure operations are controlled and that changes and approvals are managed and recorded.",
            "relevance": "Reinforces operational control over changes and approvals which supports structured approval workflows with logging.",
            "integration_tips": "Document approval procedures and ensure system enforces required approvals and captures comments; include these in operational runbooks.",
            "priority": "High",
            "verification_method": "Review procedural documents, sample approvals to confirm process adherence, and verify logs for completeness."
          }
        ]
      },
      {
        "high_level_requirement": "Manager delegation with start/end dates, scope of permissions, revocation, and notifications",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-05",
            "chapter": "Access Control",
            "section": "Separation of Duties",
            "level": null,
            "requirement": "The organization separates duties of individuals as necessary, and implements delegation controls to define scope and limits of permissions.",
            "relevance": "Addresses the need to control delegation scope and ensure duties are appropriately segregated and limited in time and scope.",
            "integration_tips": "Implement delegation records with start/end timestamps and scoped permissions; ensure separation-of-duty checks prevent conflict-of-interest delegations.",
            "priority": "High",
            "verification_method": "Review delegation records, test enforcement of scope and time boundaries, and perform conflict-of-interest checks."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 2.5",
            "chapter": "Authentication and Session Management",
            "section": "Account and Role Management",
            "level": "L2",
            "requirement": "Ensure that delegation and temporary role assignments are time-bound and auditable, and support revocation.",
            "relevance": "Directly requires time-bound delegation, auditable assignments and revocation mechanisms matching the requirement's needs.",
            "integration_tips": "Provide UI/APIs to create time-bound delegation entries, implement automatic expiry and immediate revocation endpoints, and generate notifications on changes.",
            "priority": "Critical",
            "verification_method": "Create delegated roles, verify automatic expiry, execute revocation and confirm notifications and audit entries are generated."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.6.1.2",
            "chapter": "Organisation of information security",
            "section": "Segregation of duties",
            "level": null,
            "requirement": "Conflicts of interest are reduced by segregating duties and defining responsibilities, including delegation rules.",
            "relevance": "Supports defining delegation rules and responsibilities to reduce conflicts when delegating managerial tasks.",
            "integration_tips": "Document delegation policies with approval steps, maintain a registry of active delegations, and send notifications for assignment/revocation.",
            "priority": "High",
            "verification_method": "Inspect delegation registry and policy documents, and confirm notifications are issued on changes."
          }
        ]
      },
      {
        "high_level_requirement": "Holiday and leave request management with leave balance tracking and manager approval",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "ISO27001",
            "req_id": "A.7.2.2",
            "chapter": "Human resource security",
            "section": "During employment",
            "level": null,
            "requirement": "Employees should be made aware of information security responsibilities; HR processes should include leave and absence management controls.",
            "relevance": "Links HR processes (leave management) with security responsibilities and supports integrating leave tracking securely in systems.",
            "integration_tips": "Integrate leave management with HR systems, enforce approval workflows with manager authorization, and protect leave balance data as personal information.",
            "priority": "Medium",
            "verification_method": "Review HR integration points, test leave request workflows and manager approvals, and verify PII protections for leave balances."
          },
          {
            "standard": "NIST",
            "req_id": "AC-02",
            "chapter": "Access Control",
            "section": "Account Management",
            "level": null,
            "requirement": "The information system manages accounts including attributes; systems supporting leave should manage state and approvals.",
            "relevance": "Account attributes and state management apply to leave status and approvals linked to user accounts.",
            "integration_tips": "Store leave balances as account attributes and enforce manager approval before state changes; log changes for audit.",
            "priority": "High",
            "verification_method": "Examine account attributes for leave balance fields, review approval logs, and confirm state transitions require manager action."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.1",
            "chapter": "Business Logic Controls",
            "section": "Application Functionality Verification",
            "level": "L2",
            "requirement": "Verify business processes like leave requests and balance calculations are implemented correctly and prevent abuse.",
            "relevance": "Ensures leave balances and approval logic are implemented correctly to prevent fraudulent requests or incorrect balances.",
            "integration_tips": "Implement server-side calculation of balances, include checks against overlapping leaves, and require manager approval with audit trail.",
            "priority": "High",
            "verification_method": "Functional tests of leave balance computations, attempts to bypass approvals, and verify audit trails for approvals."
          }
        ]
      },
      {
        "high_level_requirement": "Public holiday preload and auto-application to timesheets",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "ISO27001",
            "req_id": "A.12.1.1",
            "chapter": "Operational controls",
            "section": "Documented operating procedures",
            "level": null,
            "requirement": "Operating procedures should be documented; application configuration (like public holidays) must be managed and documented.",
            "relevance": "Requires documenting procedures for preloading public holidays and how they are applied to timesheets, useful for configuration control and auditing.",
            "integration_tips": "Maintain documented configuration procedures for public holiday datasets, include change approval for holiday lists, and ensure changes are logged and tested.",
            "priority": "Medium",
            "verification_method": "Review documentation, inspect configuration change logs, and verify that holiday preload processes are followed and auditable."
          },
          {
            "standard": "NIST",
            "req_id": "CM-2",
            "chapter": "Configuration Management",
            "section": "Baseline Configuration",
            "level": null,
            "requirement": "Establish and maintain baseline configurations for information systems including configurable data sets.",
            "relevance": "Public holiday datasets are configurable data; baselining ensures controlled updates and integrity of this data.",
            "integration_tips": "Treat public holiday data as configuration items with versioning, approvals for changes, and rollback procedures for erroneous updates.",
            "priority": "High",
            "verification_method": "Inspect configuration baselines and version history for holiday data and test rollback and update processes."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.1",
            "chapter": "Business Logic Controls",
            "section": "Application Functionality Verification",
            "level": "L2",
            "requirement": "Verify system-provided data and configurable presets (e.g., public holidays) are applied consistently and cannot be tampered with by unauthorized users.",
            "relevance": "Ensures preloaded public holiday data cannot be altered by unprivileged users and is applied consistently to timesheets.",
            "integration_tips": "Restrict modification of holiday data to administrators, sign or checksum holiday datasets to detect tampering, and log changes with approvals.",
            "priority": "High",
            "verification_method": "Attempt unauthorized modification of holiday data, review access controls, and verify integrity checks for datasets."
          }
        ]
      },
      {
        "high_level_requirement": "Business rules enforcement: configurable workweek, min/max hours, working patterns",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "ASVS 5.3",
            "chapter": "Business Logic Controls",
            "section": "Input Validation and Business Rules Enforcement",
            "level": "L2",
            "requirement": "Verify business rule enforcement (configurable policies like workweek, min/max hours) is applied server-side and cannot be bypassed.",
            "relevance": "Directly maps to ensuring business rules (workweek, hours) are enforced server-side and are configurable in a controlled manner.",
            "integration_tips": "Model business rules as policy objects enforced in backend services, provide administrative UI for configuration with approvals, and validate rules on every submission.",
            "priority": "Critical",
            "verification_method": "Test rule configuration changes, attempt to submit timesheets violating rules, and review server-side enforcement in logs and code."
          },
          {
            "standard": "NIST",
            "req_id": "AC-06",
            "chapter": "Access Control",
            "section": "Least Privilege",
            "level": null,
            "requirement": "The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.",
            "relevance": "Applies to who can configure business rules; restrict configuration changes to privileged admin roles following least privilege.",
            "integration_tips": "Restrict business rule configuration to administrators with documented approvals and enforce separation of duties between config and approval roles.",
            "priority": "High",
            "verification_method": "Review role permissions for configuration actions and validate that non-admin users cannot alter business rules."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.5",
            "chapter": "System acquisition, development and maintenance",
            "section": "Secure system engineering principles",
            "level": null,
            "requirement": "Security requirements for applications including enforcement of business rules and validation shall be addressed during development.",
            "relevance": "Mandates embedding business rule enforcement into secure development lifecycle to prevent bypasses.",
            "integration_tips": "Include business rule enforcement tests in development pipelines and perform security reviews focusing on rule bypass risks.",
            "priority": "Medium",
            "verification_method": "Review secure development artefacts and test suites for business rule enforcement coverage."
          }
        ]
      },
      {
        "high_level_requirement": "Notifications via email for reminders, approval requests, approvals/rejections, and delegation changes",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "SI-4",
            "chapter": "System and Information Integrity",
            "section": "Information System Monitoring",
            "level": null,
            "requirement": "Implement mechanisms to monitor system notifications and ensure integrity of messaging.",
            "relevance": "Covers monitoring to ensure notification system integrity and detect anomalies in email delivery for reminders and approvals.",
            "integration_tips": "Monitor notification delivery logs, set alerts for failures/unexpected volumes, and ensure traceability from event to sent notification.",
            "priority": "Medium",
            "verification_method": "Review notification logs, monitor alerting, and test end-to-end notification delivery and error handling."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 14.1",
            "chapter": "Data Protection",
            "section": "Sensitive Data Exposure",
            "level": "L1",
            "requirement": "Ensure sensitive data transmitted via notifications (email) is protected and minimized (avoid including sensitive data in emails).",
            "relevance": "Email notifications often contain PII or timesheet details; this control ensures sensitive content is minimized and protected.",
            "integration_tips": "Avoid including sensitive details in emails \u2014 include links to the secure portal instead; if data is sent, use encryption and redaction as appropriate.",
            "priority": "High",
            "verification_method": "Audit email templates for sensitive content, test that emails contain minimal data and links require authentication to view details."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.10.1.1",
            "chapter": "Cryptography",
            "section": "Policy on the use of cryptographic controls",
            "level": null,
            "requirement": "Use cryptographic controls to protect the confidentiality, integrity and availability of information, including notifications where appropriate.",
            "relevance": "Applied to protect content of emails (when sensitive) and ensure SMTP channels or message stores use encryption and integrity controls.",
            "integration_tips": "Use TLS for SMTP, sign emails or use secure notification services, and store notification records encrypted if they include PII.",
            "priority": "High",
            "verification_method": "Inspect email transport configuration for TLS, review encryption policy for stored notifications, and test interception resistance."
          }
        ]
      },
      {
        "high_level_requirement": "Reporting: weekly, monthly, and custom time reports for employees and managers",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-03",
            "chapter": "Access Control",
            "section": "Access Enforcement",
            "level": null,
            "requirement": "The system enforces approved authorizations for logical access to information and system resources (apply to reports and exports).",
            "relevance": "Reports and exports must be subject to access enforcement so employees/managers only see authorized data.",
            "integration_tips": "Enforce RBAC/attribute-based checks at report generation time, filter results by viewer's team scope and permissions, and restrict export endpoints.",
            "priority": "Critical",
            "verification_method": "Test report access for various roles, attempt to access others' reports, and review enforcement logic in reporting services."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 10.1",
            "chapter": "Access Control",
            "section": "Business Function Access Control",
            "level": "L2",
            "requirement": "Verify that access control is applied to business functions such as report generation and data exports to ensure only authorized personnel can run them.",
            "relevance": "Ensures reporting functions require appropriate authorization and respect role/team boundaries.",
            "integration_tips": "Implement authorization checks inline with report generation functions; include masking/aggregation for non-authorized detail levels.",
            "priority": "High",
            "verification_method": "Review access control checks in reporting code and attempt to retrieve reports beyond assigned scope."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.4.1",
            "chapter": "Access control",
            "section": "Information access restriction",
            "level": null,
            "requirement": "Access to information and application system functions should be restricted in accordance with the access control policy (applies to reports and exports).",
            "relevance": "Supports restricting access to reports per policy and aligns with data access requirements for managers and employees.",
            "integration_tips": "Define report access policies and implement technical controls to restrict data exports and downloaden capabilities to authorized roles only.",
            "priority": "High",
            "verification_method": "Audit report access policies, review permission enforcement, and test enforcement across report types."
          }
        ]
      },
      {
        "high_level_requirement": "Audit logging of timesheet lifecycle events, approvals/rejections, delegation changes, and admin amendments",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AU-2",
            "chapter": "Audit and Accountability",
            "section": "Audit Events",
            "level": null,
            "requirement": "The information system determines which events (such as timesheet lifecycle events) are to be audited and records them.",
            "relevance": "Specifies selecting and recording audit events, directly mapping to timesheet lifecycle and admin actions logging.",
            "integration_tips": "Define an audit event catalog for lifecycle events, ensure logs capture user identity, timestamp, action and context, and protect logs from tampering.",
            "priority": "Critical",
            "verification_method": "Review event catalog, examine logs for required events, and confirm tamper-evidence and retention settings."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.1",
            "chapter": "Logging and monitoring",
            "section": "Event logging",
            "level": null,
            "requirement": "Event logs recording user activities and changes shall be maintained to support monitoring and investigation.",
            "relevance": "Reinforces maintaining logs for activities like approvals, delegations and admin amendments to support investigations.",
            "integration_tips": "Centralize logs, apply access controls to log access, and include procedures for log review and incident correlation.",
            "priority": "High",
            "verification_method": "Inspect centralized log store, test log integrity controls, and review monitoring procedures."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 10.5",
            "chapter": "Logging and Monitoring",
            "section": "Audit Logging Requirements",
            "level": "L2",
            "requirement": "Verify sufficient logging is implemented to support reconstruction of events such as approvals, rejections and administrative changes.",
            "relevance": "Specifies log content and sufficiency for reconstructing events related to timesheet lifecycle and admin changes.",
            "integration_tips": "Ensure log entries include actor, timestamp, target resource, previous and new values, and reason/comment where applicable.",
            "priority": "Critical",
            "verification_method": "Reconstruct sample incidents from logs to ensure all necessary data is present and verify logs against event catalog."
          }
        ]
      },
      {
        "high_level_requirement": "Administrator capabilities to configure system settings, working patterns, public holidays, and amend submitted timesheets",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-5",
            "chapter": "Access Control",
            "section": "Separation of Duties",
            "level": null,
            "requirement": "The organization separates duties of individuals as necessary and implements controls over privileged accounts (administrators).",
            "relevance": "Requires separation and control of administrative privileges needed for configuration and amendment capabilities.",
            "integration_tips": "Apply least privilege for admin roles, segregate duties across multiple admin roles (config vs amendments), and require approvals for high-impact changes.",
            "priority": "Critical",
            "verification_method": "Review admin role definitions, test segregation of duties, and inspect authorization requirements for admin actions."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 2.5",
            "chapter": "Authentication and Session Management",
            "section": "Account and Role Management",
            "level": "L2",
            "requirement": "Verify administrative functions are protected and that only authorized administrators can change system configuration and amend data.",
            "relevance": "Mandates that admin functions be tightly controlled \u2014 mapping to configuration and amendment capabilities in the requirement.",
            "integration_tips": "Protect admin interfaces with strong authentication (MFA), log all admin actions, and require re-authentication or approvals for critical amendments.",
            "priority": "Critical",
            "verification_method": "Test admin access controls, verify MFA enforcement, and review audit records for admin amendments."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.3",
            "chapter": "Access control",
            "section": "Management of privileged access rights",
            "level": null,
            "requirement": "The allocation and use of privileged access rights shall be restricted and controlled.",
            "relevance": "Specifies controlling privileged access which is required for admin capabilities to configure and amend submitted timesheets.",
            "integration_tips": "Implement privileged access management (PAM) controls for admin accounts, maintain an approval trail for privilege grants, and periodically review privileged accounts.",
            "priority": "High",
            "verification_method": "Inspect PAM configuration and privileged account reviews, and test that privileged operations require appropriate authorization and logging."
          }
        ]
      },
      {
        "high_level_requirement": "Responsive and accessible UI compliant with WCAG guidelines",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "ASVS 14.2",
            "chapter": "Privacy and Integrity",
            "section": "Privacy and Accessibility Considerations",
            "level": "L1",
            "requirement": "Verify that privacy and accessibility considerations are addressed in application design to prevent exclusion and leakage of private data.",
            "relevance": "Addresses accessibility and privacy considerations in UI design; supports WCAG compliance to ensure accessible and privacy-preserving UI.",
            "integration_tips": "Include accessibility checks in design and testing, avoid exposing sensitive data in UI components, and follow WCAG guidance for responsive layouts and alternatives.",
            "priority": "Medium",
            "verification_method": "Perform WCAG conformance testing, accessibility audits, and review UI designs for privacy exposures."
          },
          {
            "standard": "NIST",
            "req_id": "PL-8",
            "chapter": "Planning",
            "section": "Information Security Architecture",
            "level": null,
            "requirement": "Consider accessibility and usability as part of secure system architecture and design.",
            "relevance": "Encourages including accessibility in the security architecture to ensure accessible systems meet security and compliance needs.",
            "integration_tips": "Incorporate accessibility requirements into system architecture and threat models, and include assistive technology testing in QA.",
            "priority": "Low",
            "verification_method": "Review architecture documents for accessibility considerations and test with assistive technologies."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.1",
            "chapter": "System acquisition, development and maintenance",
            "section": "Secure development policy",
            "level": null,
            "requirement": "Security and quality requirements for systems (including usability and accessibility) should be defined and implemented.",
            "relevance": "Requires defining usability and accessibility as quality/security requirements in development, supporting WCAG compliance.",
            "integration_tips": "Document WCAG targets in requirements, perform accessibility testing during development, and maintain remediation plans for issues found.",
            "priority": "Medium",
            "verification_method": "Review requirement documents, test plans, and evidence of WCAG testing and remediation activities."
          }
        ]
      },
      {
        "high_level_requirement": "Data access restrictions based on team hierarchy and least-privilege principles",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-06",
            "chapter": "Access Control",
            "section": "Least Privilege",
            "level": null,
            "requirement": "The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.",
            "relevance": "Directly requires least-privilege principles be applied to restrict data access per team hierarchy.",
            "integration_tips": "Implement attribute-based access controls combining role and team attributes, periodically review privileges, and restrict admin capabilities.",
            "priority": "Critical",
            "verification_method": "Audit role assignments and permissions, perform privilege escalation tests, and validate enforcement of team-based filters."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.4.1",
            "chapter": "Access control",
            "section": "Information access restriction",
            "level": null,
            "requirement": "Access to information and application system functions should be restricted in accordance with the access control policy (supports team hierarchy restrictions).",
            "relevance": "Mandates access restrictions aligned with policy, supporting hierarchy-based restrictions required by the application.",
            "integration_tips": "Define access control policy reflecting team hierarchies and implement enforcement in application and data layers with logging.",
            "priority": "High",
            "verification_method": "Review policy and enforcement mechanisms, test cross-team access attempts, and confirm access logs reflect restrictions."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 10.1",
            "chapter": "Access Control",
            "section": "Business Function Access Control",
            "level": "L2",
            "requirement": "Verify access control is applied to business functions and data based on roles and attributes, supporting least privilege and hierarchical restrictions.",
            "relevance": "Specifies applying access control to business functions and data using roles and attributes, essential for team-hierarchy enforcement.",
            "integration_tips": "Use centralized policy engine for attribute-based decisions (role + team), apply data filtering at query time, and protect APIs against elevation attempts.",
            "priority": "Critical",
            "verification_method": "Test attribute-based access control decisions in diverse scenarios and review implementation for gaps."
          }
        ]
      },
      {
        "high_level_requirement": "Data retention, encryption, and export capabilities to support compliance and integrations with payroll/HR",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "MP-6",
            "chapter": "Media Protection",
            "section": "Media Sanitization",
            "level": null,
            "requirement": "Protect and sanitize media containing sensitive information prior to disposal; retention policies shall be enforced.",
            "relevance": "Covers enforcing retention policies and sanitization for data exported or stored for payroll/HR integrations.",
            "integration_tips": "Define retention schedules for timesheet and payroll data, implement scheduled purging and secure disposal, and document retention justifications for compliance.",
            "priority": "High",
            "verification_method": "Review retention policies, confirm automated purging processes, and verify proper sanitization/destruction procedures."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.8.3.3",
            "chapter": "Asset management",
            "section": "Information classification",
            "level": null,
            "requirement": "Information shall be handled in accordance with its classification including retention and protection rules; support secure export.",
            "relevance": "Requires classifying timesheet/payroll data and handling exports according to classification to meet compliance needs.",
            "integration_tips": "Classify data, enforce encryption at rest and in transit for exports, and require contractual/technical controls for HR/payroll integration endpoints.",
            "priority": "Critical",
            "verification_method": "Review classification rules, inspect encryption controls, and test secure export workflows to payroll/HR."
          },
          {
            "standard": "OWASP",
            "req_id": "ASVS 14.1",
            "chapter": "Data Protection",
            "section": "Data at Rest and in Transit",
            "level": "L2",
            "requirement": "Verify that sensitive data is protected at rest and in transit using appropriate cryptography, and that export mechanisms are secure and auditable.",
            "relevance": "Directly addresses encryption and secure export capabilities required for payroll/HR integrations.",
            "integration_tips": "Use strong, up-to-date cryptographic algorithms for data at rest and TLS for transports, and log/export events with integrity checks and access controls.",
            "priority": "Critical",
            "verification_method": "Inspect encryption configurations, test secure export endpoints, and verify audit trails of export operations."
          }
        ]
      }
    ],
    "cross_functional_controls": [
      {
        "control_name": "Audit Logging and Monitoring",
        "description": "Centralized logging of critical events including account lifecycle, timesheet submissions, approvals, delegations, admin changes, exports and notifications to support investigations and compliance.",
        "applies_to": [
          "All requirements that involve user actions, approvals, delegation, admin changes, submissions and exports"
        ],
        "implementation_guidance": "Implement centralized, tamper-evident logging (SIEM or log store), standardize event schemas (actor, timestamp, action, context), protect log access, and establish log retention and review processes."
      },
      {
        "control_name": "Encryption (Data at Rest and in Transit)",
        "description": "Protect sensitive timesheet, personal and payroll/HR-related data using strong cryptography while stored and transmitted.",
        "applies_to": [
          "Authentication/SSO tokens, notifications, stored timesheets, exports and integration endpoints"
        ],
        "implementation_guidance": "Use TLS for transport, AES-256 or equivalent for data at rest, manage keys securely (KMS/PAM), and ensure integrations also use encrypted channels and signed payloads."
      },
      {
        "control_name": "Access Control and RBAC Enforcement",
        "description": "Centralized role-based and attribute-based access control enforcing least privilege across UI, APIs and data layers.",
        "applies_to": [
          "User management, reporting, admin functions, delegation, and data access restrictions"
        ],
        "implementation_guidance": "Use a centralized authorization service/policy engine, enforce checks server-side, maintain role/permission catalog, and require approval workflows for privileged changes."
      },
      {
        "control_name": "Secure Development and Business Logic Validation",
        "description": "Embed validation, business rule enforcement, and threat modeling into the SDLC to prevent logic bypasses and ensure correct state transitions.",
        "applies_to": [
          "Timesheet entry, draft/save/submit workflows, business rules, holiday application and leave management"
        ],
        "implementation_guidance": "Include server-side validation, automated tests for business rules, code reviews, and include business logic abuse cases in threat models and pentests."
      }
    ],
    "recommended_asvs_level": "L2"
  },
  "tasks": [
    {
      "name": "map_security_controls",
      "raw": "{\n  \"requirements_mapping\": [\n    {\n      \"high_level_requirement\": \"Role-based access control with Employee, Manager, Delegate, and Administrator roles\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-02\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.\",\n          \"relevance\": \"This control describes the need to manage user accounts and implement role-based access controls which directly maps to defining Employee, Manager, Delegate, and Administrator roles and their lifecycle.\",\n          \"integration_tips\": \"Implement an account management module to create, modify, disable and remove accounts, with role assignment workflows for Employee/Manager/Delegate/Admin. Tie account lifecycle events to HR/ID provider events to auto-deactivate accounts when necessary.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review account management procedures, inspect role assignment workflows, and test create/modify/disable/delete operations for each role; verify role enforcement in code and access control lists.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.1.2\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Access to networks and network services\",\n          \"level\": null,\n          \"requirement\": \"Users shall only be provided with access to the network and network services that they have been specifically authorized to use.\",\n          \"relevance\": \"Ensures that each role is granted only the specific access required, aligning with role separation between Employees, Managers, Delegates and Administrators.\",\n          \"integration_tips\": \"Define an access control policy that enumerates permitted actions for each role and ensure technical enforcement in application and API layers. Maintain documentation linking roles to authorized services and verify provisioning matches policy.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit role-to-permission mappings, perform access control tests (positive and negative) for each role, and verify that unauthorized actions are blocked.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.1\",\n          \"chapter\": \"Authentication Verification Requirements\",\n          \"section\": \"Ensure role-based access control enforcement\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that role-based access control is implemented and enforced server-side.\",\n          \"relevance\": \"Directly mandates server-side enforcement of RBAC which is essential to prevent client-side bypass of role restrictions for Employees, Managers, Delegates and Administrators.\",\n          \"integration_tips\": \"Enforce RBAC checks in server-side business logic and APIs, centralize authorization logic, and avoid relying on client-side UI restrictions. Use policy-driven access checks and test for privilege escalation.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Code review of authorization checks, automated tests simulating role-based access attempts, and penetration testing for role escalation vulnerabilities.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Azure SSO integration for authentication and single sign-on\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.3\",\n          \"chapter\": \"Authentication Verification Requirements\",\n          \"section\": \"Federated Authentication and Single Sign-On\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify correct implementation of federated authentication (SAML, OAuth2/OIDC) and that the application properly validates assertions and tokens from identity providers.\",\n          \"relevance\": \"Azure SSO relies on federated protocols (OIDC/OAuth2/SAML); this control ensures tokens/assertions from Azure AD are validated to prevent impersonation and token forgery.\",\n          \"integration_tips\": \"Use a tested OIDC/SAML library, validate issuer, audience, token signatures and claims, enforce token expiration and revocation, and implement proper redirect URIs. Integrate Azure AD metadata and rotate keys per provider guidance.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review integration code/configuration, verify token validation logic, test with malformed tokens and revoked credentials, and perform federated auth flow penetration testing.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-08\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Identification and Authentication (Non-Organizational Users)\",\n          \"level\": null,\n          \"requirement\": \"The information system supports organizational users leveraging federated identities and authenticates via approved identity providers.\",\n          \"relevance\": \"Specifies support for federated authentication which maps to using Azure AD as the identity provider for SSO.\",\n          \"integration_tips\": \"Document and restrict approved identity providers to Azure AD, ensure trust anchors and metadata are configured, and include fallback/incident procedures for IdP outages.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Validate configuration against Azure AD metadata, test sign-on flows for multiple scenarios (fresh login, SSO, logout), and review IdP trust settings.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.2\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Secure log-on procedures\",\n          \"level\": null,\n          \"requirement\": \"Where required by the business, users shall be provided with a secure log-on procedure which may include SSO solutions.\",\n          \"relevance\": \"Supports SSO as a recognized secure logon mechanism to be used when integrating Azure SSO for authentication.\",\n          \"integration_tips\": \"Ensure SSO configuration follows secure logon procedures, include multi-factor authentication where required, and document SSO use in access control policy.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review secure logon procedure documentation, test SSO flows for MFA and session handling, and confirm configuration meets organizational security requirements.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User management and team hierarchy mapping (assign managers, teams, delegates)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-02\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.\",\n          \"relevance\": \"Account Management covers provisioning and role assignments required for mapping team hierarchies and assigning manager/delegate relationships.\",\n          \"integration_tips\": \"Implement structured account provisioning with attributes for team, manager, and delegate fields; integrate with HR/IdP to synchronize hierarchies and automate lifecycle actions.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Audit provisioning logs, test automated synchronization against HR records, and review the process for creating/updating hierarchical relationships.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.2\",\n          \"chapter\": \"Access control\",\n          \"section\": \"User access provisioning\",\n          \"level\": null,\n          \"requirement\": \"The allocation and use of privileges shall be restricted and controlled. A formal user access provisioning process shall be implemented to assign roles and privileges.\",\n          \"relevance\": \"Formal provisioning is needed to ensure teams and managers are assigned consistent privileges and that delegation is controlled.\",\n          \"integration_tips\": \"Establish documented provisioning procedures, include approvals for manager/delegate assignments, and implement access reviews to validate team mappings periodically.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review provisioning workflow documentation, sample user profiles for correct team/manager attributes, and examine periodic access review records.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.5\",\n          \"chapter\": \"Authentication and Session Management\",\n          \"section\": \"Account and user management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that user account management functions (create, update, disable, delete) are implemented with role-based constraints and administrative controls.\",\n          \"relevance\": \"Mandates secure account management features which are necessary to implement hierarchical relationships and delegation safely.\",\n          \"integration_tips\": \"Provide admin UI/API that enforces role-based constraints, log all changes to user/team assignments, and require approvals for sensitive changes like manager/delegate reassignment.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Code and configuration review of account management APIs, functional tests for reassigning managers/delegates, and logs verifying change history.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Daily and weekly timesheet entry supporting multiple projects/tasks\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-12\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"The information system validates the accuracy and integrity of data inputs and detects input errors or malicious inputs.\",\n          \"relevance\": \"Timesheet entries are user inputs that must be validated for integrity, format and allowed values (projects/tasks) to prevent data corruption or abuse.\",\n          \"integration_tips\": \"Implement server-side validation for project/task identifiers, check hours totals against configured rules, and sanitize inputs to prevent injection or malformed data.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Run automated input validation tests, review validation code, and attempt injection and malformed input tests against timesheet entry endpoints.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.1\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Application Functionality Verification\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify business logic functions, including multi-step workflows and data correctness for application-specific processes like timesheet entries.\",\n          \"relevance\": \"Ensures the application enforces correct business logic for multi-project/task timesheets and captures intended behaviour for daily/weekly entries.\",\n          \"integration_tips\": \"Model workflows for daily/weekly entry, include project/task validation and cross-field checks, and implement unit/integration tests covering typical and edge cases.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional testing of timesheet workflows, review test coverage for multiple projects/tasks, and validate business rule enforcement during entry.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-12\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"User/Device Attribution\",\n          \"level\": null,\n          \"requirement\": \"The system associates user identities with actions, ensuring timesheet entries can be attributed and audited.\",\n          \"relevance\": \"Attribution ensures entries are tied to the submitting user, supporting accountability for daily/weekly timesheet data.\",\n          \"integration_tips\": \"Record user identifiers and session details with each timesheet entry, and ensure audit trails are immutable and retained per policy.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect logs and entries to confirm user attribution fields are recorded and cannot be altered by normal users.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Save draft timesheets with validation preventing submission until required fields completed\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.3\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Input Validation and Business Rules Enforcement\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that input validation and business rule enforcement prevents invalid state transitions (e.g., prevent submission until required fields are completed).\",\n          \"relevance\": \"Directly addresses preventing invalid state transitions between draft and submitted timesheet states until validation passes.\",\n          \"integration_tips\": \"Implement server-side state machine enforcing 'draft' vs 'submitted' states, validate required fields on submission API calls, and disallow client-only validations.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Attempt to submit incomplete drafts via API, review server-side validation code and test state transitions with automated tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"The application checks and validates input data for completeness and correctness before processing or submission.\",\n          \"relevance\": \"Requires completeness checks on inputs which align with preventing submissions of incomplete timesheets.\",\n          \"integration_tips\": \"Enforce required-field checks on submission endpoints, and log validation failures for monitoring and user feedback.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review validation rules, attempt invalid submissions, and confirm server rejects submissions until fields are complete.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure system engineering principles\",\n          \"level\": null,\n          \"requirement\": \"Security requirements for applications including validation and error handling shall be addressed during development.\",\n          \"relevance\": \"Mandates considering validation/error handling in development, ensuring draft-save vs submit behaviors are securely implemented.\",\n          \"integration_tips\": \"Include validation and state-change rules in security requirements, perform threat modeling for state transitions, and include validation tests in CI/CD.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review development artefacts and tests for validation logic and confirm error handling prevents submission of incomplete drafts.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Timesheet submission workflow with submission timestamp and read-only state after submission\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"The information system determines which events (such as submission) are to be audited and records sufficient information including timestamps.\",\n          \"relevance\": \"Specifies that submissions must be audited with timestamps which supports the requirement for submission timestamps.\",\n          \"integration_tips\": \"Record submission events with user ID, timestamp, and submission metadata in an append-only audit log, and ensure timestamp source is trusted (e.g., server time).\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review audit logs for submission events and timestamps; verify logs are tamper-evident and properly correlated to submission records.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.2\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"State Management and Workflow Controls\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that state transitions are enforced server-side and that submitted records become immutable/read-only if required by business rules.\",\n          \"relevance\": \"Directly mandates server-side enforcement of read-only state post-submission to prevent unauthorized edits.\",\n          \"integration_tips\": \"Implement immutability by enforcing access control checks and storing a submitted flag preventing modification; use DB constraints or write-once storage for submitted records.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Attempt to alter a submitted timesheet via UI and API; review server-side checks and database constraints ensuring immutability.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Logging and monitoring\",\n          \"section\": \"Event logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities and timestamps shall be maintained to support later review and investigations.\",\n          \"relevance\": \"Supports retention of submission timestamps and event records to enable audits and investigations for submitted timesheets.\",\n          \"integration_tips\": \"Ensure submission events are logged centrally and retained per retention policy; log who changed status and when.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review logging configuration, confirm logs include submission events/timestamps, and test retention/archival processes.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Approval/rejection workflow for managers and delegates, including comments and logging\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-6\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Review, Analysis, and Reporting\",\n          \"level\": null,\n          \"requirement\": \"The organization reviews and analyzes audit records for indications of inappropriate activity; approvals/rejections should be auditable.\",\n          \"relevance\": \"Mandates auditability of approval/rejection actions which is required for manager/delegate workflows including comments.\",\n          \"integration_tips\": \"Log approval/rejection events with user id, role, timestamp and comment; integrate with audit review processes to detect anomalies in approvals.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect logs for approval/rejection entries, verify comments are stored and reviewers can reconstruct the decision chain.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.2\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Workflow and Authorization Controls\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that workflow actions (approve/reject) are properly authorized, logged, and include support for comments and evidence.\",\n          \"relevance\": \"Specifies that approval actions must be authorized and logged and support comments \u2014 directly mapping to the requirement.\",\n          \"integration_tips\": \"Enforce authorization checks that confirm approver is manager/delegate for the employee, persist comments and evidence, and ensure UI/API present required metadata.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test approval/rejection flows, attempt unauthorized approvals, and review audit entries for comments and evidence retention.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.3\",\n          \"chapter\": \"Operational controls\",\n          \"section\": \"Capacity management\",\n          \"level\": null,\n          \"requirement\": \"Ensure operations are controlled and that changes and approvals are managed and recorded.\",\n          \"relevance\": \"Reinforces operational control over changes and approvals which supports structured approval workflows with logging.\",\n          \"integration_tips\": \"Document approval procedures and ensure system enforces required approvals and captures comments; include these in operational runbooks.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review procedural documents, sample approvals to confirm process adherence, and verify logs for completeness.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Manager delegation with start/end dates, scope of permissions, revocation, and notifications\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-05\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"The organization separates duties of individuals as necessary, and implements delegation controls to define scope and limits of permissions.\",\n          \"relevance\": \"Addresses the need to control delegation scope and ensure duties are appropriately segregated and limited in time and scope.\",\n          \"integration_tips\": \"Implement delegation records with start/end timestamps and scoped permissions; ensure separation-of-duty checks prevent conflict-of-interest delegations.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review delegation records, test enforcement of scope and time boundaries, and perform conflict-of-interest checks.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.5\",\n          \"chapter\": \"Authentication and Session Management\",\n          \"section\": \"Account and Role Management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure that delegation and temporary role assignments are time-bound and auditable, and support revocation.\",\n          \"relevance\": \"Directly requires time-bound delegation, auditable assignments and revocation mechanisms matching the requirement's needs.\",\n          \"integration_tips\": \"Provide UI/APIs to create time-bound delegation entries, implement automatic expiry and immediate revocation endpoints, and generate notifications on changes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Create delegated roles, verify automatic expiry, execute revocation and confirm notifications and audit entries are generated.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.6.1.2\",\n          \"chapter\": \"Organisation of information security\",\n          \"section\": \"Segregation of duties\",\n          \"level\": null,\n          \"requirement\": \"Conflicts of interest are reduced by segregating duties and defining responsibilities, including delegation rules.\",\n          \"relevance\": \"Supports defining delegation rules and responsibilities to reduce conflicts when delegating managerial tasks.\",\n          \"integration_tips\": \"Document delegation policies with approval steps, maintain a registry of active delegations, and send notifications for assignment/revocation.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect delegation registry and policy documents, and confirm notifications are issued on changes.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Holiday and leave request management with leave balance tracking and manager approval\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.7.2.2\",\n          \"chapter\": \"Human resource security\",\n          \"section\": \"During employment\",\n          \"level\": null,\n          \"requirement\": \"Employees should be made aware of information security responsibilities; HR processes should include leave and absence management controls.\",\n          \"relevance\": \"Links HR processes (leave management) with security responsibilities and supports integrating leave tracking securely in systems.\",\n          \"integration_tips\": \"Integrate leave management with HR systems, enforce approval workflows with manager authorization, and protect leave balance data as personal information.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review HR integration points, test leave request workflows and manager approvals, and verify PII protections for leave balances.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-02\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"The information system manages accounts including attributes; systems supporting leave should manage state and approvals.\",\n          \"relevance\": \"Account attributes and state management apply to leave status and approvals linked to user accounts.\",\n          \"integration_tips\": \"Store leave balances as account attributes and enforce manager approval before state changes; log changes for audit.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Examine account attributes for leave balance fields, review approval logs, and confirm state transitions require manager action.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.1\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Application Functionality Verification\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify business processes like leave requests and balance calculations are implemented correctly and prevent abuse.\",\n          \"relevance\": \"Ensures leave balances and approval logic are implemented correctly to prevent fraudulent requests or incorrect balances.\",\n          \"integration_tips\": \"Implement server-side calculation of balances, include checks against overlapping leaves, and require manager approval with audit trail.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional tests of leave balance computations, attempts to bypass approvals, and verify audit trails for approvals.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Public holiday preload and auto-application to timesheets\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.1\",\n          \"chapter\": \"Operational controls\",\n          \"section\": \"Documented operating procedures\",\n          \"level\": null,\n          \"requirement\": \"Operating procedures should be documented; application configuration (like public holidays) must be managed and documented.\",\n          \"relevance\": \"Requires documenting procedures for preloading public holidays and how they are applied to timesheets, useful for configuration control and auditing.\",\n          \"integration_tips\": \"Maintain documented configuration procedures for public holiday datasets, include change approval for holiday lists, and ensure changes are logged and tested.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review documentation, inspect configuration change logs, and verify that holiday preload processes are followed and auditable.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"CM-2\",\n          \"chapter\": \"Configuration Management\",\n          \"section\": \"Baseline Configuration\",\n          \"level\": null,\n          \"requirement\": \"Establish and maintain baseline configurations for information systems including configurable data sets.\",\n          \"relevance\": \"Public holiday datasets are configurable data; baselining ensures controlled updates and integrity of this data.\",\n          \"integration_tips\": \"Treat public holiday data as configuration items with versioning, approvals for changes, and rollback procedures for erroneous updates.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect configuration baselines and version history for holiday data and test rollback and update processes.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.1\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Application Functionality Verification\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify system-provided data and configurable presets (e.g., public holidays) are applied consistently and cannot be tampered with by unauthorized users.\",\n          \"relevance\": \"Ensures preloaded public holiday data cannot be altered by unprivileged users and is applied consistently to timesheets.\",\n          \"integration_tips\": \"Restrict modification of holiday data to administrators, sign or checksum holiday datasets to detect tampering, and log changes with approvals.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt unauthorized modification of holiday data, review access controls, and verify integrity checks for datasets.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Business rules enforcement: configurable workweek, min/max hours, working patterns\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 5.3\",\n          \"chapter\": \"Business Logic Controls\",\n          \"section\": \"Input Validation and Business Rules Enforcement\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify business rule enforcement (configurable policies like workweek, min/max hours) is applied server-side and cannot be bypassed.\",\n          \"relevance\": \"Directly maps to ensuring business rules (workweek, hours) are enforced server-side and are configurable in a controlled manner.\",\n          \"integration_tips\": \"Model business rules as policy objects enforced in backend services, provide administrative UI for configuration with approvals, and validate rules on every submission.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test rule configuration changes, attempt to submit timesheets violating rules, and review server-side enforcement in logs and code.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-06\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Least Privilege\",\n          \"level\": null,\n          \"requirement\": \"The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.\",\n          \"relevance\": \"Applies to who can configure business rules; restrict configuration changes to privileged admin roles following least privilege.\",\n          \"integration_tips\": \"Restrict business rule configuration to administrators with documented approvals and enforce separation of duties between config and approval roles.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review role permissions for configuration actions and validate that non-admin users cannot alter business rules.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure system engineering principles\",\n          \"level\": null,\n          \"requirement\": \"Security requirements for applications including enforcement of business rules and validation shall be addressed during development.\",\n          \"relevance\": \"Mandates embedding business rule enforcement into secure development lifecycle to prevent bypasses.\",\n          \"integration_tips\": \"Include business rule enforcement tests in development pipelines and perform security reviews focusing on rule bypass risks.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review secure development artefacts and test suites for business rule enforcement coverage.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Notifications via email for reminders, approval requests, approvals/rejections, and delegation changes\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-4\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information System Monitoring\",\n          \"level\": null,\n          \"requirement\": \"Implement mechanisms to monitor system notifications and ensure integrity of messaging.\",\n          \"relevance\": \"Covers monitoring to ensure notification system integrity and detect anomalies in email delivery for reminders and approvals.\",\n          \"integration_tips\": \"Monitor notification delivery logs, set alerts for failures/unexpected volumes, and ensure traceability from event to sent notification.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review notification logs, monitor alerting, and test end-to-end notification delivery and error handling.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 14.1\",\n          \"chapter\": \"Data Protection\",\n          \"section\": \"Sensitive Data Exposure\",\n          \"level\": \"L1\",\n          \"requirement\": \"Ensure sensitive data transmitted via notifications (email) is protected and minimized (avoid including sensitive data in emails).\",\n          \"relevance\": \"Email notifications often contain PII or timesheet details; this control ensures sensitive content is minimized and protected.\",\n          \"integration_tips\": \"Avoid including sensitive details in emails \u2014 include links to the secure portal instead; if data is sent, use encryption and redaction as appropriate.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit email templates for sensitive content, test that emails contain minimal data and links require authentication to view details.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.10.1.1\",\n          \"chapter\": \"Cryptography\",\n          \"section\": \"Policy on the use of cryptographic controls\",\n          \"level\": null,\n          \"requirement\": \"Use cryptographic controls to protect the confidentiality, integrity and availability of information, including notifications where appropriate.\",\n          \"relevance\": \"Applied to protect content of emails (when sensitive) and ensure SMTP channels or message stores use encryption and integrity controls.\",\n          \"integration_tips\": \"Use TLS for SMTP, sign emails or use secure notification services, and store notification records encrypted if they include PII.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect email transport configuration for TLS, review encryption policy for stored notifications, and test interception resistance.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Reporting: weekly, monthly, and custom time reports for employees and managers\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-03\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access Enforcement\",\n          \"level\": null,\n          \"requirement\": \"The system enforces approved authorizations for logical access to information and system resources (apply to reports and exports).\",\n          \"relevance\": \"Reports and exports must be subject to access enforcement so employees/managers only see authorized data.\",\n          \"integration_tips\": \"Enforce RBAC/attribute-based checks at report generation time, filter results by viewer's team scope and permissions, and restrict export endpoints.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test report access for various roles, attempt to access others' reports, and review enforcement logic in reporting services.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 10.1\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Business Function Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that access control is applied to business functions such as report generation and data exports to ensure only authorized personnel can run them.\",\n          \"relevance\": \"Ensures reporting functions require appropriate authorization and respect role/team boundaries.\",\n          \"integration_tips\": \"Implement authorization checks inline with report generation functions; include masking/aggregation for non-authorized detail levels.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review access control checks in reporting code and attempt to retrieve reports beyond assigned scope.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.1\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Information access restriction\",\n          \"level\": null,\n          \"requirement\": \"Access to information and application system functions should be restricted in accordance with the access control policy (applies to reports and exports).\",\n          \"relevance\": \"Supports restricting access to reports per policy and aligns with data access requirements for managers and employees.\",\n          \"integration_tips\": \"Define report access policies and implement technical controls to restrict data exports and downloaden capabilities to authorized roles only.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit report access policies, review permission enforcement, and test enforcement across report types.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Audit logging of timesheet lifecycle events, approvals/rejections, delegation changes, and admin amendments\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"The information system determines which events (such as timesheet lifecycle events) are to be audited and records them.\",\n          \"relevance\": \"Specifies selecting and recording audit events, directly mapping to timesheet lifecycle and admin actions logging.\",\n          \"integration_tips\": \"Define an audit event catalog for lifecycle events, ensure logs capture user identity, timestamp, action and context, and protect logs from tampering.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review event catalog, examine logs for required events, and confirm tamper-evidence and retention settings.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Logging and monitoring\",\n          \"section\": \"Event logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities and changes shall be maintained to support monitoring and investigation.\",\n          \"relevance\": \"Reinforces maintaining logs for activities like approvals, delegations and admin amendments to support investigations.\",\n          \"integration_tips\": \"Centralize logs, apply access controls to log access, and include procedures for log review and incident correlation.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect centralized log store, test log integrity controls, and review monitoring procedures.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 10.5\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Audit Logging Requirements\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify sufficient logging is implemented to support reconstruction of events such as approvals, rejections and administrative changes.\",\n          \"relevance\": \"Specifies log content and sufficiency for reconstructing events related to timesheet lifecycle and admin changes.\",\n          \"integration_tips\": \"Ensure log entries include actor, timestamp, target resource, previous and new values, and reason/comment where applicable.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Reconstruct sample incidents from logs to ensure all necessary data is present and verify logs against event catalog.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Administrator capabilities to configure system settings, working patterns, public holidays, and amend submitted timesheets\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-5\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"The organization separates duties of individuals as necessary and implements controls over privileged accounts (administrators).\",\n          \"relevance\": \"Requires separation and control of administrative privileges needed for configuration and amendment capabilities.\",\n          \"integration_tips\": \"Apply least privilege for admin roles, segregate duties across multiple admin roles (config vs amendments), and require approvals for high-impact changes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review admin role definitions, test segregation of duties, and inspect authorization requirements for admin actions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 2.5\",\n          \"chapter\": \"Authentication and Session Management\",\n          \"section\": \"Account and Role Management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify administrative functions are protected and that only authorized administrators can change system configuration and amend data.\",\n          \"relevance\": \"Mandates that admin functions be tightly controlled \u2014 mapping to configuration and amendment capabilities in the requirement.\",\n          \"integration_tips\": \"Protect admin interfaces with strong authentication (MFA), log all admin actions, and require re-authentication or approvals for critical amendments.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test admin access controls, verify MFA enforcement, and review audit records for admin amendments.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.3\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Management of privileged access rights\",\n          \"level\": null,\n          \"requirement\": \"The allocation and use of privileged access rights shall be restricted and controlled.\",\n          \"relevance\": \"Specifies controlling privileged access which is required for admin capabilities to configure and amend submitted timesheets.\",\n          \"integration_tips\": \"Implement privileged access management (PAM) controls for admin accounts, maintain an approval trail for privilege grants, and periodically review privileged accounts.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect PAM configuration and privileged account reviews, and test that privileged operations require appropriate authorization and logging.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Responsive and accessible UI compliant with WCAG guidelines\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 14.2\",\n          \"chapter\": \"Privacy and Integrity\",\n          \"section\": \"Privacy and Accessibility Considerations\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that privacy and accessibility considerations are addressed in application design to prevent exclusion and leakage of private data.\",\n          \"relevance\": \"Addresses accessibility and privacy considerations in UI design; supports WCAG compliance to ensure accessible and privacy-preserving UI.\",\n          \"integration_tips\": \"Include accessibility checks in design and testing, avoid exposing sensitive data in UI components, and follow WCAG guidance for responsive layouts and alternatives.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Perform WCAG conformance testing, accessibility audits, and review UI designs for privacy exposures.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-8\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Information Security Architecture\",\n          \"level\": null,\n          \"requirement\": \"Consider accessibility and usability as part of secure system architecture and design.\",\n          \"relevance\": \"Encourages including accessibility in the security architecture to ensure accessible systems meet security and compliance needs.\",\n          \"integration_tips\": \"Incorporate accessibility requirements into system architecture and threat models, and include assistive technology testing in QA.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Review architecture documents for accessibility considerations and test with assistive technologies.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.1\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure development policy\",\n          \"level\": null,\n          \"requirement\": \"Security and quality requirements for systems (including usability and accessibility) should be defined and implemented.\",\n          \"relevance\": \"Requires defining usability and accessibility as quality/security requirements in development, supporting WCAG compliance.\",\n          \"integration_tips\": \"Document WCAG targets in requirements, perform accessibility testing during development, and maintain remediation plans for issues found.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review requirement documents, test plans, and evidence of WCAG testing and remediation activities.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Data access restrictions based on team hierarchy and least-privilege principles\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-06\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Least Privilege\",\n          \"level\": null,\n          \"requirement\": \"The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.\",\n          \"relevance\": \"Directly requires least-privilege principles be applied to restrict data access per team hierarchy.\",\n          \"integration_tips\": \"Implement attribute-based access controls combining role and team attributes, periodically review privileges, and restrict admin capabilities.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Audit role assignments and permissions, perform privilege escalation tests, and validate enforcement of team-based filters.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.1\",\n          \"chapter\": \"Access control\",\n          \"section\": \"Information access restriction\",\n          \"level\": null,\n          \"requirement\": \"Access to information and application system functions should be restricted in accordance with the access control policy (supports team hierarchy restrictions).\",\n          \"relevance\": \"Mandates access restrictions aligned with policy, supporting hierarchy-based restrictions required by the application.\",\n          \"integration_tips\": \"Define access control policy reflecting team hierarchies and implement enforcement in application and data layers with logging.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review policy and enforcement mechanisms, test cross-team access attempts, and confirm access logs reflect restrictions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 10.1\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Business Function Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify access control is applied to business functions and data based on roles and attributes, supporting least privilege and hierarchical restrictions.\",\n          \"relevance\": \"Specifies applying access control to business functions and data using roles and attributes, essential for team-hierarchy enforcement.\",\n          \"integration_tips\": \"Use centralized policy engine for attribute-based decisions (role + team), apply data filtering at query time, and protect APIs against elevation attempts.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test attribute-based access control decisions in diverse scenarios and review implementation for gaps.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Data retention, encryption, and export capabilities to support compliance and integrations with payroll/HR\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"MP-6\",\n          \"chapter\": \"Media Protection\",\n          \"section\": \"Media Sanitization\",\n          \"level\": null,\n          \"requirement\": \"Protect and sanitize media containing sensitive information prior to disposal; retention policies shall be enforced.\",\n          \"relevance\": \"Covers enforcing retention policies and sanitization for data exported or stored for payroll/HR integrations.\",\n          \"integration_tips\": \"Define retention schedules for timesheet and payroll data, implement scheduled purging and secure disposal, and document retention justifications for compliance.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review retention policies, confirm automated purging processes, and verify proper sanitization/destruction procedures.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.8.3.3\",\n          \"chapter\": \"Asset management\",\n          \"section\": \"Information classification\",\n          \"level\": null,\n          \"requirement\": \"Information shall be handled in accordance with its classification including retention and protection rules; support secure export.\",\n          \"relevance\": \"Requires classifying timesheet/payroll data and handling exports according to classification to meet compliance needs.\",\n          \"integration_tips\": \"Classify data, enforce encryption at rest and in transit for exports, and require contractual/technical controls for HR/payroll integration endpoints.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review classification rules, inspect encryption controls, and test secure export workflows to payroll/HR.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"ASVS 14.1\",\n          \"chapter\": \"Data Protection\",\n          \"section\": \"Data at Rest and in Transit\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that sensitive data is protected at rest and in transit using appropriate cryptography, and that export mechanisms are secure and auditable.\",\n          \"relevance\": \"Directly addresses encryption and secure export capabilities required for payroll/HR integrations.\",\n          \"integration_tips\": \"Use strong, up-to-date cryptographic algorithms for data at rest and TLS for transports, and log/export events with integrity checks and access controls.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect encryption configurations, test secure export endpoints, and verify audit trails of export operations.\"\n        }\n      ]\n    }\n  ],\n  \"cross_functional_controls\": [\n    {\n      \"control_name\": \"Audit Logging and Monitoring\",\n      \"description\": \"Centralized logging of critical events including account lifecycle, timesheet submissions, approvals, delegations, admin changes, exports and notifications to support investigations and compliance.\",\n      \"applies_to\": [\n        \"All requirements that involve user actions, approvals, delegation, admin changes, submissions and exports\"\n      ],\n      \"implementation_guidance\": \"Implement centralized, tamper-evident logging (SIEM or log store), standardize event schemas (actor, timestamp, action, context), protect log access, and establish log retention and review processes.\"\n    },\n    {\n      \"control_name\": \"Encryption (Data at Rest and in Transit)\",\n      \"description\": \"Protect sensitive timesheet, personal and payroll/HR-related data using strong cryptography while stored and transmitted.\",\n      \"applies_to\": [\n        \"Authentication/SSO tokens, notifications, stored timesheets, exports and integration endpoints\"\n      ],\n      \"implementation_guidance\": \"Use TLS for transport, AES-256 or equivalent for data at rest, manage keys securely (KMS/PAM), and ensure integrations also use encrypted channels and signed payloads.\"\n    },\n    {\n      \"control_name\": \"Access Control and RBAC Enforcement\",\n      \"description\": \"Centralized role-based and attribute-based access control enforcing least privilege across UI, APIs and data layers.\",\n      \"applies_to\": [\n        \"User management, reporting, admin functions, delegation, and data access restrictions\"\n      ],\n      \"implementation_guidance\": \"Use a centralized authorization service/policy engine, enforce checks server-side, maintain role/permission catalog, and require approval workflows for privileged changes.\"\n    },\n    {\n      \"control_name\": \"Secure Development and Business Logic Validation\",\n      \"description\": \"Embed validation, business rule enforcement, and threat modeling into the SDLC to prevent logic bypasses and ensure correct state transitions.\",\n      \"applies_to\": [\n        \"Timesheet entry, draft/save/submit workflows, business rules, holiday application and leave management\"\n      ],\n      \"implementation_guidance\": \"Include server-side validation, automated tests for business rules, code reviews, and include business logic abuse cases in threat models and pentests.\"\n    }\n  ],\n  \"recommended_asvs_level\": \"L2\"\n}",
      "pydantic": {
        "requirements_mapping": [
          {
            "high_level_requirement": "Role-based access control with Employee, Manager, Delegate, and Administrator roles",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-02",
                "chapter": "Access Control",
                "section": "Account Management",
                "level": null,
                "requirement": "The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.",
                "relevance": "This control describes the need to manage user accounts and implement role-based access controls which directly maps to defining Employee, Manager, Delegate, and Administrator roles and their lifecycle.",
                "integration_tips": "Implement an account management module to create, modify, disable and remove accounts, with role assignment workflows for Employee/Manager/Delegate/Admin. Tie account lifecycle events to HR/ID provider events to auto-deactivate accounts when necessary.",
                "priority": "Critical",
                "verification_method": "Review account management procedures, inspect role assignment workflows, and test create/modify/disable/delete operations for each role; verify role enforcement in code and access control lists."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.1.2",
                "chapter": "Access control",
                "section": "Access to networks and network services",
                "level": null,
                "requirement": "Users shall only be provided with access to the network and network services that they have been specifically authorized to use.",
                "relevance": "Ensures that each role is granted only the specific access required, aligning with role separation between Employees, Managers, Delegates and Administrators.",
                "integration_tips": "Define an access control policy that enumerates permitted actions for each role and ensure technical enforcement in application and API layers. Maintain documentation linking roles to authorized services and verify provisioning matches policy.",
                "priority": "High",
                "verification_method": "Audit role-to-permission mappings, perform access control tests (positive and negative) for each role, and verify that unauthorized actions are blocked."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 2.1",
                "chapter": "Authentication Verification Requirements",
                "section": "Ensure role-based access control enforcement",
                "level": "L2",
                "requirement": "Verify that role-based access control is implemented and enforced server-side.",
                "relevance": "Directly mandates server-side enforcement of RBAC which is essential to prevent client-side bypass of role restrictions for Employees, Managers, Delegates and Administrators.",
                "integration_tips": "Enforce RBAC checks in server-side business logic and APIs, centralize authorization logic, and avoid relying on client-side UI restrictions. Use policy-driven access checks and test for privilege escalation.",
                "priority": "Critical",
                "verification_method": "Code review of authorization checks, automated tests simulating role-based access attempts, and penetration testing for role escalation vulnerabilities."
              }
            ]
          },
          {
            "high_level_requirement": "Azure SSO integration for authentication and single sign-on",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "ASVS 2.3",
                "chapter": "Authentication Verification Requirements",
                "section": "Federated Authentication and Single Sign-On",
                "level": "L2",
                "requirement": "Verify correct implementation of federated authentication (SAML, OAuth2/OIDC) and that the application properly validates assertions and tokens from identity providers.",
                "relevance": "Azure SSO relies on federated protocols (OIDC/OAuth2/SAML); this control ensures tokens/assertions from Azure AD are validated to prevent impersonation and token forgery.",
                "integration_tips": "Use a tested OIDC/SAML library, validate issuer, audience, token signatures and claims, enforce token expiration and revocation, and implement proper redirect URIs. Integrate Azure AD metadata and rotate keys per provider guidance.",
                "priority": "Critical",
                "verification_method": "Review integration code/configuration, verify token validation logic, test with malformed tokens and revoked credentials, and perform federated auth flow penetration testing."
              },
              {
                "standard": "NIST",
                "req_id": "IA-08",
                "chapter": "Identification and Authentication",
                "section": "Identification and Authentication (Non-Organizational Users)",
                "level": null,
                "requirement": "The information system supports organizational users leveraging federated identities and authenticates via approved identity providers.",
                "relevance": "Specifies support for federated authentication which maps to using Azure AD as the identity provider for SSO.",
                "integration_tips": "Document and restrict approved identity providers to Azure AD, ensure trust anchors and metadata are configured, and include fallback/incident procedures for IdP outages.",
                "priority": "High",
                "verification_method": "Validate configuration against Azure AD metadata, test sign-on flows for multiple scenarios (fresh login, SSO, logout), and review IdP trust settings."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.4.2",
                "chapter": "Access control",
                "section": "Secure log-on procedures",
                "level": null,
                "requirement": "Where required by the business, users shall be provided with a secure log-on procedure which may include SSO solutions.",
                "relevance": "Supports SSO as a recognized secure logon mechanism to be used when integrating Azure SSO for authentication.",
                "integration_tips": "Ensure SSO configuration follows secure logon procedures, include multi-factor authentication where required, and document SSO use in access control policy.",
                "priority": "High",
                "verification_method": "Review secure logon procedure documentation, test SSO flows for MFA and session handling, and confirm configuration meets organizational security requirements."
              }
            ]
          },
          {
            "high_level_requirement": "User management and team hierarchy mapping (assign managers, teams, delegates)",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-02",
                "chapter": "Access Control",
                "section": "Account Management",
                "level": null,
                "requirement": "The information system manages information system accounts, including establishing, activating, modifying, disabling, and removing accounts. The organization assigns account managers and implements role-based access controls.",
                "relevance": "Account Management covers provisioning and role assignments required for mapping team hierarchies and assigning manager/delegate relationships.",
                "integration_tips": "Implement structured account provisioning with attributes for team, manager, and delegate fields; integrate with HR/IdP to synchronize hierarchies and automate lifecycle actions.",
                "priority": "Critical",
                "verification_method": "Audit provisioning logs, test automated synchronization against HR records, and review the process for creating/updating hierarchical relationships."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.2",
                "chapter": "Access control",
                "section": "User access provisioning",
                "level": null,
                "requirement": "The allocation and use of privileges shall be restricted and controlled. A formal user access provisioning process shall be implemented to assign roles and privileges.",
                "relevance": "Formal provisioning is needed to ensure teams and managers are assigned consistent privileges and that delegation is controlled.",
                "integration_tips": "Establish documented provisioning procedures, include approvals for manager/delegate assignments, and implement access reviews to validate team mappings periodically.",
                "priority": "High",
                "verification_method": "Review provisioning workflow documentation, sample user profiles for correct team/manager attributes, and examine periodic access review records."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 2.5",
                "chapter": "Authentication and Session Management",
                "section": "Account and user management",
                "level": "L2",
                "requirement": "Verify that user account management functions (create, update, disable, delete) are implemented with role-based constraints and administrative controls.",
                "relevance": "Mandates secure account management features which are necessary to implement hierarchical relationships and delegation safely.",
                "integration_tips": "Provide admin UI/API that enforces role-based constraints, log all changes to user/team assignments, and require approvals for sensitive changes like manager/delegate reassignment.",
                "priority": "High",
                "verification_method": "Code and configuration review of account management APIs, functional tests for reassigning managers/delegates, and logs verifying change history."
              }
            ]
          },
          {
            "high_level_requirement": "Daily and weekly timesheet entry supporting multiple projects/tasks",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "SI-12",
                "chapter": "System and Information Integrity",
                "section": "Information Input Validation",
                "level": null,
                "requirement": "The information system validates the accuracy and integrity of data inputs and detects input errors or malicious inputs.",
                "relevance": "Timesheet entries are user inputs that must be validated for integrity, format and allowed values (projects/tasks) to prevent data corruption or abuse.",
                "integration_tips": "Implement server-side validation for project/task identifiers, check hours totals against configured rules, and sanitize inputs to prevent injection or malformed data.",
                "priority": "Critical",
                "verification_method": "Run automated input validation tests, review validation code, and attempt injection and malformed input tests against timesheet entry endpoints."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.1",
                "chapter": "Business Logic Controls",
                "section": "Application Functionality Verification",
                "level": "L2",
                "requirement": "Verify business logic functions, including multi-step workflows and data correctness for application-specific processes like timesheet entries.",
                "relevance": "Ensures the application enforces correct business logic for multi-project/task timesheets and captures intended behaviour for daily/weekly entries.",
                "integration_tips": "Model workflows for daily/weekly entry, include project/task validation and cross-field checks, and implement unit/integration tests covering typical and edge cases.",
                "priority": "High",
                "verification_method": "Functional testing of timesheet workflows, review test coverage for multiple projects/tasks, and validate business rule enforcement during entry."
              },
              {
                "standard": "NIST",
                "req_id": "AU-12",
                "chapter": "Audit and Accountability",
                "section": "User/Device Attribution",
                "level": null,
                "requirement": "The system associates user identities with actions, ensuring timesheet entries can be attributed and audited.",
                "relevance": "Attribution ensures entries are tied to the submitting user, supporting accountability for daily/weekly timesheet data.",
                "integration_tips": "Record user identifiers and session details with each timesheet entry, and ensure audit trails are immutable and retained per policy.",
                "priority": "High",
                "verification_method": "Inspect logs and entries to confirm user attribution fields are recorded and cannot be altered by normal users."
              }
            ]
          },
          {
            "high_level_requirement": "Save draft timesheets with validation preventing submission until required fields completed",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.3",
                "chapter": "Business Logic Controls",
                "section": "Input Validation and Business Rules Enforcement",
                "level": "L2",
                "requirement": "Verify that input validation and business rule enforcement prevents invalid state transitions (e.g., prevent submission until required fields are completed).",
                "relevance": "Directly addresses preventing invalid state transitions between draft and submitted timesheet states until validation passes.",
                "integration_tips": "Implement server-side state machine enforcing 'draft' vs 'submitted' states, validate required fields on submission API calls, and disallow client-only validations.",
                "priority": "Critical",
                "verification_method": "Attempt to submit incomplete drafts via API, review server-side validation code and test state transitions with automated tests."
              },
              {
                "standard": "NIST",
                "req_id": "SI-10",
                "chapter": "System and Information Integrity",
                "section": "Information Input Validation",
                "level": null,
                "requirement": "The application checks and validates input data for completeness and correctness before processing or submission.",
                "relevance": "Requires completeness checks on inputs which align with preventing submissions of incomplete timesheets.",
                "integration_tips": "Enforce required-field checks on submission endpoints, and log validation failures for monitoring and user feedback.",
                "priority": "High",
                "verification_method": "Review validation rules, attempt invalid submissions, and confirm server rejects submissions until fields are complete."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.5",
                "chapter": "System acquisition, development and maintenance",
                "section": "Secure system engineering principles",
                "level": null,
                "requirement": "Security requirements for applications including validation and error handling shall be addressed during development.",
                "relevance": "Mandates considering validation/error handling in development, ensuring draft-save vs submit behaviors are securely implemented.",
                "integration_tips": "Include validation and state-change rules in security requirements, perform threat modeling for state transitions, and include validation tests in CI/CD.",
                "priority": "Medium",
                "verification_method": "Review development artefacts and tests for validation logic and confirm error handling prevents submission of incomplete drafts."
              }
            ]
          },
          {
            "high_level_requirement": "Timesheet submission workflow with submission timestamp and read-only state after submission",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AU-2",
                "chapter": "Audit and Accountability",
                "section": "Audit Events",
                "level": null,
                "requirement": "The information system determines which events (such as submission) are to be audited and records sufficient information including timestamps.",
                "relevance": "Specifies that submissions must be audited with timestamps which supports the requirement for submission timestamps.",
                "integration_tips": "Record submission events with user ID, timestamp, and submission metadata in an append-only audit log, and ensure timestamp source is trusted (e.g., server time).",
                "priority": "Critical",
                "verification_method": "Review audit logs for submission events and timestamps; verify logs are tamper-evident and properly correlated to submission records."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.2",
                "chapter": "Business Logic Controls",
                "section": "State Management and Workflow Controls",
                "level": "L2",
                "requirement": "Verify that state transitions are enforced server-side and that submitted records become immutable/read-only if required by business rules.",
                "relevance": "Directly mandates server-side enforcement of read-only state post-submission to prevent unauthorized edits.",
                "integration_tips": "Implement immutability by enforcing access control checks and storing a submitted flag preventing modification; use DB constraints or write-once storage for submitted records.",
                "priority": "Critical",
                "verification_method": "Attempt to alter a submitted timesheet via UI and API; review server-side checks and database constraints ensuring immutability."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.1",
                "chapter": "Logging and monitoring",
                "section": "Event logging",
                "level": null,
                "requirement": "Event logs recording user activities and timestamps shall be maintained to support later review and investigations.",
                "relevance": "Supports retention of submission timestamps and event records to enable audits and investigations for submitted timesheets.",
                "integration_tips": "Ensure submission events are logged centrally and retained per retention policy; log who changed status and when.",
                "priority": "High",
                "verification_method": "Review logging configuration, confirm logs include submission events/timestamps, and test retention/archival processes."
              }
            ]
          },
          {
            "high_level_requirement": "Approval/rejection workflow for managers and delegates, including comments and logging",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AU-6",
                "chapter": "Audit and Accountability",
                "section": "Audit Review, Analysis, and Reporting",
                "level": null,
                "requirement": "The organization reviews and analyzes audit records for indications of inappropriate activity; approvals/rejections should be auditable.",
                "relevance": "Mandates auditability of approval/rejection actions which is required for manager/delegate workflows including comments.",
                "integration_tips": "Log approval/rejection events with user id, role, timestamp and comment; integrate with audit review processes to detect anomalies in approvals.",
                "priority": "Critical",
                "verification_method": "Inspect logs for approval/rejection entries, verify comments are stored and reviewers can reconstruct the decision chain."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.2",
                "chapter": "Business Logic Controls",
                "section": "Workflow and Authorization Controls",
                "level": "L2",
                "requirement": "Verify that workflow actions (approve/reject) are properly authorized, logged, and include support for comments and evidence.",
                "relevance": "Specifies that approval actions must be authorized and logged and support comments \u2014 directly mapping to the requirement.",
                "integration_tips": "Enforce authorization checks that confirm approver is manager/delegate for the employee, persist comments and evidence, and ensure UI/API present required metadata.",
                "priority": "Critical",
                "verification_method": "Test approval/rejection flows, attempt unauthorized approvals, and review audit entries for comments and evidence retention."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.1.3",
                "chapter": "Operational controls",
                "section": "Capacity management",
                "level": null,
                "requirement": "Ensure operations are controlled and that changes and approvals are managed and recorded.",
                "relevance": "Reinforces operational control over changes and approvals which supports structured approval workflows with logging.",
                "integration_tips": "Document approval procedures and ensure system enforces required approvals and captures comments; include these in operational runbooks.",
                "priority": "High",
                "verification_method": "Review procedural documents, sample approvals to confirm process adherence, and verify logs for completeness."
              }
            ]
          },
          {
            "high_level_requirement": "Manager delegation with start/end dates, scope of permissions, revocation, and notifications",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-05",
                "chapter": "Access Control",
                "section": "Separation of Duties",
                "level": null,
                "requirement": "The organization separates duties of individuals as necessary, and implements delegation controls to define scope and limits of permissions.",
                "relevance": "Addresses the need to control delegation scope and ensure duties are appropriately segregated and limited in time and scope.",
                "integration_tips": "Implement delegation records with start/end timestamps and scoped permissions; ensure separation-of-duty checks prevent conflict-of-interest delegations.",
                "priority": "High",
                "verification_method": "Review delegation records, test enforcement of scope and time boundaries, and perform conflict-of-interest checks."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 2.5",
                "chapter": "Authentication and Session Management",
                "section": "Account and Role Management",
                "level": "L2",
                "requirement": "Ensure that delegation and temporary role assignments are time-bound and auditable, and support revocation.",
                "relevance": "Directly requires time-bound delegation, auditable assignments and revocation mechanisms matching the requirement's needs.",
                "integration_tips": "Provide UI/APIs to create time-bound delegation entries, implement automatic expiry and immediate revocation endpoints, and generate notifications on changes.",
                "priority": "Critical",
                "verification_method": "Create delegated roles, verify automatic expiry, execute revocation and confirm notifications and audit entries are generated."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.6.1.2",
                "chapter": "Organisation of information security",
                "section": "Segregation of duties",
                "level": null,
                "requirement": "Conflicts of interest are reduced by segregating duties and defining responsibilities, including delegation rules.",
                "relevance": "Supports defining delegation rules and responsibilities to reduce conflicts when delegating managerial tasks.",
                "integration_tips": "Document delegation policies with approval steps, maintain a registry of active delegations, and send notifications for assignment/revocation.",
                "priority": "High",
                "verification_method": "Inspect delegation registry and policy documents, and confirm notifications are issued on changes."
              }
            ]
          },
          {
            "high_level_requirement": "Holiday and leave request management with leave balance tracking and manager approval",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "ISO27001",
                "req_id": "A.7.2.2",
                "chapter": "Human resource security",
                "section": "During employment",
                "level": null,
                "requirement": "Employees should be made aware of information security responsibilities; HR processes should include leave and absence management controls.",
                "relevance": "Links HR processes (leave management) with security responsibilities and supports integrating leave tracking securely in systems.",
                "integration_tips": "Integrate leave management with HR systems, enforce approval workflows with manager authorization, and protect leave balance data as personal information.",
                "priority": "Medium",
                "verification_method": "Review HR integration points, test leave request workflows and manager approvals, and verify PII protections for leave balances."
              },
              {
                "standard": "NIST",
                "req_id": "AC-02",
                "chapter": "Access Control",
                "section": "Account Management",
                "level": null,
                "requirement": "The information system manages accounts including attributes; systems supporting leave should manage state and approvals.",
                "relevance": "Account attributes and state management apply to leave status and approvals linked to user accounts.",
                "integration_tips": "Store leave balances as account attributes and enforce manager approval before state changes; log changes for audit.",
                "priority": "High",
                "verification_method": "Examine account attributes for leave balance fields, review approval logs, and confirm state transitions require manager action."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.1",
                "chapter": "Business Logic Controls",
                "section": "Application Functionality Verification",
                "level": "L2",
                "requirement": "Verify business processes like leave requests and balance calculations are implemented correctly and prevent abuse.",
                "relevance": "Ensures leave balances and approval logic are implemented correctly to prevent fraudulent requests or incorrect balances.",
                "integration_tips": "Implement server-side calculation of balances, include checks against overlapping leaves, and require manager approval with audit trail.",
                "priority": "High",
                "verification_method": "Functional tests of leave balance computations, attempts to bypass approvals, and verify audit trails for approvals."
              }
            ]
          },
          {
            "high_level_requirement": "Public holiday preload and auto-application to timesheets",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "ISO27001",
                "req_id": "A.12.1.1",
                "chapter": "Operational controls",
                "section": "Documented operating procedures",
                "level": null,
                "requirement": "Operating procedures should be documented; application configuration (like public holidays) must be managed and documented.",
                "relevance": "Requires documenting procedures for preloading public holidays and how they are applied to timesheets, useful for configuration control and auditing.",
                "integration_tips": "Maintain documented configuration procedures for public holiday datasets, include change approval for holiday lists, and ensure changes are logged and tested.",
                "priority": "Medium",
                "verification_method": "Review documentation, inspect configuration change logs, and verify that holiday preload processes are followed and auditable."
              },
              {
                "standard": "NIST",
                "req_id": "CM-2",
                "chapter": "Configuration Management",
                "section": "Baseline Configuration",
                "level": null,
                "requirement": "Establish and maintain baseline configurations for information systems including configurable data sets.",
                "relevance": "Public holiday datasets are configurable data; baselining ensures controlled updates and integrity of this data.",
                "integration_tips": "Treat public holiday data as configuration items with versioning, approvals for changes, and rollback procedures for erroneous updates.",
                "priority": "High",
                "verification_method": "Inspect configuration baselines and version history for holiday data and test rollback and update processes."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.1",
                "chapter": "Business Logic Controls",
                "section": "Application Functionality Verification",
                "level": "L2",
                "requirement": "Verify system-provided data and configurable presets (e.g., public holidays) are applied consistently and cannot be tampered with by unauthorized users.",
                "relevance": "Ensures preloaded public holiday data cannot be altered by unprivileged users and is applied consistently to timesheets.",
                "integration_tips": "Restrict modification of holiday data to administrators, sign or checksum holiday datasets to detect tampering, and log changes with approvals.",
                "priority": "High",
                "verification_method": "Attempt unauthorized modification of holiday data, review access controls, and verify integrity checks for datasets."
              }
            ]
          },
          {
            "high_level_requirement": "Business rules enforcement: configurable workweek, min/max hours, working patterns",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "ASVS 5.3",
                "chapter": "Business Logic Controls",
                "section": "Input Validation and Business Rules Enforcement",
                "level": "L2",
                "requirement": "Verify business rule enforcement (configurable policies like workweek, min/max hours) is applied server-side and cannot be bypassed.",
                "relevance": "Directly maps to ensuring business rules (workweek, hours) are enforced server-side and are configurable in a controlled manner.",
                "integration_tips": "Model business rules as policy objects enforced in backend services, provide administrative UI for configuration with approvals, and validate rules on every submission.",
                "priority": "Critical",
                "verification_method": "Test rule configuration changes, attempt to submit timesheets violating rules, and review server-side enforcement in logs and code."
              },
              {
                "standard": "NIST",
                "req_id": "AC-06",
                "chapter": "Access Control",
                "section": "Least Privilege",
                "level": null,
                "requirement": "The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.",
                "relevance": "Applies to who can configure business rules; restrict configuration changes to privileged admin roles following least privilege.",
                "integration_tips": "Restrict business rule configuration to administrators with documented approvals and enforce separation of duties between config and approval roles.",
                "priority": "High",
                "verification_method": "Review role permissions for configuration actions and validate that non-admin users cannot alter business rules."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.5",
                "chapter": "System acquisition, development and maintenance",
                "section": "Secure system engineering principles",
                "level": null,
                "requirement": "Security requirements for applications including enforcement of business rules and validation shall be addressed during development.",
                "relevance": "Mandates embedding business rule enforcement into secure development lifecycle to prevent bypasses.",
                "integration_tips": "Include business rule enforcement tests in development pipelines and perform security reviews focusing on rule bypass risks.",
                "priority": "Medium",
                "verification_method": "Review secure development artefacts and test suites for business rule enforcement coverage."
              }
            ]
          },
          {
            "high_level_requirement": "Notifications via email for reminders, approval requests, approvals/rejections, and delegation changes",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "SI-4",
                "chapter": "System and Information Integrity",
                "section": "Information System Monitoring",
                "level": null,
                "requirement": "Implement mechanisms to monitor system notifications and ensure integrity of messaging.",
                "relevance": "Covers monitoring to ensure notification system integrity and detect anomalies in email delivery for reminders and approvals.",
                "integration_tips": "Monitor notification delivery logs, set alerts for failures/unexpected volumes, and ensure traceability from event to sent notification.",
                "priority": "Medium",
                "verification_method": "Review notification logs, monitor alerting, and test end-to-end notification delivery and error handling."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 14.1",
                "chapter": "Data Protection",
                "section": "Sensitive Data Exposure",
                "level": "L1",
                "requirement": "Ensure sensitive data transmitted via notifications (email) is protected and minimized (avoid including sensitive data in emails).",
                "relevance": "Email notifications often contain PII or timesheet details; this control ensures sensitive content is minimized and protected.",
                "integration_tips": "Avoid including sensitive details in emails \u2014 include links to the secure portal instead; if data is sent, use encryption and redaction as appropriate.",
                "priority": "High",
                "verification_method": "Audit email templates for sensitive content, test that emails contain minimal data and links require authentication to view details."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.10.1.1",
                "chapter": "Cryptography",
                "section": "Policy on the use of cryptographic controls",
                "level": null,
                "requirement": "Use cryptographic controls to protect the confidentiality, integrity and availability of information, including notifications where appropriate.",
                "relevance": "Applied to protect content of emails (when sensitive) and ensure SMTP channels or message stores use encryption and integrity controls.",
                "integration_tips": "Use TLS for SMTP, sign emails or use secure notification services, and store notification records encrypted if they include PII.",
                "priority": "High",
                "verification_method": "Inspect email transport configuration for TLS, review encryption policy for stored notifications, and test interception resistance."
              }
            ]
          },
          {
            "high_level_requirement": "Reporting: weekly, monthly, and custom time reports for employees and managers",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-03",
                "chapter": "Access Control",
                "section": "Access Enforcement",
                "level": null,
                "requirement": "The system enforces approved authorizations for logical access to information and system resources (apply to reports and exports).",
                "relevance": "Reports and exports must be subject to access enforcement so employees/managers only see authorized data.",
                "integration_tips": "Enforce RBAC/attribute-based checks at report generation time, filter results by viewer's team scope and permissions, and restrict export endpoints.",
                "priority": "Critical",
                "verification_method": "Test report access for various roles, attempt to access others' reports, and review enforcement logic in reporting services."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 10.1",
                "chapter": "Access Control",
                "section": "Business Function Access Control",
                "level": "L2",
                "requirement": "Verify that access control is applied to business functions such as report generation and data exports to ensure only authorized personnel can run them.",
                "relevance": "Ensures reporting functions require appropriate authorization and respect role/team boundaries.",
                "integration_tips": "Implement authorization checks inline with report generation functions; include masking/aggregation for non-authorized detail levels.",
                "priority": "High",
                "verification_method": "Review access control checks in reporting code and attempt to retrieve reports beyond assigned scope."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.4.1",
                "chapter": "Access control",
                "section": "Information access restriction",
                "level": null,
                "requirement": "Access to information and application system functions should be restricted in accordance with the access control policy (applies to reports and exports).",
                "relevance": "Supports restricting access to reports per policy and aligns with data access requirements for managers and employees.",
                "integration_tips": "Define report access policies and implement technical controls to restrict data exports and downloaden capabilities to authorized roles only.",
                "priority": "High",
                "verification_method": "Audit report access policies, review permission enforcement, and test enforcement across report types."
              }
            ]
          },
          {
            "high_level_requirement": "Audit logging of timesheet lifecycle events, approvals/rejections, delegation changes, and admin amendments",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AU-2",
                "chapter": "Audit and Accountability",
                "section": "Audit Events",
                "level": null,
                "requirement": "The information system determines which events (such as timesheet lifecycle events) are to be audited and records them.",
                "relevance": "Specifies selecting and recording audit events, directly mapping to timesheet lifecycle and admin actions logging.",
                "integration_tips": "Define an audit event catalog for lifecycle events, ensure logs capture user identity, timestamp, action and context, and protect logs from tampering.",
                "priority": "Critical",
                "verification_method": "Review event catalog, examine logs for required events, and confirm tamper-evidence and retention settings."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.1",
                "chapter": "Logging and monitoring",
                "section": "Event logging",
                "level": null,
                "requirement": "Event logs recording user activities and changes shall be maintained to support monitoring and investigation.",
                "relevance": "Reinforces maintaining logs for activities like approvals, delegations and admin amendments to support investigations.",
                "integration_tips": "Centralize logs, apply access controls to log access, and include procedures for log review and incident correlation.",
                "priority": "High",
                "verification_method": "Inspect centralized log store, test log integrity controls, and review monitoring procedures."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 10.5",
                "chapter": "Logging and Monitoring",
                "section": "Audit Logging Requirements",
                "level": "L2",
                "requirement": "Verify sufficient logging is implemented to support reconstruction of events such as approvals, rejections and administrative changes.",
                "relevance": "Specifies log content and sufficiency for reconstructing events related to timesheet lifecycle and admin changes.",
                "integration_tips": "Ensure log entries include actor, timestamp, target resource, previous and new values, and reason/comment where applicable.",
                "priority": "Critical",
                "verification_method": "Reconstruct sample incidents from logs to ensure all necessary data is present and verify logs against event catalog."
              }
            ]
          },
          {
            "high_level_requirement": "Administrator capabilities to configure system settings, working patterns, public holidays, and amend submitted timesheets",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-5",
                "chapter": "Access Control",
                "section": "Separation of Duties",
                "level": null,
                "requirement": "The organization separates duties of individuals as necessary and implements controls over privileged accounts (administrators).",
                "relevance": "Requires separation and control of administrative privileges needed for configuration and amendment capabilities.",
                "integration_tips": "Apply least privilege for admin roles, segregate duties across multiple admin roles (config vs amendments), and require approvals for high-impact changes.",
                "priority": "Critical",
                "verification_method": "Review admin role definitions, test segregation of duties, and inspect authorization requirements for admin actions."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 2.5",
                "chapter": "Authentication and Session Management",
                "section": "Account and Role Management",
                "level": "L2",
                "requirement": "Verify administrative functions are protected and that only authorized administrators can change system configuration and amend data.",
                "relevance": "Mandates that admin functions be tightly controlled \u2014 mapping to configuration and amendment capabilities in the requirement.",
                "integration_tips": "Protect admin interfaces with strong authentication (MFA), log all admin actions, and require re-authentication or approvals for critical amendments.",
                "priority": "Critical",
                "verification_method": "Test admin access controls, verify MFA enforcement, and review audit records for admin amendments."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.3",
                "chapter": "Access control",
                "section": "Management of privileged access rights",
                "level": null,
                "requirement": "The allocation and use of privileged access rights shall be restricted and controlled.",
                "relevance": "Specifies controlling privileged access which is required for admin capabilities to configure and amend submitted timesheets.",
                "integration_tips": "Implement privileged access management (PAM) controls for admin accounts, maintain an approval trail for privilege grants, and periodically review privileged accounts.",
                "priority": "High",
                "verification_method": "Inspect PAM configuration and privileged account reviews, and test that privileged operations require appropriate authorization and logging."
              }
            ]
          },
          {
            "high_level_requirement": "Responsive and accessible UI compliant with WCAG guidelines",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "ASVS 14.2",
                "chapter": "Privacy and Integrity",
                "section": "Privacy and Accessibility Considerations",
                "level": "L1",
                "requirement": "Verify that privacy and accessibility considerations are addressed in application design to prevent exclusion and leakage of private data.",
                "relevance": "Addresses accessibility and privacy considerations in UI design; supports WCAG compliance to ensure accessible and privacy-preserving UI.",
                "integration_tips": "Include accessibility checks in design and testing, avoid exposing sensitive data in UI components, and follow WCAG guidance for responsive layouts and alternatives.",
                "priority": "Medium",
                "verification_method": "Perform WCAG conformance testing, accessibility audits, and review UI designs for privacy exposures."
              },
              {
                "standard": "NIST",
                "req_id": "PL-8",
                "chapter": "Planning",
                "section": "Information Security Architecture",
                "level": null,
                "requirement": "Consider accessibility and usability as part of secure system architecture and design.",
                "relevance": "Encourages including accessibility in the security architecture to ensure accessible systems meet security and compliance needs.",
                "integration_tips": "Incorporate accessibility requirements into system architecture and threat models, and include assistive technology testing in QA.",
                "priority": "Low",
                "verification_method": "Review architecture documents for accessibility considerations and test with assistive technologies."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.1",
                "chapter": "System acquisition, development and maintenance",
                "section": "Secure development policy",
                "level": null,
                "requirement": "Security and quality requirements for systems (including usability and accessibility) should be defined and implemented.",
                "relevance": "Requires defining usability and accessibility as quality/security requirements in development, supporting WCAG compliance.",
                "integration_tips": "Document WCAG targets in requirements, perform accessibility testing during development, and maintain remediation plans for issues found.",
                "priority": "Medium",
                "verification_method": "Review requirement documents, test plans, and evidence of WCAG testing and remediation activities."
              }
            ]
          },
          {
            "high_level_requirement": "Data access restrictions based on team hierarchy and least-privilege principles",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-06",
                "chapter": "Access Control",
                "section": "Least Privilege",
                "level": null,
                "requirement": "The organization employs the concept of least privilege, ensuring users are granted only the access necessary to perform their duties.",
                "relevance": "Directly requires least-privilege principles be applied to restrict data access per team hierarchy.",
                "integration_tips": "Implement attribute-based access controls combining role and team attributes, periodically review privileges, and restrict admin capabilities.",
                "priority": "Critical",
                "verification_method": "Audit role assignments and permissions, perform privilege escalation tests, and validate enforcement of team-based filters."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.4.1",
                "chapter": "Access control",
                "section": "Information access restriction",
                "level": null,
                "requirement": "Access to information and application system functions should be restricted in accordance with the access control policy (supports team hierarchy restrictions).",
                "relevance": "Mandates access restrictions aligned with policy, supporting hierarchy-based restrictions required by the application.",
                "integration_tips": "Define access control policy reflecting team hierarchies and implement enforcement in application and data layers with logging.",
                "priority": "High",
                "verification_method": "Review policy and enforcement mechanisms, test cross-team access attempts, and confirm access logs reflect restrictions."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 10.1",
                "chapter": "Access Control",
                "section": "Business Function Access Control",
                "level": "L2",
                "requirement": "Verify access control is applied to business functions and data based on roles and attributes, supporting least privilege and hierarchical restrictions.",
                "relevance": "Specifies applying access control to business functions and data using roles and attributes, essential for team-hierarchy enforcement.",
                "integration_tips": "Use centralized policy engine for attribute-based decisions (role + team), apply data filtering at query time, and protect APIs against elevation attempts.",
                "priority": "Critical",
                "verification_method": "Test attribute-based access control decisions in diverse scenarios and review implementation for gaps."
              }
            ]
          },
          {
            "high_level_requirement": "Data retention, encryption, and export capabilities to support compliance and integrations with payroll/HR",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "MP-6",
                "chapter": "Media Protection",
                "section": "Media Sanitization",
                "level": null,
                "requirement": "Protect and sanitize media containing sensitive information prior to disposal; retention policies shall be enforced.",
                "relevance": "Covers enforcing retention policies and sanitization for data exported or stored for payroll/HR integrations.",
                "integration_tips": "Define retention schedules for timesheet and payroll data, implement scheduled purging and secure disposal, and document retention justifications for compliance.",
                "priority": "High",
                "verification_method": "Review retention policies, confirm automated purging processes, and verify proper sanitization/destruction procedures."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.8.3.3",
                "chapter": "Asset management",
                "section": "Information classification",
                "level": null,
                "requirement": "Information shall be handled in accordance with its classification including retention and protection rules; support secure export.",
                "relevance": "Requires classifying timesheet/payroll data and handling exports according to classification to meet compliance needs.",
                "integration_tips": "Classify data, enforce encryption at rest and in transit for exports, and require contractual/technical controls for HR/payroll integration endpoints.",
                "priority": "Critical",
                "verification_method": "Review classification rules, inspect encryption controls, and test secure export workflows to payroll/HR."
              },
              {
                "standard": "OWASP",
                "req_id": "ASVS 14.1",
                "chapter": "Data Protection",
                "section": "Data at Rest and in Transit",
                "level": "L2",
                "requirement": "Verify that sensitive data is protected at rest and in transit using appropriate cryptography, and that export mechanisms are secure and auditable.",
                "relevance": "Directly addresses encryption and secure export capabilities required for payroll/HR integrations.",
                "integration_tips": "Use strong, up-to-date cryptographic algorithms for data at rest and TLS for transports, and log/export events with integrity checks and access controls.",
                "priority": "Critical",
                "verification_method": "Inspect encryption configurations, test secure export endpoints, and verify audit trails of export operations."
              }
            ]
          }
        ],
        "cross_functional_controls": [
          {
            "control_name": "Audit Logging and Monitoring",
            "description": "Centralized logging of critical events including account lifecycle, timesheet submissions, approvals, delegations, admin changes, exports and notifications to support investigations and compliance.",
            "applies_to": [
              "All requirements that involve user actions, approvals, delegation, admin changes, submissions and exports"
            ],
            "implementation_guidance": "Implement centralized, tamper-evident logging (SIEM or log store), standardize event schemas (actor, timestamp, action, context), protect log access, and establish log retention and review processes."
          },
          {
            "control_name": "Encryption (Data at Rest and in Transit)",
            "description": "Protect sensitive timesheet, personal and payroll/HR-related data using strong cryptography while stored and transmitted.",
            "applies_to": [
              "Authentication/SSO tokens, notifications, stored timesheets, exports and integration endpoints"
            ],
            "implementation_guidance": "Use TLS for transport, AES-256 or equivalent for data at rest, manage keys securely (KMS/PAM), and ensure integrations also use encrypted channels and signed payloads."
          },
          {
            "control_name": "Access Control and RBAC Enforcement",
            "description": "Centralized role-based and attribute-based access control enforcing least privilege across UI, APIs and data layers.",
            "applies_to": [
              "User management, reporting, admin functions, delegation, and data access restrictions"
            ],
            "implementation_guidance": "Use a centralized authorization service/policy engine, enforce checks server-side, maintain role/permission catalog, and require approval workflows for privileged changes."
          },
          {
            "control_name": "Secure Development and Business Logic Validation",
            "description": "Embed validation, business rule enforcement, and threat modeling into the SDLC to prevent logic bypasses and ensure correct state transitions.",
            "applies_to": [
              "Timesheet entry, draft/save/submit workflows, business rules, holiday application and leave management"
            ],
            "implementation_guidance": "Include server-side validation, automated tests for business rules, code reviews, and include business logic abuse cases in threat models and pentests."
          }
        ],
        "recommended_asvs_level": "L2"
      }
    }
  ]
}