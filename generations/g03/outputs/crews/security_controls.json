{
  "raw": "{\n  \"requirements_mapping\": [\n    {\n      \"high_level_requirement\": \"User registration and login with role assignment and secure authentication\",\n      \"requirement_id\": \"REQ-1\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.1.1\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.1 Password Security\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that user registration and login mechanisms require robust authentication, including secure password handling and account lifecycle management.\",\n          \"relevance\": \"Covers secure authentication during registration and login, ensuring robust password practices. Aligns directly with role assignment by enforcing strong authentication before authorization decisions.\",\n          \"integration_tips\": \"Implement password hashing with a modern algorithm (e.g., Argon2id, bcrypt) and enforce complexity and lockout policies. Ensure account lifecycle includes activation, lock, recovery workflows with secure tokens.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review auth flow design, inspect password storage configuration, and test registration/login including account lifecycle.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.1.1\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.1 General Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that a role-based access control (RBAC) or attribute-based access control (ABAC) scheme is enforced at the application level for all protected resources.\",\n          \"relevance\": \"Addresses role assignment and enforcement across resources, essential for separating user capabilities. Ensures authorization checks are centralized and consistent.\",\n          \"integration_tips\": \"Define roles and permissions in a policy store and enforce checks server-side on every request. Use middleware/filters to guard endpoints and include role claims in access tokens.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Policy review, code inspection of authorization middleware, and role-based access tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-2\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"IA-2\",\n          \"level\": null,\n          \"requirement\": \"Identify and authenticate organizational users (and/or processes acting on behalf of users).\",\n          \"relevance\": \"Ensures all users are uniquely identified and authenticated before accessing the system. Underpins secure login and session establishment.\",\n          \"integration_tips\": \"Use unique user IDs, enforce strong authenticators, and bind sessions/tokens to authenticated identities. Log authentication attempts and outcomes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect identity provider configuration, review auth logs, and perform positive/negative login tests.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.3\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"User access provisioning\",\n          \"level\": null,\n          \"requirement\": \"The provisioning of user access rights shall be formalized, including assignment of access rights to all types of users for all systems and services.\",\n          \"relevance\": \"Formalizes role assignment processes and approvals to prevent excessive privileges. Supports onboarding and changes in user roles.\",\n          \"integration_tips\": \"Implement joiner-mover-leaver workflows with approvals and documented RBAC matrices. Periodically review access rights and automate provisioning via IAM.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review access provisioning SOPs, sampling of access requests, and RBAC review records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Email domain verification and tier-based access controls (free vs paid advertisers)\",\n      \"requirement_id\": \"REQ-2\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.2.3\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.2 Authenticator Lifecycle\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application verifies the ownership of an email address or phone number during registration and prior to activation.\",\n          \"relevance\": \"Directly maps to verifying email ownership before granting access or features. Prevents fake or unverified accounts from accessing tiers.\",\n          \"integration_tips\": \"Send signed, single-use, time-limited verification links and require completion before enabling account. Track verification status and block feature access until verified.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional tests of email verification flow and review of token expiry/one-time use implementation.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2.1\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.2 Operation-Level Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that access controls enforce authorization decisions based on the authenticated user's role or attributes.\",\n          \"relevance\": \"Supports tier-based access by enforcing decisions tied to attributes such as subscription status. Ensures paid features are limited to authorized users.\",\n          \"integration_tips\": \"Model tier as user attributes/claims and enforce checks in controllers/services. Use policy-based authorization to centralize logic.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review authorization policies and test scenarios for free vs paid users.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-2\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"Manage information system accounts, including establishing, activating, modifying, disabling, and removing accounts.\",\n          \"relevance\": \"Provides governance for account status changes tied to subscription lifecycle (e.g., downgrades, suspensions). Ensures only active, verified accounts access tiers.\",\n          \"integration_tips\": \"Automate activation post-verification, suspend on non-payment, and remove access on subscription end. Maintain audit trails for account state changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review account lifecycle automation and audit logs for state transitions.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.1.2\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access to networks and network services\",\n          \"level\": null,\n          \"requirement\": \"Users shall only be provided with access to the network and network services that they have been specifically authorized to use.\",\n          \"relevance\": \"Supports restricting platform services to the appropriate tier. Ensures least privilege across service boundaries.\",\n          \"integration_tips\": \"Segment paid-tier services and enforce service-level authorization checks. Configure API gateways to evaluate tier claims.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review service access configurations and test unauthorized access attempts.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User profile management with verifiable contact display options\",\n      \"requirement_id\": \"REQ-3\",\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and protection of personally identifiable information\",\n          \"level\": null,\n          \"requirement\": \"Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.\",\n          \"relevance\": \"PII in user profiles and contact details must be protected and processed lawfully. Governs how contact info is displayed and shared.\",\n          \"integration_tips\": \"Document lawful bases, implement consent where needed, and restrict display of PII via user-controlled settings. Apply masking by default.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review privacy documentation, data flows, and UI settings for PII exposure.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.3\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application collects and processes only the minimum amount of personal data necessary and provides users control over data sharing.\",\n          \"relevance\": \"Ensures profiles collect minimal data and provide controls for showing/hiding verified contacts. Reduces exposure and supports user choice.\",\n          \"integration_tips\": \"Design profile fields as optional where possible, and include per-field visibility toggles. Avoid storing unnecessary contact data.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Design review and UX testing of privacy controls; data inventory check for minimization.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Least Privilege\",\n          \"level\": null,\n          \"requirement\": \"Employ the principle of least privilege, allowing only authorized access for users (and processes acting on behalf of users) which are necessary to accomplish assigned tasks.\",\n          \"relevance\": \"Restricts who can view or modify profile and contact data. Supports controlled display options and backend enforcement.\",\n          \"integration_tips\": \"Enforce per-user and per-field access checks in APIs. Limit support/admin tools to read-only unless explicitly approved.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Access tests for different roles and review of API authorization rules.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.1.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.1 Data Classification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that the application protects personal data and supports data minimization consistent with privacy requirements.\",\n          \"relevance\": \"Classifies profile contact data as personal and enforces appropriate protections. Aligns with display options and minimization.\",\n          \"integration_tips\": \"Mark contact fields as sensitive and apply encryption and access restrictions. Ensure logs do not expose contact details.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review data classification and storage protections; check logs for PII leakage.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Advert creation, edit, delete lifecycle with support for multi-room properties\",\n      \"requirement_id\": \"REQ-4\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2.2\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.2 Operation-Level Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that users can only create, read, update, or delete resources that they own or are authorized to access.\",\n          \"relevance\": \"Ensures advert CRUD actions are limited to owners or authorized roles. Prevents unauthorized modifications across listings.\",\n          \"integration_tips\": \"Implement ownership checks using resource IDs and subject claims. Enforce at service layer and re-check at data access layer.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Unit/integration tests for owner vs non-owner scenarios; code review of authorization checks.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-3\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access Enforcement\",\n          \"level\": null,\n          \"requirement\": \"Enforce approved authorizations for logical access to information and system resources.\",\n          \"relevance\": \"General enforcement mechanism to apply policy for advert lifecycle operations. Supports multi-room record integrity.\",\n          \"integration_tips\": \"Centralize policy enforcement and ensure database queries include ownership constraints. Use deny-by-default posture.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Policy review and data-layer query inspection for authorization predicates.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.1.3\",\n          \"chapter\": \"V5 Validation, Sanitization and Encoding\",\n          \"section\": \"V5.1 Input Validation\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all inputs are validated using positive validation (allow lists) for expected data types, ranges, and formats.\",\n          \"relevance\": \"Advert fields (e.g., room counts, prices) need strict validation to prevent injection and logic abuse. Supports data integrity.\",\n          \"integration_tips\": \"Use server-side schema validation for all advert inputs and normalize data. Sanitize rich text fields and file uploads.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review validation schemas and fuzz test inputs; check that invalid data is rejected.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Security in development and support processes\",\n          \"level\": null,\n          \"requirement\": \"Security testing shall be carried out during development.\",\n          \"relevance\": \"Ensures advert lifecycle features undergo security testing to catch authorization and validation gaps. Reduces deployment risk.\",\n          \"integration_tips\": \"Include security test cases in CI for CRUD operations and access control. Perform code reviews focusing on ownership checks.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Evidence of CI security tests and review records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Automated and manual moderation workflow for adverts and content\",\n      \"requirement_id\": \"REQ-5\",\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-3\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Content of Audit Records\",\n          \"level\": null,\n          \"requirement\": \"Ensure that audit records contain information that establishes what events occurred, the sources of the events, and the outcomes of the events.\",\n          \"relevance\": \"Moderation actions must be auditable to trace who approved/rejected content and why. Supports accountability in workflows.\",\n          \"integration_tips\": \"Log moderation events with actor ID, object, action, reason, and outcome. Use immutable storage or WORM where feasible.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review audit log fields and sample records for completeness.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.1.1\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.1 Logging\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all security-relevant events are logged, including authentication, authorization decisions, and administrative actions.\",\n          \"relevance\": \"Moderation is an administrative function requiring comprehensive logging. Enables forensic review and dispute resolution.\",\n          \"integration_tips\": \"Instrument moderation services to emit structured logs and centralize them. Protect logs with RBAC and integrity controls.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check logging configuration and attempt to access logs with different roles.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Event logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities, exceptions, faults and information security events shall be produced, kept and regularly reviewed.\",\n          \"relevance\": \"Mandates ongoing review of moderation-related logs to detect issues or abuse. Complements automated and manual workflows.\",\n          \"integration_tips\": \"Establish review schedules and alerts for moderation anomalies (e.g., high rejection rate by a user). Document procedures.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review log review procedures and evidence of periodic reviews.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-6\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Review, Analysis, and Reporting\",\n          \"level\": null,\n          \"requirement\": \"Review and analyze information system audit records for indications of inappropriate or unusual activity and report findings.\",\n          \"relevance\": \"Requires active analysis of moderation logs for abuse or errors. Supports both automated alerts and manual oversight.\",\n          \"integration_tips\": \"Create dashboards for moderation KPIs and anomaly detection. Define escalation paths for suspicious patterns.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect SIEM dashboards and alert configurations for moderation events.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Geo-centric search and filtered discovery with map visualisation (approximate locations)\",\n      \"requirement_id\": \"REQ-6\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.2\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application limits collection and retention of location and other sensitive data to the minimum necessary.\",\n          \"relevance\": \"Approximate locations reduce privacy risks in map visualisation. Control mandates limiting collection/retention of geodata.\",\n          \"integration_tips\": \"Store coarse geohashes instead of exact coordinates and purge old location data per retention policy. Disable location logging by default.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review data model and retention jobs; verify only approximate location is exposed.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.4.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.4 Data Minimization\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that sensitive data such as geolocation is not exposed in logs or through APIs beyond what is necessary for business purposes.\",\n          \"relevance\": \"Prevents leakage of exact locations via logs or APIs during geo search and filters. Aligns to privacy-by-design.\",\n          \"integration_tips\": \"Mask or omit exact lat/long in API responses and redact in logs. Implement schema-level allowlists for fields.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"API response and log sampling to confirm no precise coordinates are present.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-8\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Information Security Architecture\",\n          \"level\": null,\n          \"requirement\": \"Develop an information security architecture for the system that describes the requirements and approach to protect organizational information.\",\n          \"relevance\": \"Ensures geo features are designed with security/privacy controls embedded. Guides architecture for map services and data flows.\",\n          \"integration_tips\": \"Document data flows for geo queries, caching, and third-party maps. Include threat modeling for location privacy.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review security architecture documents and threat models covering geo components.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.5\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Regulation of cryptographic controls\",\n          \"level\": null,\n          \"requirement\": \"Cryptographic controls shall be used in compliance with all relevant agreements, legislation and regulations.\",\n          \"relevance\": \"Map data transfer and storage may require cryptographic protections, especially for location data. Ensures compliant crypto usage.\",\n          \"integration_tips\": \"Use TLS for map APIs and encrypt sensitive caches at rest. Maintain cipher suites in line with policy.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Crypto configuration review and TLS scanning of map endpoints.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Advanced filtering, saveable searches, and alerting (instant and daily digest)\",\n      \"requirement_id\": \"REQ-7\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.4.1\",\n          \"chapter\": \"V10 Malicious Software and Business Logic\",\n          \"section\": \"V10.4 Business Logic Security\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application enforces business logic with appropriate limits and thresholds (e.g., rate limits) to prevent abuse.\",\n          \"relevance\": \"Alerting features can be abused for spam or resource exhaustion; rate limits mitigate abuse. Controls align with business logic enforcement.\",\n          \"integration_tips\": \"Apply per-user and per-destination quotas for alerts and digests. Implement backoff and queue throttling.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review rate limit configurations and simulate high-frequency alert creation.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.4.3\",\n          \"chapter\": \"V5 Validation, Sanitization and Encoding\",\n          \"section\": \"V5.4 Sanitization and Output Encoding\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that untrusted data is properly sanitized and output encoded to prevent injection in notifications and alerts.\",\n          \"relevance\": \"Search filters and results may be reflected in notifications; encoding prevents injection in emails/push messages.\",\n          \"integration_tips\": \"Template notifications with strict encoding and avoid HTML from users. Validate and sanitize saved search names/criteria.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review templates and perform injection tests in alert content.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-4\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information System Monitoring\",\n          \"level\": null,\n          \"requirement\": \"Monitor the information system to detect attacks and indicators of potential attacks.\",\n          \"relevance\": \"Monitoring helps detect alerting abuse or anomalous filter activity. Supports operational security of alert pipelines.\",\n          \"integration_tips\": \"Create alerts for unusual spikes in alert generation or delivery failures. Feed logs into SIEM for correlation.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check monitoring rules and SIEM dashboards for alerting subsystem.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.3\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Capacity management\",\n          \"level\": null,\n          \"requirement\": \"The use of resources shall be monitored, tuned and projections made of future capacity requirements to ensure system performance.\",\n          \"relevance\": \"Digest and alert jobs can impact capacity; capacity management ensures stability and prevents DoS-like conditions.\",\n          \"integration_tips\": \"Track queue sizes and throughput; auto-scale workers. Schedule digests to spread load.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Review capacity dashboards and auto-scaling policies.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Favourites/bookmarking and personalised saved-advert lists with organisation tools\",\n      \"requirement_id\": \"REQ-8\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.3.1\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.3 Record-Level Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that users can only access their own records, such as personal lists, favorites, or bookmarks.\",\n          \"relevance\": \"Directly addresses access isolation for saved lists and favorites. Prevents cross-user data exposure.\",\n          \"integration_tips\": \"Enforce user-scoped queries at the data layer and use tenant/user IDs in keys. Add tests for IDOR.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Conduct IDOR testing on list endpoints and inspect ORM scoping rules.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-16\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Security Attributes\",\n          \"level\": null,\n          \"requirement\": \"Associate security attributes with information by information systems and enforce attribute-based policies.\",\n          \"relevance\": \"Using attributes (owner, visibility) supports fine-grained control over lists and sharing options. Enhances policy enforcement.\",\n          \"integration_tips\": \"Tag list records with owner and visibility attributes and enforce at query time. Log attribute changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review database schema and policy enforcement logic for attribute checks.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.1\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Information access restriction\",\n          \"level\": null,\n          \"requirement\": \"Access to information and application system functions shall be restricted in accordance with the access control policy.\",\n          \"relevance\": \"Requires restricting list data and associated functions to authorized users only. Supports defined access policy.\",\n          \"integration_tips\": \"Map list operations to policy rules; implement deny by default. Periodically review permissions.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Policy review and functional testing of access restrictions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.3.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.3 Data in Storage\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that sensitive stored data is protected from unauthorized access and tampering.\",\n          \"relevance\": \"Protects saved lists and notes from tampering and unauthorized reads, especially if containing personal annotations.\",\n          \"integration_tips\": \"Use database-level encryption, strict ACLs, and integrity checks. Avoid exposing identifiers sequentially.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review storage encryption and access controls; test for tampering resistance.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Secure in-app messaging between users with optional verified contact reveal\",\n      \"requirement_id\": \"REQ-9\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.2.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.2 Data in Transit\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all sensitive communications are encrypted in transit using secure protocols.\",\n          \"relevance\": \"In-app messaging contains sensitive content and must be protected in transit. Prevents eavesdropping and tampering.\",\n          \"integration_tips\": \"Enforce TLS 1.2+ for APIs and websockets; use HSTS. Validate certificates and pin where appropriate.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"TLS configuration scan and packet inspection to confirm encryption.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-13\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Cryptographic Protection\",\n          \"level\": null,\n          \"requirement\": \"Employ cryptographic mechanisms to prevent unauthorized disclosure of information and detect changes to information during transmission.\",\n          \"relevance\": \"Mandates robust cryptographic protections for messaging channels. Supports integrity and confidentiality of messages.\",\n          \"integration_tips\": \"Use authenticated encryption ciphersuites; consider message signing if end-to-end requirements exist.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review cipher suites and test integrity verification on message transport.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.8.1\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.8 Re-authentication, Step-up, and MFA\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that re-authentication or step-up authentication is required before performing sensitive actions such as revealing personal contact details.\",\n          \"relevance\": \"Optional contact reveal is a sensitive action that should require step-up checks. Reduces risk of unauthorized exposure.\",\n          \"integration_tips\": \"Prompt for password/MFA re-check before revealing contact info. Use short-lived tokens to authorize the reveal action.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional test of step-up flow and token expiry behavior.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.13.2.3\",\n          \"chapter\": \"Communications security\",\n          \"section\": \"Electronic messaging\",\n          \"level\": null,\n          \"requirement\": \"Information involved in electronic messaging shall be appropriately protected.\",\n          \"relevance\": \"Establishes organizational requirements to safeguard messaging data at rest and in transit. Covers policies and controls.\",\n          \"integration_tips\": \"Define retention limits, enable encryption at rest for message stores, and restrict admin access to message content.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Policy review and storage configuration checks; access audit for admin views.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Interactive map with clustering and approximate location display\",\n      \"requirement_id\": \"REQ-10\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.1\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that privacy requirements such as data minimization and anonymization are addressed in the design.\",\n          \"relevance\": \"Approximate location display should anonymize user locations. Ensures privacy considerations are built into map features.\",\n          \"integration_tips\": \"Use aggregation/clustering thresholds and snap points to grids to avoid pinpointing exact addresses. Avoid storing raw coordinates in the client.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Design review and UI tests to confirm only approximate positions are shown.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.3.1\",\n          \"chapter\": \"V5 Validation, Sanitization and Encoding\",\n          \"section\": \"V5.3 Output Encoding\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that data rendered in the UI, including maps and visualizations, is properly encoded to prevent injection.\",\n          \"relevance\": \"Map popups and labels may render user-supplied data; encoding prevents XSS in map visualizations.\",\n          \"integration_tips\": \"Sanitize and encode all map label fields and disable HTML where possible. Use safe templating APIs.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Dynamic application security testing for XSS in map components.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-7\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Boundary Protection\",\n          \"level\": null,\n          \"requirement\": \"Monitor and control communications at the external boundary and key internal boundaries of the system.\",\n          \"relevance\": \"External map tiles/APIs often cross system boundaries; boundary protection controls access and monitoring.\",\n          \"integration_tips\": \"Route third-party map calls through controlled egress with allowlists and API keys vaulting. Monitor outbound traffic.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Network configuration review and monitoring of egress to mapping services.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.1\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure development policy\",\n          \"level\": null,\n          \"requirement\": \"Rules for the development of software and systems shall be established and applied to developments within the organization.\",\n          \"relevance\": \"Ensures secure coding and review standards apply to map components. Reduces vulnerabilities in interactive UIs.\",\n          \"integration_tips\": \"Adopt secure coding guidelines for frontend visualization and perform code reviews. Include threat modeling for map features.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Check SDLC policy adherence and code review records for map modules.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Notifications system for adverts, messages and moderation status\",\n      \"requirement_id\": \"REQ-11\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.4.2\",\n          \"chapter\": \"V10 Malicious Software and Business Logic\",\n          \"section\": \"V10.4 Business Logic Security\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application enforces anti-automation controls such as rate limiting for notification-triggering actions.\",\n          \"relevance\": \"Notifications can be abused for spamming or DoS; rate limiting protects system and users. Critical for user-triggered alerts.\",\n          \"integration_tips\": \"Throttle per user and per recipient address; implement CAPTCHA/anti-automation on high-risk endpoints.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review rate limiting middleware configuration and attempt burst notification generation.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"Check the validity of information inputs.\",\n          \"relevance\": \"Notification content and addresses must be validated to prevent injection or misrouting. Protects integrity of notifications.\",\n          \"integration_tips\": \"Validate email/phone formats and sanitize message content before enqueue. Reject invalid payloads at API boundary.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Input validation tests and code review of notification payload handling.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.1.2\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.1 Logging\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that logging includes sufficient detail to identify the subject, action, object, timestamp, and outcome for security-relevant events.\",\n          \"relevance\": \"Notification events, especially moderation status changes, need detailed logs for troubleshooting and audits.\",\n          \"integration_tips\": \"Ensure structured logging of notification sends, failures, and user actions with correlation IDs.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review sample logs for required fields and correlation.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.3\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Administrator and operator logs\",\n          \"level\": null,\n          \"requirement\": \"Administrator and operator activities shall be logged and the logs protected and regularly reviewed.\",\n          \"relevance\": \"Admin-triggered notifications (e.g., moderation decisions) must be logged and reviewed. Supports accountability.\",\n          \"integration_tips\": \"Restrict access to logs, enable integrity protection, and schedule reviews of admin activity related to notifications.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Access control check on log store and evidence of periodic reviews.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Administrator and moderator dashboard for content, user and role management\",\n      \"requirement_id\": \"REQ-12\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.1.3\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.1 General Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that administrative interfaces are protected with strong authentication and enforced least privilege.\",\n          \"relevance\": \"Admin and moderator dashboards require stronger protections due to high impact. Enforces least privilege on powerful actions.\",\n          \"integration_tips\": \"Require MFA for admin accounts, isolate admin UI, and implement fine-grained roles for moderation vs admin tasks.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Check admin auth configuration, MFA enforcement, and role matrix.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-5\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"Separate duties of individuals to reduce the risk of malevolent activity without collusion.\",\n          \"relevance\": \"Separates moderating content from managing roles/users to reduce risk. Prevents concentration of power.\",\n          \"integration_tips\": \"Create distinct roles and workflows requiring dual control for sensitive changes. Log approvals and changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review role definitions and evidence of dual-control workflows.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.6\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Removal or adjustment of access rights\",\n          \"level\": null,\n          \"requirement\": \"The access rights of all employees and external party users to information and information processing facilities shall be removed upon termination or adjusted upon change.\",\n          \"relevance\": \"Ensures timely adjustment of admin/moderator access when roles change. Reduces insider risk.\",\n          \"integration_tips\": \"Automate deprovisioning and role adjustments through IAM; tie to HR events. Periodic access reviews.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Access recertification records and deprovisioning audit trails.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-12\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Generation\",\n          \"level\": null,\n          \"requirement\": \"Provide audit record generation capability for defined auditable events within the system.\",\n          \"relevance\": \"Admin dashboards must generate detailed audit records for actions on users and roles. Supports traceability.\",\n          \"integration_tips\": \"Instrument all admin actions to emit auditable events and centralize logs. Protect logs from tampering.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit event catalog review and sampling of admin action logs.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Reporting and abuse-flagging system with dispute handling\",\n      \"requirement_id\": \"REQ-13\",\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IR-4\",\n          \"chapter\": \"Incident Response\",\n          \"section\": \"Incident Handling\",\n          \"level\": null,\n          \"requirement\": \"Implement an incident handling capability for incidents that includes preparation, detection and analysis, containment, eradication, and recovery.\",\n          \"relevance\": \"Abuse reports trigger incident handling processes, including analysis and resolution. Establishes lifecycle for disputes.\",\n          \"integration_tips\": \"Define triage SLAs and playbooks for abuse categories; integrate ticketing with evidence preservation.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review incident response playbooks and recent abuse case records.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.16.1.5\",\n          \"chapter\": \"Information security incident management\",\n          \"section\": \"Response to information security incidents\",\n          \"level\": null,\n          \"requirement\": \"Information security incidents shall be responded to in accordance with the documented procedures.\",\n          \"relevance\": \"Requires documented procedures for reacting to abuse/disputes. Ensures consistency and compliance.\",\n          \"integration_tips\": \"Create procedures covering intake, investigation, user communication, and closure. Train staff and log actions.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Procedure review and training records; audit of closed dispute tickets.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.2.1\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.2 Log Security\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that logs are protected from unauthorized access, tampering, and deletion.\",\n          \"relevance\": \"Abuse reports may be evidence; logs must be protected to maintain integrity for dispute handling.\",\n          \"integration_tips\": \"Use append-only log storage and restrict administrative access. Enable integrity checks and alerts on modifications.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Configuration review of log storage and integrity verification mechanisms.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"CM-9\",\n          \"chapter\": \"Configuration Management\",\n          \"section\": \"Configuration Management Plan\",\n          \"level\": null,\n          \"requirement\": \"Develop, document, and implement a configuration management plan for the system that addresses roles, responsibilities, and configuration control.\",\n          \"relevance\": \"Supports controlled changes to abuse handling workflows and tools, minimizing errors during disputes.\",\n          \"integration_tips\": \"Document roles and change approval for moderation/abuse tooling configuration. Track changes in version control.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Review CM plan and change logs for abuse tooling.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Automated expiry handling and lifecycle enforcement for adverts\",\n      \"requirement_id\": \"REQ-14\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.4.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.4 Data Minimization\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that data retention and disposal for sensitive data is defined, aligned to business need and regulatory requirements.\",\n          \"relevance\": \"Adverts should expire and be purged/archived per policy to reduce data exposure. Defines lifecycle enforcement.\",\n          \"integration_tips\": \"Implement retention policies and scheduled jobs to archive or delete expired adverts; document exceptions.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review retention schedules and job configurations; sample expired records.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-11\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Record Retention\",\n          \"level\": null,\n          \"requirement\": \"Retain audit records for an organization-defined time period to provide support for after-the-fact investigations.\",\n          \"relevance\": \"While adverts expire, related audit records must be retained appropriately for investigations. Balances lifecycle with audit needs.\",\n          \"integration_tips\": \"Separate advert content lifecycle from audit log retention; configure different retention windows and storage classes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Policy review and storage configuration for differing retention periods.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.7.1\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.7 Session Management\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that sessions have a defined idle timeout and absolute timeout aligned to the business risk.\",\n          \"relevance\": \"Though session-focused, timeouts exemplify lifecycle enforcement of time-bound entities. Supports consistent expiry handling patterns.\",\n          \"integration_tips\": \"Adopt similar scheduled expiration patterns for adverts as sessions: absolute end-of-life and grace periods.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Check timeout settings and compare with advert expiry jobs for consistency.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Paid-tier features: priority listing, branding, analytics, subscription and one-off payments\",\n      \"requirement_id\": \"REQ-15\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2.3\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.2 Operation-Level Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application enforces authorization checks for each function, especially paid or premium features.\",\n          \"relevance\": \"Critical to ensure only paying users access premium features like priority listings and branding.\",\n          \"integration_tips\": \"Gate premium endpoints on subscription status claims and re-check on each call. Include checks in background jobs as well.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Attempt to access premium features with non-paid accounts; review authorization middleware.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.4.3\",\n          \"chapter\": \"V10 Malicious Software and Business Logic\",\n          \"section\": \"V10.4 Business Logic Security\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that business logic enforces integrity of transactions and prevents abuse such as privilege escalation or bypass of payment checks.\",\n          \"relevance\": \"Prevents users from bypassing payment or escalating privileges to gain premium features.\",\n          \"integration_tips\": \"Implement server-side verification of payment status with PSP, and integrity checks on feature flags. Log anomalies.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Business logic tests simulating tampering with client-side flags and stale receipts.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Event Logging\",\n          \"level\": null,\n          \"requirement\": \"Define auditable events and ensure that the information system generates audit records for those events.\",\n          \"relevance\": \"Paid feature access and changes to subscription states must be auditable for dispute resolution and fraud detection.\",\n          \"integration_tips\": \"Log subscription activations, cancellations, and premium feature access with user and transaction IDs.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Audit event catalog review and sampling of payment-related logs.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.1\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Documented operating procedures\",\n          \"level\": null,\n          \"requirement\": \"Operating procedures shall be documented and made available to all users who need them.\",\n          \"relevance\": \"Defines procedures for subscription management, refunds, and disputes to reduce errors and fraud.\",\n          \"integration_tips\": \"Document SOPs for handling subscription changes and one-off payments; train support staff.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"SOP review and training records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Secure payment gateway integration and payment record management\",\n      \"requirement_id\": \"REQ-16\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.2.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.2 Data in Transit\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that connections to external payment service providers use strong TLS and validate certificates.\",\n          \"relevance\": \"Protects payment data in transit to PSPs, preventing MITM attacks. Essential for secure gateway integration.\",\n          \"integration_tips\": \"Enforce TLS 1.2+ with certificate validation and hostname verification; consider certificate pinning for PSP endpoints.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"TLS scan and connection tests to PSP endpoints; review client configuration.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.3.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.3 Data in Storage\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that payment-related data stored is minimized and protected using strong encryption and key management.\",\n          \"relevance\": \"Minimizes and protects stored payment records, reducing PCI scope and breach impact.\",\n          \"integration_tips\": \"Avoid storing PAN; store only tokens and necessary metadata encrypted with strong KMS-managed keys. Restrict access via RBAC.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Data inventory and storage encryption configuration review; access audit.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.15.1.1\",\n          \"chapter\": \"Supplier relationships\",\n          \"section\": \"Information security policy for supplier relationships\",\n          \"level\": null,\n          \"requirement\": \"Information security requirements for mitigating the risks associated with supplier\u2019s access to the organization\u2019s assets shall be agreed with the supplier and documented.\",\n          \"relevance\": \"Covers contractual and security requirements with payment gateway providers. Ensures third-party compliance.\",\n          \"integration_tips\": \"Define SLAs, security clauses, breach notification, and data protection requirements with the PSP. Review SOC/PCI reports.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Supplier agreement review and third-party assurance evidence.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SA-9\",\n          \"chapter\": \"System and Services Acquisition\",\n          \"section\": \"External Information System Services\",\n          \"level\": null,\n          \"requirement\": \"Require that providers of external information system services comply with organizational information security requirements.\",\n          \"relevance\": \"Mandates that the PSP meets security requirements, aligning integration with organizational policies.\",\n          \"integration_tips\": \"Assess PSP security posture and include compliance reporting requirements. Monitor PSP changes impacting security.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Third-party risk assessment records and periodic reassessment reports.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Logging, audit trails, and analytics for moderation, payments and admin actions\",\n      \"requirement_id\": \"REQ-17\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.1.3\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.1 Logging\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that logs are generated for administrative actions, access control events, and security-relevant events.\",\n          \"relevance\": \"Directly addresses logging of admin actions, payments, and moderation as security-relevant events.\",\n          \"integration_tips\": \"Adopt structured logging with unique IDs; centralize logs in a SIEM; ensure clocks are synchronized.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Log sampling and SIEM ingestion verification for all target event types.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-8\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Time Stamps\",\n          \"level\": null,\n          \"requirement\": \"Use internal system clocks to generate time stamps for audit records with sufficient granularity to meet system requirements.\",\n          \"relevance\": \"Accurate timestamps are vital for correlating events across moderation and payment systems.\",\n          \"integration_tips\": \"Enable NTP across services and include timezone and precision in logs. Use consistent time formats (e.g., RFC3339).\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check NTP configuration and compare timestamps across services.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.2\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Protection of log information\",\n          \"level\": null,\n          \"requirement\": \"Logging facilities and log information shall be protected against tampering and unauthorized access.\",\n          \"relevance\": \"Protects audit trails integrity for high-stakes areas like payments and admin actions.\",\n          \"integration_tips\": \"Use append-only storage, role-based access to logs, and cryptographic integrity verification.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect log storage controls and integrity check outcomes.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-9\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Protection of Audit Information\",\n          \"level\": null,\n          \"requirement\": \"Protect audit information and audit tools from unauthorized access, modification, and deletion.\",\n          \"relevance\": \"Ensures audit data and tooling cannot be tampered with by admins or attackers. Critical for trustworthiness.\",\n          \"integration_tips\": \"Separate duties for log management; restrict and monitor access to SIEM and log pipelines.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Access review for log tools and attempted unauthorized modification test.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Privacy and data protection controls (GDPR compliance, consent management, data subject requests)\",\n      \"requirement_id\": \"REQ-18\",\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and protection of personally identifiable information\",\n          \"level\": null,\n          \"requirement\": \"Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.\",\n          \"relevance\": \"Directly mandates GDPR-aligned protections for PII, covering lawful processing and safeguards.\",\n          \"integration_tips\": \"Map processing activities, implement DPIAs where applicable, and enforce access controls on PII.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review ROPA/DPIA documents and PII access controls.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.4\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that consent is obtained, recorded, and can be withdrawn for personal data processing.\",\n          \"relevance\": \"Covers consent management lifecycle required by GDPR, including withdrawal.\",\n          \"integration_tips\": \"Implement a consent store with versioning and timestamps; enforce consent checks in data processing flows.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Examine consent records and test withdrawal propagation to processing systems.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AR-8\",\n          \"chapter\": \"Authority and Purpose (Privacy)\",\n          \"section\": \"Accounting of Disclosures\",\n          \"level\": null,\n          \"requirement\": \"Provide an accounting of disclosures of personally identifiable information to individuals upon request.\",\n          \"relevance\": \"Supports GDPR data subject rights by tracking disclosures for subject access requests.\",\n          \"integration_tips\": \"Maintain disclosure logs linked to data subjects and expose them via DSAR workflows.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review disclosure log schema and perform a test DSAR.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.1\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Identification of applicable legislation and contractual requirements\",\n          \"level\": null,\n          \"requirement\": \"All relevant legislative statutory, regulatory and contractual requirements shall be explicitly identified and documented for each information system.\",\n          \"relevance\": \"Requires identifying GDPR and other legal obligations, forming the basis of privacy control implementation.\",\n          \"integration_tips\": \"Maintain a compliance register mapping requirements to controls and evidence. Review updates regularly.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Audit the compliance register and control mappings.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Security controls: encryption in transit and at rest, RBAC, MFA option, rate limiting and anti-abuse protections\",\n      \"requirement_id\": \"REQ-19\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.1.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.1 Data Classification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all sensitive data is identified and classified, and appropriate protections are applied.\",\n          \"relevance\": \"Data classification is prerequisite to applying correct encryption at rest/in transit and access controls.\",\n          \"integration_tips\": \"Create a data classification inventory and map protections (TLS, encryption at rest, access policies) per class.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review data inventory and control mappings to classification levels.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-12\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Cryptographic Key Establishment and Management\",\n          \"level\": null,\n          \"requirement\": \"Establish and manage cryptographic keys for required cryptography employed within the information system.\",\n          \"relevance\": \"Proper key management underpins encryption at rest and in transit. Prevents compromise of protected data.\",\n          \"integration_tips\": \"Use managed KMS/HSM for key lifecycle, rotation, and access controls; enforce separation of duties for key admins.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Key management policy review and evidence of key rotation/audit logs.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.7.5\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.7 Session Management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that session management and authentication support multi-factor authentication where appropriate.\",\n          \"relevance\": \"Satisfies MFA option requirement to harden authentication. Reduces account takeover risk.\",\n          \"integration_tips\": \"Offer TOTP/WebAuthn MFA and provide recovery mechanisms; enforce MFA for high-privilege roles.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Test MFA enrollment and enforcement; review auth configuration.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"Check the validity of information inputs.\",\n          \"relevance\": \"Input validation is fundamental to anti-abuse; combined with rate limiting prevents injection and resource abuse.\",\n          \"integration_tips\": \"Apply centralized validation schemas and integrate with rate-limiting middleware at gateway level.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Code review of validation and gateway configs; fuzz testing of endpoints.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Accessibility and mobile responsiveness (WCAG conformance target)\",\n      \"requirement_id\": \"REQ-20\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.3.1\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.3 Secure Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that security is addressed in user experience and design, including error messages and user guidance that do not leak sensitive information.\",\n          \"relevance\": \"While WCAG is accessibility-focused, secure UX ensures accessible error handling without leaking sensitive data.\",\n          \"integration_tips\": \"Design accessible error states and guidance that are clear yet do not expose internals. Include security considerations in UX reviews.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"UX review of error messages and accessibility testing.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.3.1\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.3 Error Handling\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that error messages are handled in a user-friendly manner without revealing sensitive information.\",\n          \"relevance\": \"Accessible applications need clear errors, but they must not expose sensitive details. This balances both goals.\",\n          \"integration_tips\": \"Return generic messages to users and detailed errors only in logs. Ensure messages meet accessibility guidelines (e.g., ARIA).\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"UI testing for error content and accessibility audits.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.1\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure development policy\",\n          \"level\": null,\n          \"requirement\": \"Rules for the development of software and systems shall be established and applied to developments within the organization.\",\n          \"relevance\": \"Secure development policies should include accessibility considerations to reduce security issues in responsive UIs.\",\n          \"integration_tips\": \"Incorporate accessibility checks into SDLC and code review policies alongside security checks.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Policy review and pipeline checks for accessibility/security gates.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"RA-5\",\n          \"chapter\": \"Risk Assessment\",\n          \"section\": \"Vulnerability Monitoring and Scanning\",\n          \"level\": null,\n          \"requirement\": \"Scan for vulnerabilities in the information system and hosted applications and address identified vulnerabilities.\",\n          \"relevance\": \"Responsive frontends may introduce security flaws; ongoing scanning and remediation sustains a secure, accessible experience.\",\n          \"integration_tips\": \"Run regular dynamic scans against mobile and responsive views and triage findings promptly.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Scan reports and remediation tracking.\"\n        }\n      ]\n    }\n  ],\n  \"cross_functional_controls\": [\n    {\n      \"control_name\": \"Transport Layer Security\",\n      \"description\": \"Encrypt all data in transit using strong TLS and validate certificates.\",\n      \"applies_to\": [\n        \"User registration and login with role assignment and secure authentication\",\n        \"Secure in-app messaging between users with optional verified contact reveal\",\n        \"Secure payment gateway integration and payment record management\",\n        \"Notifications system for adverts, messages and moderation status\",\n        \"Interactive map with clustering and approximate location display\"\n      ],\n      \"implementation_guidance\": \"Enforce TLS 1.2+ with modern ciphers, HSTS, and certificate validation/pinning where appropriate.\"\n    },\n    {\n      \"control_name\": \"Centralized Authorization (RBAC/ABAC)\",\n      \"description\": \"Consistent server-side authorization for all protected resources and operations.\",\n      \"applies_to\": [\n        \"User registration and login with role assignment and secure authentication\",\n        \"Email domain verification and tier-based access controls (free vs paid advertisers)\",\n        \"Advert creation, edit, delete lifecycle with support for multi-room properties\",\n        \"Administrator and moderator dashboard for content, user and role management\",\n        \"Paid-tier features: priority listing, branding, analytics, subscription and one-off payments\"\n      ],\n      \"implementation_guidance\": \"Use a policy engine or middleware to enforce per-request checks based on roles/attributes; deny by default.\"\n    },\n    {\n      \"control_name\": \"Comprehensive Logging and Audit\",\n      \"description\": \"Generate, protect, and review logs for security-relevant events and administrative activities.\",\n      \"applies_to\": [\n        \"Automated and manual moderation workflow for adverts and content\",\n        \"Notifications system for adverts, messages and moderation status\",\n        \"Administrator and moderator dashboard for content, user and role management\",\n        \"Logging, audit trails, and analytics for moderation, payments and admin actions\",\n        \"Reporting and abuse-flagging system with dispute handling\"\n      ],\n      \"implementation_guidance\": \"Use structured logs with timestamps and correlation IDs; protect logs from tampering and perform regular reviews in a SIEM.\"\n    },\n    {\n      \"control_name\": \"Input Validation and Output Encoding\",\n      \"description\": \"Validate all inputs and encode outputs to prevent injection and XSS.\",\n      \"applies_to\": [\n        \"Advert creation, edit, delete lifecycle with support for multi-room properties\",\n        \"Advanced filtering, saveable searches, and alerting (instant and daily digest)\",\n        \"Interactive map with clustering and approximate location display\",\n        \"Notifications system for adverts, messages and moderation status\"\n      ],\n      \"implementation_guidance\": \"Adopt positive validation using schemas and perform contextual output encoding in templates and UI components.\"\n    },\n    {\n      \"control_name\": \"Privacy by Design and Data Minimization\",\n      \"description\": \"Minimize collection and exposure of personal and location data and provide user controls.\",\n      \"applies_to\": [\n        \"User profile management with verifiable contact display options\",\n        \"Geo-centric search and filtered discovery with map visualisation (approximate locations)\",\n        \"Interactive map with clustering and approximate location display\",\n        \"Privacy and data protection controls (GDPR compliance, consent management, data subject requests)\"\n      ],\n      \"implementation_guidance\": \"Classify data, limit retention, mask or approximate sensitive fields, and implement consent and data subject rights workflows.\"\n    }\n  ],\n  \"recommended_asvs_level\": \"L2\"\n}",
  "pydantic": {
    "requirements_mapping": [
      {
        "high_level_requirement": "User registration and login with role assignment and secure authentication",
        "requirement_id": "REQ-1",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V2.1.1",
            "chapter": "V2 Authentication Verification Requirements",
            "section": "V2.1 Password Security",
            "level": "L1",
            "requirement": "Verify that user registration and login mechanisms require robust authentication, including secure password handling and account lifecycle management.",
            "relevance": "Covers secure authentication during registration and login, ensuring robust password practices. Aligns directly with role assignment by enforcing strong authentication before authorization decisions.",
            "integration_tips": "Implement password hashing with a modern algorithm (e.g., Argon2id, bcrypt) and enforce complexity and lockout policies. Ensure account lifecycle includes activation, lock, recovery workflows with secure tokens.",
            "priority": "Critical",
            "verification_method": "Review auth flow design, inspect password storage configuration, and test registration/login including account lifecycle."
          },
          {
            "standard": "OWASP",
            "req_id": "V4.1.1",
            "chapter": "V4 Access Control Verification Requirements",
            "section": "V4.1 General Access Control",
            "level": "L1",
            "requirement": "Verify that a role-based access control (RBAC) or attribute-based access control (ABAC) scheme is enforced at the application level for all protected resources.",
            "relevance": "Addresses role assignment and enforcement across resources, essential for separating user capabilities. Ensures authorization checks are centralized and consistent.",
            "integration_tips": "Define roles and permissions in a policy store and enforce checks server-side on every request. Use middleware/filters to guard endpoints and include role claims in access tokens.",
            "priority": "Critical",
            "verification_method": "Policy review, code inspection of authorization middleware, and role-based access tests."
          },
          {
            "standard": "NIST",
            "req_id": "IA-2",
            "chapter": "Identification and Authentication",
            "section": "IA-2",
            "level": null,
            "requirement": "Identify and authenticate organizational users (and/or processes acting on behalf of users).",
            "relevance": "Ensures all users are uniquely identified and authenticated before accessing the system. Underpins secure login and session establishment.",
            "integration_tips": "Use unique user IDs, enforce strong authenticators, and bind sessions/tokens to authenticated identities. Log authentication attempts and outcomes.",
            "priority": "Critical",
            "verification_method": "Inspect identity provider configuration, review auth logs, and perform positive/negative login tests."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.3",
            "chapter": "Access Control",
            "section": "User access provisioning",
            "level": null,
            "requirement": "The provisioning of user access rights shall be formalized, including assignment of access rights to all types of users for all systems and services.",
            "relevance": "Formalizes role assignment processes and approvals to prevent excessive privileges. Supports onboarding and changes in user roles.",
            "integration_tips": "Implement joiner-mover-leaver workflows with approvals and documented RBAC matrices. Periodically review access rights and automate provisioning via IAM.",
            "priority": "High",
            "verification_method": "Review access provisioning SOPs, sampling of access requests, and RBAC review records."
          }
        ]
      },
      {
        "high_level_requirement": "Email domain verification and tier-based access controls (free vs paid advertisers)",
        "requirement_id": "REQ-2",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V2.2.3",
            "chapter": "V2 Authentication Verification Requirements",
            "section": "V2.2 Authenticator Lifecycle",
            "level": "L2",
            "requirement": "Verify that the application verifies the ownership of an email address or phone number during registration and prior to activation.",
            "relevance": "Directly maps to verifying email ownership before granting access or features. Prevents fake or unverified accounts from accessing tiers.",
            "integration_tips": "Send signed, single-use, time-limited verification links and require completion before enabling account. Track verification status and block feature access until verified.",
            "priority": "High",
            "verification_method": "Functional tests of email verification flow and review of token expiry/one-time use implementation."
          },
          {
            "standard": "OWASP",
            "req_id": "V4.2.1",
            "chapter": "V4 Access Control Verification Requirements",
            "section": "V4.2 Operation-Level Access Control",
            "level": "L1",
            "requirement": "Verify that access controls enforce authorization decisions based on the authenticated user's role or attributes.",
            "relevance": "Supports tier-based access by enforcing decisions tied to attributes such as subscription status. Ensures paid features are limited to authorized users.",
            "integration_tips": "Model tier as user attributes/claims and enforce checks in controllers/services. Use policy-based authorization to centralize logic.",
            "priority": "Critical",
            "verification_method": "Review authorization policies and test scenarios for free vs paid users."
          },
          {
            "standard": "NIST",
            "req_id": "AC-2",
            "chapter": "Access Control",
            "section": "Account Management",
            "level": null,
            "requirement": "Manage information system accounts, including establishing, activating, modifying, disabling, and removing accounts.",
            "relevance": "Provides governance for account status changes tied to subscription lifecycle (e.g., downgrades, suspensions). Ensures only active, verified accounts access tiers.",
            "integration_tips": "Automate activation post-verification, suspend on non-payment, and remove access on subscription end. Maintain audit trails for account state changes.",
            "priority": "High",
            "verification_method": "Review account lifecycle automation and audit logs for state transitions."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.1.2",
            "chapter": "Access Control",
            "section": "Access to networks and network services",
            "level": null,
            "requirement": "Users shall only be provided with access to the network and network services that they have been specifically authorized to use.",
            "relevance": "Supports restricting platform services to the appropriate tier. Ensures least privilege across service boundaries.",
            "integration_tips": "Segment paid-tier services and enforce service-level authorization checks. Configure API gateways to evaluate tier claims.",
            "priority": "Medium",
            "verification_method": "Review service access configurations and test unauthorized access attempts."
          }
        ]
      },
      {
        "high_level_requirement": "User profile management with verifiable contact display options",
        "requirement_id": "REQ-3",
        "security_controls": [
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.4",
            "chapter": "Compliance",
            "section": "Privacy and protection of personally identifiable information",
            "level": null,
            "requirement": "Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.",
            "relevance": "PII in user profiles and contact details must be protected and processed lawfully. Governs how contact info is displayed and shared.",
            "integration_tips": "Document lawful bases, implement consent where needed, and restrict display of PII via user-controlled settings. Apply masking by default.",
            "priority": "Critical",
            "verification_method": "Review privacy documentation, data flows, and UI settings for PII exposure."
          },
          {
            "standard": "OWASP",
            "req_id": "V1.4.3",
            "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
            "section": "V1.4 Privacy by Design",
            "level": "L2",
            "requirement": "Verify that the application collects and processes only the minimum amount of personal data necessary and provides users control over data sharing.",
            "relevance": "Ensures profiles collect minimal data and provide controls for showing/hiding verified contacts. Reduces exposure and supports user choice.",
            "integration_tips": "Design profile fields as optional where possible, and include per-field visibility toggles. Avoid storing unnecessary contact data.",
            "priority": "High",
            "verification_method": "Design review and UX testing of privacy controls; data inventory check for minimization."
          },
          {
            "standard": "NIST",
            "req_id": "AC-6",
            "chapter": "Access Control",
            "section": "Least Privilege",
            "level": null,
            "requirement": "Employ the principle of least privilege, allowing only authorized access for users (and processes acting on behalf of users) which are necessary to accomplish assigned tasks.",
            "relevance": "Restricts who can view or modify profile and contact data. Supports controlled display options and backend enforcement.",
            "integration_tips": "Enforce per-user and per-field access checks in APIs. Limit support/admin tools to read-only unless explicitly approved.",
            "priority": "High",
            "verification_method": "Access tests for different roles and review of API authorization rules."
          },
          {
            "standard": "OWASP",
            "req_id": "V9.1.1",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.1 Data Classification",
            "level": "L1",
            "requirement": "Verify that the application protects personal data and supports data minimization consistent with privacy requirements.",
            "relevance": "Classifies profile contact data as personal and enforces appropriate protections. Aligns with display options and minimization.",
            "integration_tips": "Mark contact fields as sensitive and apply encryption and access restrictions. Ensure logs do not expose contact details.",
            "priority": "High",
            "verification_method": "Review data classification and storage protections; check logs for PII leakage."
          }
        ]
      },
      {
        "high_level_requirement": "Advert creation, edit, delete lifecycle with support for multi-room properties",
        "requirement_id": "REQ-4",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.2.2",
            "chapter": "V4 Access Control Verification Requirements",
            "section": "V4.2 Operation-Level Access Control",
            "level": "L1",
            "requirement": "Verify that users can only create, read, update, or delete resources that they own or are authorized to access.",
            "relevance": "Ensures advert CRUD actions are limited to owners or authorized roles. Prevents unauthorized modifications across listings.",
            "integration_tips": "Implement ownership checks using resource IDs and subject claims. Enforce at service layer and re-check at data access layer.",
            "priority": "Critical",
            "verification_method": "Unit/integration tests for owner vs non-owner scenarios; code review of authorization checks."
          },
          {
            "standard": "NIST",
            "req_id": "AC-3",
            "chapter": "Access Control",
            "section": "Access Enforcement",
            "level": null,
            "requirement": "Enforce approved authorizations for logical access to information and system resources.",
            "relevance": "General enforcement mechanism to apply policy for advert lifecycle operations. Supports multi-room record integrity.",
            "integration_tips": "Centralize policy enforcement and ensure database queries include ownership constraints. Use deny-by-default posture.",
            "priority": "High",
            "verification_method": "Policy review and data-layer query inspection for authorization predicates."
          },
          {
            "standard": "OWASP",
            "req_id": "V5.1.3",
            "chapter": "V5 Validation, Sanitization and Encoding",
            "section": "V5.1 Input Validation",
            "level": "L1",
            "requirement": "Verify that all inputs are validated using positive validation (allow lists) for expected data types, ranges, and formats.",
            "relevance": "Advert fields (e.g., room counts, prices) need strict validation to prevent injection and logic abuse. Supports data integrity.",
            "integration_tips": "Use server-side schema validation for all advert inputs and normalize data. Sanitize rich text fields and file uploads.",
            "priority": "High",
            "verification_method": "Review validation schemas and fuzz test inputs; check that invalid data is rejected."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.5",
            "chapter": "System acquisition, development and maintenance",
            "section": "Security in development and support processes",
            "level": null,
            "requirement": "Security testing shall be carried out during development.",
            "relevance": "Ensures advert lifecycle features undergo security testing to catch authorization and validation gaps. Reduces deployment risk.",
            "integration_tips": "Include security test cases in CI for CRUD operations and access control. Perform code reviews focusing on ownership checks.",
            "priority": "Medium",
            "verification_method": "Evidence of CI security tests and review records."
          }
        ]
      },
      {
        "high_level_requirement": "Automated and manual moderation workflow for adverts and content",
        "requirement_id": "REQ-5",
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AU-3",
            "chapter": "Audit and Accountability",
            "section": "Content of Audit Records",
            "level": null,
            "requirement": "Ensure that audit records contain information that establishes what events occurred, the sources of the events, and the outcomes of the events.",
            "relevance": "Moderation actions must be auditable to trace who approved/rejected content and why. Supports accountability in workflows.",
            "integration_tips": "Log moderation events with actor ID, object, action, reason, and outcome. Use immutable storage or WORM where feasible.",
            "priority": "High",
            "verification_method": "Review audit log fields and sample records for completeness."
          },
          {
            "standard": "OWASP",
            "req_id": "V7.1.1",
            "chapter": "V7 Error Handling and Logging",
            "section": "V7.1 Logging",
            "level": "L1",
            "requirement": "Verify that all security-relevant events are logged, including authentication, authorization decisions, and administrative actions.",
            "relevance": "Moderation is an administrative function requiring comprehensive logging. Enables forensic review and dispute resolution.",
            "integration_tips": "Instrument moderation services to emit structured logs and centralize them. Protect logs with RBAC and integrity controls.",
            "priority": "High",
            "verification_method": "Check logging configuration and attempt to access logs with different roles."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.1",
            "chapter": "Operations security",
            "section": "Event logging",
            "level": null,
            "requirement": "Event logs recording user activities, exceptions, faults and information security events shall be produced, kept and regularly reviewed.",
            "relevance": "Mandates ongoing review of moderation-related logs to detect issues or abuse. Complements automated and manual workflows.",
            "integration_tips": "Establish review schedules and alerts for moderation anomalies (e.g., high rejection rate by a user). Document procedures.",
            "priority": "Medium",
            "verification_method": "Review log review procedures and evidence of periodic reviews."
          },
          {
            "standard": "NIST",
            "req_id": "AU-6",
            "chapter": "Audit and Accountability",
            "section": "Audit Review, Analysis, and Reporting",
            "level": null,
            "requirement": "Review and analyze information system audit records for indications of inappropriate or unusual activity and report findings.",
            "relevance": "Requires active analysis of moderation logs for abuse or errors. Supports both automated alerts and manual oversight.",
            "integration_tips": "Create dashboards for moderation KPIs and anomaly detection. Define escalation paths for suspicious patterns.",
            "priority": "Medium",
            "verification_method": "Inspect SIEM dashboards and alert configurations for moderation events."
          }
        ]
      },
      {
        "high_level_requirement": "Geo-centric search and filtered discovery with map visualisation (approximate locations)",
        "requirement_id": "REQ-6",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V1.4.2",
            "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
            "section": "V1.4 Privacy by Design",
            "level": "L2",
            "requirement": "Verify that the application limits collection and retention of location and other sensitive data to the minimum necessary.",
            "relevance": "Approximate locations reduce privacy risks in map visualisation. Control mandates limiting collection/retention of geodata.",
            "integration_tips": "Store coarse geohashes instead of exact coordinates and purge old location data per retention policy. Disable location logging by default.",
            "priority": "High",
            "verification_method": "Review data model and retention jobs; verify only approximate location is exposed."
          },
          {
            "standard": "OWASP",
            "req_id": "V9.4.1",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.4 Data Minimization",
            "level": "L1",
            "requirement": "Verify that sensitive data such as geolocation is not exposed in logs or through APIs beyond what is necessary for business purposes.",
            "relevance": "Prevents leakage of exact locations via logs or APIs during geo search and filters. Aligns to privacy-by-design.",
            "integration_tips": "Mask or omit exact lat/long in API responses and redact in logs. Implement schema-level allowlists for fields.",
            "priority": "High",
            "verification_method": "API response and log sampling to confirm no precise coordinates are present."
          },
          {
            "standard": "NIST",
            "req_id": "PL-8",
            "chapter": "Planning",
            "section": "Information Security Architecture",
            "level": null,
            "requirement": "Develop an information security architecture for the system that describes the requirements and approach to protect organizational information.",
            "relevance": "Ensures geo features are designed with security/privacy controls embedded. Guides architecture for map services and data flows.",
            "integration_tips": "Document data flows for geo queries, caching, and third-party maps. Include threat modeling for location privacy.",
            "priority": "Medium",
            "verification_method": "Review security architecture documents and threat models covering geo components."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.5",
            "chapter": "Compliance",
            "section": "Regulation of cryptographic controls",
            "level": null,
            "requirement": "Cryptographic controls shall be used in compliance with all relevant agreements, legislation and regulations.",
            "relevance": "Map data transfer and storage may require cryptographic protections, especially for location data. Ensures compliant crypto usage.",
            "integration_tips": "Use TLS for map APIs and encrypt sensitive caches at rest. Maintain cipher suites in line with policy.",
            "priority": "Medium",
            "verification_method": "Crypto configuration review and TLS scanning of map endpoints."
          }
        ]
      },
      {
        "high_level_requirement": "Advanced filtering, saveable searches, and alerting (instant and daily digest)",
        "requirement_id": "REQ-7",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V10.4.1",
            "chapter": "V10 Malicious Software and Business Logic",
            "section": "V10.4 Business Logic Security",
            "level": "L2",
            "requirement": "Verify that the application enforces business logic with appropriate limits and thresholds (e.g., rate limits) to prevent abuse.",
            "relevance": "Alerting features can be abused for spam or resource exhaustion; rate limits mitigate abuse. Controls align with business logic enforcement.",
            "integration_tips": "Apply per-user and per-destination quotas for alerts and digests. Implement backoff and queue throttling.",
            "priority": "High",
            "verification_method": "Review rate limit configurations and simulate high-frequency alert creation."
          },
          {
            "standard": "OWASP",
            "req_id": "V5.4.3",
            "chapter": "V5 Validation, Sanitization and Encoding",
            "section": "V5.4 Sanitization and Output Encoding",
            "level": "L1",
            "requirement": "Verify that untrusted data is properly sanitized and output encoded to prevent injection in notifications and alerts.",
            "relevance": "Search filters and results may be reflected in notifications; encoding prevents injection in emails/push messages.",
            "integration_tips": "Template notifications with strict encoding and avoid HTML from users. Validate and sanitize saved search names/criteria.",
            "priority": "High",
            "verification_method": "Review templates and perform injection tests in alert content."
          },
          {
            "standard": "NIST",
            "req_id": "SI-4",
            "chapter": "System and Information Integrity",
            "section": "Information System Monitoring",
            "level": null,
            "requirement": "Monitor the information system to detect attacks and indicators of potential attacks.",
            "relevance": "Monitoring helps detect alerting abuse or anomalous filter activity. Supports operational security of alert pipelines.",
            "integration_tips": "Create alerts for unusual spikes in alert generation or delivery failures. Feed logs into SIEM for correlation.",
            "priority": "Medium",
            "verification_method": "Check monitoring rules and SIEM dashboards for alerting subsystem."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.1.3",
            "chapter": "Operations security",
            "section": "Capacity management",
            "level": null,
            "requirement": "The use of resources shall be monitored, tuned and projections made of future capacity requirements to ensure system performance.",
            "relevance": "Digest and alert jobs can impact capacity; capacity management ensures stability and prevents DoS-like conditions.",
            "integration_tips": "Track queue sizes and throughput; auto-scale workers. Schedule digests to spread load.",
            "priority": "Low",
            "verification_method": "Review capacity dashboards and auto-scaling policies."
          }
        ]
      },
      {
        "high_level_requirement": "Favourites/bookmarking and personalised saved-advert lists with organisation tools",
        "requirement_id": "REQ-8",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.3.1",
            "chapter": "V4 Access Control Verification Requirements",
            "section": "V4.3 Record-Level Access Control",
            "level": "L1",
            "requirement": "Verify that users can only access their own records, such as personal lists, favorites, or bookmarks.",
            "relevance": "Directly addresses access isolation for saved lists and favorites. Prevents cross-user data exposure.",
            "integration_tips": "Enforce user-scoped queries at the data layer and use tenant/user IDs in keys. Add tests for IDOR.",
            "priority": "Critical",
            "verification_method": "Conduct IDOR testing on list endpoints and inspect ORM scoping rules."
          },
          {
            "standard": "NIST",
            "req_id": "AC-16",
            "chapter": "Access Control",
            "section": "Security Attributes",
            "level": null,
            "requirement": "Associate security attributes with information by information systems and enforce attribute-based policies.",
            "relevance": "Using attributes (owner, visibility) supports fine-grained control over lists and sharing options. Enhances policy enforcement.",
            "integration_tips": "Tag list records with owner and visibility attributes and enforce at query time. Log attribute changes.",
            "priority": "High",
            "verification_method": "Review database schema and policy enforcement logic for attribute checks."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.4.1",
            "chapter": "Access Control",
            "section": "Information access restriction",
            "level": null,
            "requirement": "Access to information and application system functions shall be restricted in accordance with the access control policy.",
            "relevance": "Requires restricting list data and associated functions to authorized users only. Supports defined access policy.",
            "integration_tips": "Map list operations to policy rules; implement deny by default. Periodically review permissions.",
            "priority": "Medium",
            "verification_method": "Policy review and functional testing of access restrictions."
          },
          {
            "standard": "OWASP",
            "req_id": "V9.3.1",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.3 Data in Storage",
            "level": "L1",
            "requirement": "Verify that sensitive stored data is protected from unauthorized access and tampering.",
            "relevance": "Protects saved lists and notes from tampering and unauthorized reads, especially if containing personal annotations.",
            "integration_tips": "Use database-level encryption, strict ACLs, and integrity checks. Avoid exposing identifiers sequentially.",
            "priority": "Medium",
            "verification_method": "Review storage encryption and access controls; test for tampering resistance."
          }
        ]
      },
      {
        "high_level_requirement": "Secure in-app messaging between users with optional verified contact reveal",
        "requirement_id": "REQ-9",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V9.2.1",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.2 Data in Transit",
            "level": "L1",
            "requirement": "Verify that all sensitive communications are encrypted in transit using secure protocols.",
            "relevance": "In-app messaging contains sensitive content and must be protected in transit. Prevents eavesdropping and tampering.",
            "integration_tips": "Enforce TLS 1.2+ for APIs and websockets; use HSTS. Validate certificates and pin where appropriate.",
            "priority": "Critical",
            "verification_method": "TLS configuration scan and packet inspection to confirm encryption."
          },
          {
            "standard": "NIST",
            "req_id": "SC-13",
            "chapter": "System and Communications Protection",
            "section": "Cryptographic Protection",
            "level": null,
            "requirement": "Employ cryptographic mechanisms to prevent unauthorized disclosure of information and detect changes to information during transmission.",
            "relevance": "Mandates robust cryptographic protections for messaging channels. Supports integrity and confidentiality of messages.",
            "integration_tips": "Use authenticated encryption ciphersuites; consider message signing if end-to-end requirements exist.",
            "priority": "High",
            "verification_method": "Review cipher suites and test integrity verification on message transport."
          },
          {
            "standard": "OWASP",
            "req_id": "V2.8.1",
            "chapter": "V2 Authentication Verification Requirements",
            "section": "V2.8 Re-authentication, Step-up, and MFA",
            "level": "L2",
            "requirement": "Verify that re-authentication or step-up authentication is required before performing sensitive actions such as revealing personal contact details.",
            "relevance": "Optional contact reveal is a sensitive action that should require step-up checks. Reduces risk of unauthorized exposure.",
            "integration_tips": "Prompt for password/MFA re-check before revealing contact info. Use short-lived tokens to authorize the reveal action.",
            "priority": "High",
            "verification_method": "Functional test of step-up flow and token expiry behavior."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.13.2.3",
            "chapter": "Communications security",
            "section": "Electronic messaging",
            "level": null,
            "requirement": "Information involved in electronic messaging shall be appropriately protected.",
            "relevance": "Establishes organizational requirements to safeguard messaging data at rest and in transit. Covers policies and controls.",
            "integration_tips": "Define retention limits, enable encryption at rest for message stores, and restrict admin access to message content.",
            "priority": "Medium",
            "verification_method": "Policy review and storage configuration checks; access audit for admin views."
          }
        ]
      },
      {
        "high_level_requirement": "Interactive map with clustering and approximate location display",
        "requirement_id": "REQ-10",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V1.4.1",
            "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
            "section": "V1.4 Privacy by Design",
            "level": "L1",
            "requirement": "Verify that privacy requirements such as data minimization and anonymization are addressed in the design.",
            "relevance": "Approximate location display should anonymize user locations. Ensures privacy considerations are built into map features.",
            "integration_tips": "Use aggregation/clustering thresholds and snap points to grids to avoid pinpointing exact addresses. Avoid storing raw coordinates in the client.",
            "priority": "High",
            "verification_method": "Design review and UI tests to confirm only approximate positions are shown."
          },
          {
            "standard": "OWASP",
            "req_id": "V5.3.1",
            "chapter": "V5 Validation, Sanitization and Encoding",
            "section": "V5.3 Output Encoding",
            "level": "L1",
            "requirement": "Verify that data rendered in the UI, including maps and visualizations, is properly encoded to prevent injection.",
            "relevance": "Map popups and labels may render user-supplied data; encoding prevents XSS in map visualizations.",
            "integration_tips": "Sanitize and encode all map label fields and disable HTML where possible. Use safe templating APIs.",
            "priority": "High",
            "verification_method": "Dynamic application security testing for XSS in map components."
          },
          {
            "standard": "NIST",
            "req_id": "SC-7",
            "chapter": "System and Communications Protection",
            "section": "Boundary Protection",
            "level": null,
            "requirement": "Monitor and control communications at the external boundary and key internal boundaries of the system.",
            "relevance": "External map tiles/APIs often cross system boundaries; boundary protection controls access and monitoring.",
            "integration_tips": "Route third-party map calls through controlled egress with allowlists and API keys vaulting. Monitor outbound traffic.",
            "priority": "Medium",
            "verification_method": "Network configuration review and monitoring of egress to mapping services."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.1",
            "chapter": "System acquisition, development and maintenance",
            "section": "Secure development policy",
            "level": null,
            "requirement": "Rules for the development of software and systems shall be established and applied to developments within the organization.",
            "relevance": "Ensures secure coding and review standards apply to map components. Reduces vulnerabilities in interactive UIs.",
            "integration_tips": "Adopt secure coding guidelines for frontend visualization and perform code reviews. Include threat modeling for map features.",
            "priority": "Low",
            "verification_method": "Check SDLC policy adherence and code review records for map modules."
          }
        ]
      },
      {
        "high_level_requirement": "Notifications system for adverts, messages and moderation status",
        "requirement_id": "REQ-11",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V10.4.2",
            "chapter": "V10 Malicious Software and Business Logic",
            "section": "V10.4 Business Logic Security",
            "level": "L2",
            "requirement": "Verify that the application enforces anti-automation controls such as rate limiting for notification-triggering actions.",
            "relevance": "Notifications can be abused for spamming or DoS; rate limiting protects system and users. Critical for user-triggered alerts.",
            "integration_tips": "Throttle per user and per recipient address; implement CAPTCHA/anti-automation on high-risk endpoints.",
            "priority": "High",
            "verification_method": "Review rate limiting middleware configuration and attempt burst notification generation."
          },
          {
            "standard": "NIST",
            "req_id": "SI-10",
            "chapter": "System and Information Integrity",
            "section": "Information Input Validation",
            "level": null,
            "requirement": "Check the validity of information inputs.",
            "relevance": "Notification content and addresses must be validated to prevent injection or misrouting. Protects integrity of notifications.",
            "integration_tips": "Validate email/phone formats and sanitize message content before enqueue. Reject invalid payloads at API boundary.",
            "priority": "High",
            "verification_method": "Input validation tests and code review of notification payload handling."
          },
          {
            "standard": "OWASP",
            "req_id": "V7.1.2",
            "chapter": "V7 Error Handling and Logging",
            "section": "V7.1 Logging",
            "level": "L2",
            "requirement": "Verify that logging includes sufficient detail to identify the subject, action, object, timestamp, and outcome for security-relevant events.",
            "relevance": "Notification events, especially moderation status changes, need detailed logs for troubleshooting and audits.",
            "integration_tips": "Ensure structured logging of notification sends, failures, and user actions with correlation IDs.",
            "priority": "Medium",
            "verification_method": "Review sample logs for required fields and correlation."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.3",
            "chapter": "Operations security",
            "section": "Administrator and operator logs",
            "level": null,
            "requirement": "Administrator and operator activities shall be logged and the logs protected and regularly reviewed.",
            "relevance": "Admin-triggered notifications (e.g., moderation decisions) must be logged and reviewed. Supports accountability.",
            "integration_tips": "Restrict access to logs, enable integrity protection, and schedule reviews of admin activity related to notifications.",
            "priority": "Low",
            "verification_method": "Access control check on log store and evidence of periodic reviews."
          }
        ]
      },
      {
        "high_level_requirement": "Administrator and moderator dashboard for content, user and role management",
        "requirement_id": "REQ-12",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.1.3",
            "chapter": "V4 Access Control Verification Requirements",
            "section": "V4.1 General Access Control",
            "level": "L2",
            "requirement": "Verify that administrative interfaces are protected with strong authentication and enforced least privilege.",
            "relevance": "Admin and moderator dashboards require stronger protections due to high impact. Enforces least privilege on powerful actions.",
            "integration_tips": "Require MFA for admin accounts, isolate admin UI, and implement fine-grained roles for moderation vs admin tasks.",
            "priority": "Critical",
            "verification_method": "Check admin auth configuration, MFA enforcement, and role matrix."
          },
          {
            "standard": "NIST",
            "req_id": "AC-5",
            "chapter": "Access Control",
            "section": "Separation of Duties",
            "level": null,
            "requirement": "Separate duties of individuals to reduce the risk of malevolent activity without collusion.",
            "relevance": "Separates moderating content from managing roles/users to reduce risk. Prevents concentration of power.",
            "integration_tips": "Create distinct roles and workflows requiring dual control for sensitive changes. Log approvals and changes.",
            "priority": "High",
            "verification_method": "Review role definitions and evidence of dual-control workflows."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.6",
            "chapter": "Access Control",
            "section": "Removal or adjustment of access rights",
            "level": null,
            "requirement": "The access rights of all employees and external party users to information and information processing facilities shall be removed upon termination or adjusted upon change.",
            "relevance": "Ensures timely adjustment of admin/moderator access when roles change. Reduces insider risk.",
            "integration_tips": "Automate deprovisioning and role adjustments through IAM; tie to HR events. Periodic access reviews.",
            "priority": "Medium",
            "verification_method": "Access recertification records and deprovisioning audit trails."
          },
          {
            "standard": "NIST",
            "req_id": "AU-12",
            "chapter": "Audit and Accountability",
            "section": "Audit Generation",
            "level": null,
            "requirement": "Provide audit record generation capability for defined auditable events within the system.",
            "relevance": "Admin dashboards must generate detailed audit records for actions on users and roles. Supports traceability.",
            "integration_tips": "Instrument all admin actions to emit auditable events and centralize logs. Protect logs from tampering.",
            "priority": "High",
            "verification_method": "Audit event catalog review and sampling of admin action logs."
          }
        ]
      },
      {
        "high_level_requirement": "Reporting and abuse-flagging system with dispute handling",
        "requirement_id": "REQ-13",
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "IR-4",
            "chapter": "Incident Response",
            "section": "Incident Handling",
            "level": null,
            "requirement": "Implement an incident handling capability for incidents that includes preparation, detection and analysis, containment, eradication, and recovery.",
            "relevance": "Abuse reports trigger incident handling processes, including analysis and resolution. Establishes lifecycle for disputes.",
            "integration_tips": "Define triage SLAs and playbooks for abuse categories; integrate ticketing with evidence preservation.",
            "priority": "High",
            "verification_method": "Review incident response playbooks and recent abuse case records."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.16.1.5",
            "chapter": "Information security incident management",
            "section": "Response to information security incidents",
            "level": null,
            "requirement": "Information security incidents shall be responded to in accordance with the documented procedures.",
            "relevance": "Requires documented procedures for reacting to abuse/disputes. Ensures consistency and compliance.",
            "integration_tips": "Create procedures covering intake, investigation, user communication, and closure. Train staff and log actions.",
            "priority": "High",
            "verification_method": "Procedure review and training records; audit of closed dispute tickets."
          },
          {
            "standard": "OWASP",
            "req_id": "V7.2.1",
            "chapter": "V7 Error Handling and Logging",
            "section": "V7.2 Log Security",
            "level": "L1",
            "requirement": "Verify that logs are protected from unauthorized access, tampering, and deletion.",
            "relevance": "Abuse reports may be evidence; logs must be protected to maintain integrity for dispute handling.",
            "integration_tips": "Use append-only log storage and restrict administrative access. Enable integrity checks and alerts on modifications.",
            "priority": "Medium",
            "verification_method": "Configuration review of log storage and integrity verification mechanisms."
          },
          {
            "standard": "NIST",
            "req_id": "CM-9",
            "chapter": "Configuration Management",
            "section": "Configuration Management Plan",
            "level": null,
            "requirement": "Develop, document, and implement a configuration management plan for the system that addresses roles, responsibilities, and configuration control.",
            "relevance": "Supports controlled changes to abuse handling workflows and tools, minimizing errors during disputes.",
            "integration_tips": "Document roles and change approval for moderation/abuse tooling configuration. Track changes in version control.",
            "priority": "Low",
            "verification_method": "Review CM plan and change logs for abuse tooling."
          }
        ]
      },
      {
        "high_level_requirement": "Automated expiry handling and lifecycle enforcement for adverts",
        "requirement_id": "REQ-14",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V9.4.2",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.4 Data Minimization",
            "level": "L2",
            "requirement": "Verify that data retention and disposal for sensitive data is defined, aligned to business need and regulatory requirements.",
            "relevance": "Adverts should expire and be purged/archived per policy to reduce data exposure. Defines lifecycle enforcement.",
            "integration_tips": "Implement retention policies and scheduled jobs to archive or delete expired adverts; document exceptions.",
            "priority": "High",
            "verification_method": "Review retention schedules and job configurations; sample expired records."
          },
          {
            "standard": "NIST",
            "req_id": "AU-11",
            "chapter": "Audit and Accountability",
            "section": "Audit Record Retention",
            "level": null,
            "requirement": "Retain audit records for an organization-defined time period to provide support for after-the-fact investigations.",
            "relevance": "While adverts expire, related audit records must be retained appropriately for investigations. Balances lifecycle with audit needs.",
            "integration_tips": "Separate advert content lifecycle from audit log retention; configure different retention windows and storage classes.",
            "priority": "Medium",
            "verification_method": "Policy review and storage configuration for differing retention periods."
          },
          {
            "standard": "OWASP",
            "req_id": "V2.7.1",
            "chapter": "V2 Authentication Verification Requirements",
            "section": "V2.7 Session Management",
            "level": "L1",
            "requirement": "Verify that sessions have a defined idle timeout and absolute timeout aligned to the business risk.",
            "relevance": "Though session-focused, timeouts exemplify lifecycle enforcement of time-bound entities. Supports consistent expiry handling patterns.",
            "integration_tips": "Adopt similar scheduled expiration patterns for adverts as sessions: absolute end-of-life and grace periods.",
            "priority": "Low",
            "verification_method": "Check timeout settings and compare with advert expiry jobs for consistency."
          }
        ]
      },
      {
        "high_level_requirement": "Paid-tier features: priority listing, branding, analytics, subscription and one-off payments",
        "requirement_id": "REQ-15",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.2.3",
            "chapter": "V4 Access Control Verification Requirements",
            "section": "V4.2 Operation-Level Access Control",
            "level": "L2",
            "requirement": "Verify that the application enforces authorization checks for each function, especially paid or premium features.",
            "relevance": "Critical to ensure only paying users access premium features like priority listings and branding.",
            "integration_tips": "Gate premium endpoints on subscription status claims and re-check on each call. Include checks in background jobs as well.",
            "priority": "Critical",
            "verification_method": "Attempt to access premium features with non-paid accounts; review authorization middleware."
          },
          {
            "standard": "OWASP",
            "req_id": "V10.4.3",
            "chapter": "V10 Malicious Software and Business Logic",
            "section": "V10.4 Business Logic Security",
            "level": "L2",
            "requirement": "Verify that business logic enforces integrity of transactions and prevents abuse such as privilege escalation or bypass of payment checks.",
            "relevance": "Prevents users from bypassing payment or escalating privileges to gain premium features.",
            "integration_tips": "Implement server-side verification of payment status with PSP, and integrity checks on feature flags. Log anomalies.",
            "priority": "High",
            "verification_method": "Business logic tests simulating tampering with client-side flags and stale receipts."
          },
          {
            "standard": "NIST",
            "req_id": "AU-2",
            "chapter": "Audit and Accountability",
            "section": "Event Logging",
            "level": null,
            "requirement": "Define auditable events and ensure that the information system generates audit records for those events.",
            "relevance": "Paid feature access and changes to subscription states must be auditable for dispute resolution and fraud detection.",
            "integration_tips": "Log subscription activations, cancellations, and premium feature access with user and transaction IDs.",
            "priority": "Medium",
            "verification_method": "Audit event catalog review and sampling of payment-related logs."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.1.1",
            "chapter": "Operations security",
            "section": "Documented operating procedures",
            "level": null,
            "requirement": "Operating procedures shall be documented and made available to all users who need them.",
            "relevance": "Defines procedures for subscription management, refunds, and disputes to reduce errors and fraud.",
            "integration_tips": "Document SOPs for handling subscription changes and one-off payments; train support staff.",
            "priority": "Low",
            "verification_method": "SOP review and training records."
          }
        ]
      },
      {
        "high_level_requirement": "Secure payment gateway integration and payment record management",
        "requirement_id": "REQ-16",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V9.2.2",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.2 Data in Transit",
            "level": "L1",
            "requirement": "Verify that connections to external payment service providers use strong TLS and validate certificates.",
            "relevance": "Protects payment data in transit to PSPs, preventing MITM attacks. Essential for secure gateway integration.",
            "integration_tips": "Enforce TLS 1.2+ with certificate validation and hostname verification; consider certificate pinning for PSP endpoints.",
            "priority": "Critical",
            "verification_method": "TLS scan and connection tests to PSP endpoints; review client configuration."
          },
          {
            "standard": "OWASP",
            "req_id": "V9.3.2",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.3 Data in Storage",
            "level": "L2",
            "requirement": "Verify that payment-related data stored is minimized and protected using strong encryption and key management.",
            "relevance": "Minimizes and protects stored payment records, reducing PCI scope and breach impact.",
            "integration_tips": "Avoid storing PAN; store only tokens and necessary metadata encrypted with strong KMS-managed keys. Restrict access via RBAC.",
            "priority": "High",
            "verification_method": "Data inventory and storage encryption configuration review; access audit."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.15.1.1",
            "chapter": "Supplier relationships",
            "section": "Information security policy for supplier relationships",
            "level": null,
            "requirement": "Information security requirements for mitigating the risks associated with supplier\u2019s access to the organization\u2019s assets shall be agreed with the supplier and documented.",
            "relevance": "Covers contractual and security requirements with payment gateway providers. Ensures third-party compliance.",
            "integration_tips": "Define SLAs, security clauses, breach notification, and data protection requirements with the PSP. Review SOC/PCI reports.",
            "priority": "Medium",
            "verification_method": "Supplier agreement review and third-party assurance evidence."
          },
          {
            "standard": "NIST",
            "req_id": "SA-9",
            "chapter": "System and Services Acquisition",
            "section": "External Information System Services",
            "level": null,
            "requirement": "Require that providers of external information system services comply with organizational information security requirements.",
            "relevance": "Mandates that the PSP meets security requirements, aligning integration with organizational policies.",
            "integration_tips": "Assess PSP security posture and include compliance reporting requirements. Monitor PSP changes impacting security.",
            "priority": "Medium",
            "verification_method": "Third-party risk assessment records and periodic reassessment reports."
          }
        ]
      },
      {
        "high_level_requirement": "Logging, audit trails, and analytics for moderation, payments and admin actions",
        "requirement_id": "REQ-17",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V7.1.3",
            "chapter": "V7 Error Handling and Logging",
            "section": "V7.1 Logging",
            "level": "L1",
            "requirement": "Verify that logs are generated for administrative actions, access control events, and security-relevant events.",
            "relevance": "Directly addresses logging of admin actions, payments, and moderation as security-relevant events.",
            "integration_tips": "Adopt structured logging with unique IDs; centralize logs in a SIEM; ensure clocks are synchronized.",
            "priority": "Critical",
            "verification_method": "Log sampling and SIEM ingestion verification for all target event types."
          },
          {
            "standard": "NIST",
            "req_id": "AU-8",
            "chapter": "Audit and Accountability",
            "section": "Time Stamps",
            "level": null,
            "requirement": "Use internal system clocks to generate time stamps for audit records with sufficient granularity to meet system requirements.",
            "relevance": "Accurate timestamps are vital for correlating events across moderation and payment systems.",
            "integration_tips": "Enable NTP across services and include timezone and precision in logs. Use consistent time formats (e.g., RFC3339).",
            "priority": "High",
            "verification_method": "Check NTP configuration and compare timestamps across services."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.2",
            "chapter": "Operations security",
            "section": "Protection of log information",
            "level": null,
            "requirement": "Logging facilities and log information shall be protected against tampering and unauthorized access.",
            "relevance": "Protects audit trails integrity for high-stakes areas like payments and admin actions.",
            "integration_tips": "Use append-only storage, role-based access to logs, and cryptographic integrity verification.",
            "priority": "High",
            "verification_method": "Inspect log storage controls and integrity check outcomes."
          },
          {
            "standard": "NIST",
            "req_id": "AU-9",
            "chapter": "Audit and Accountability",
            "section": "Protection of Audit Information",
            "level": null,
            "requirement": "Protect audit information and audit tools from unauthorized access, modification, and deletion.",
            "relevance": "Ensures audit data and tooling cannot be tampered with by admins or attackers. Critical for trustworthiness.",
            "integration_tips": "Separate duties for log management; restrict and monitor access to SIEM and log pipelines.",
            "priority": "High",
            "verification_method": "Access review for log tools and attempted unauthorized modification test."
          }
        ]
      },
      {
        "high_level_requirement": "Privacy and data protection controls (GDPR compliance, consent management, data subject requests)",
        "requirement_id": "REQ-18",
        "security_controls": [
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.4",
            "chapter": "Compliance",
            "section": "Privacy and protection of personally identifiable information",
            "level": null,
            "requirement": "Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.",
            "relevance": "Directly mandates GDPR-aligned protections for PII, covering lawful processing and safeguards.",
            "integration_tips": "Map processing activities, implement DPIAs where applicable, and enforce access controls on PII.",
            "priority": "Critical",
            "verification_method": "Review ROPA/DPIA documents and PII access controls."
          },
          {
            "standard": "OWASP",
            "req_id": "V1.4.4",
            "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
            "section": "V1.4 Privacy by Design",
            "level": "L2",
            "requirement": "Verify that consent is obtained, recorded, and can be withdrawn for personal data processing.",
            "relevance": "Covers consent management lifecycle required by GDPR, including withdrawal.",
            "integration_tips": "Implement a consent store with versioning and timestamps; enforce consent checks in data processing flows.",
            "priority": "High",
            "verification_method": "Examine consent records and test withdrawal propagation to processing systems."
          },
          {
            "standard": "NIST",
            "req_id": "AR-8",
            "chapter": "Authority and Purpose (Privacy)",
            "section": "Accounting of Disclosures",
            "level": null,
            "requirement": "Provide an accounting of disclosures of personally identifiable information to individuals upon request.",
            "relevance": "Supports GDPR data subject rights by tracking disclosures for subject access requests.",
            "integration_tips": "Maintain disclosure logs linked to data subjects and expose them via DSAR workflows.",
            "priority": "Medium",
            "verification_method": "Review disclosure log schema and perform a test DSAR."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.1",
            "chapter": "Compliance",
            "section": "Identification of applicable legislation and contractual requirements",
            "level": null,
            "requirement": "All relevant legislative statutory, regulatory and contractual requirements shall be explicitly identified and documented for each information system.",
            "relevance": "Requires identifying GDPR and other legal obligations, forming the basis of privacy control implementation.",
            "integration_tips": "Maintain a compliance register mapping requirements to controls and evidence. Review updates regularly.",
            "priority": "Medium",
            "verification_method": "Audit the compliance register and control mappings."
          }
        ]
      },
      {
        "high_level_requirement": "Security controls: encryption in transit and at rest, RBAC, MFA option, rate limiting and anti-abuse protections",
        "requirement_id": "REQ-19",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V9.1.2",
            "chapter": "V9 Data Protection Verification Requirements",
            "section": "V9.1 Data Classification",
            "level": "L1",
            "requirement": "Verify that all sensitive data is identified and classified, and appropriate protections are applied.",
            "relevance": "Data classification is prerequisite to applying correct encryption at rest/in transit and access controls.",
            "integration_tips": "Create a data classification inventory and map protections (TLS, encryption at rest, access policies) per class.",
            "priority": "Critical",
            "verification_method": "Review data inventory and control mappings to classification levels."
          },
          {
            "standard": "NIST",
            "req_id": "SC-12",
            "chapter": "System and Communications Protection",
            "section": "Cryptographic Key Establishment and Management",
            "level": null,
            "requirement": "Establish and manage cryptographic keys for required cryptography employed within the information system.",
            "relevance": "Proper key management underpins encryption at rest and in transit. Prevents compromise of protected data.",
            "integration_tips": "Use managed KMS/HSM for key lifecycle, rotation, and access controls; enforce separation of duties for key admins.",
            "priority": "High",
            "verification_method": "Key management policy review and evidence of key rotation/audit logs."
          },
          {
            "standard": "OWASP",
            "req_id": "V2.7.5",
            "chapter": "V2 Authentication Verification Requirements",
            "section": "V2.7 Session Management",
            "level": "L2",
            "requirement": "Verify that session management and authentication support multi-factor authentication where appropriate.",
            "relevance": "Satisfies MFA option requirement to harden authentication. Reduces account takeover risk.",
            "integration_tips": "Offer TOTP/WebAuthn MFA and provide recovery mechanisms; enforce MFA for high-privilege roles.",
            "priority": "High",
            "verification_method": "Test MFA enrollment and enforcement; review auth configuration."
          },
          {
            "standard": "NIST",
            "req_id": "SI-10",
            "chapter": "System and Information Integrity",
            "section": "Information Input Validation",
            "level": null,
            "requirement": "Check the validity of information inputs.",
            "relevance": "Input validation is fundamental to anti-abuse; combined with rate limiting prevents injection and resource abuse.",
            "integration_tips": "Apply centralized validation schemas and integrate with rate-limiting middleware at gateway level.",
            "priority": "Medium",
            "verification_method": "Code review of validation and gateway configs; fuzz testing of endpoints."
          }
        ]
      },
      {
        "high_level_requirement": "Accessibility and mobile responsiveness (WCAG conformance target)",
        "requirement_id": "REQ-20",
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V1.3.1",
            "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
            "section": "V1.3 Secure Design",
            "level": "L1",
            "requirement": "Verify that security is addressed in user experience and design, including error messages and user guidance that do not leak sensitive information.",
            "relevance": "While WCAG is accessibility-focused, secure UX ensures accessible error handling without leaking sensitive data.",
            "integration_tips": "Design accessible error states and guidance that are clear yet do not expose internals. Include security considerations in UX reviews.",
            "priority": "Low",
            "verification_method": "UX review of error messages and accessibility testing."
          },
          {
            "standard": "OWASP",
            "req_id": "V7.3.1",
            "chapter": "V7 Error Handling and Logging",
            "section": "V7.3 Error Handling",
            "level": "L1",
            "requirement": "Verify that error messages are handled in a user-friendly manner without revealing sensitive information.",
            "relevance": "Accessible applications need clear errors, but they must not expose sensitive details. This balances both goals.",
            "integration_tips": "Return generic messages to users and detailed errors only in logs. Ensure messages meet accessibility guidelines (e.g., ARIA).",
            "priority": "Low",
            "verification_method": "UI testing for error content and accessibility audits."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.1",
            "chapter": "System acquisition, development and maintenance",
            "section": "Secure development policy",
            "level": null,
            "requirement": "Rules for the development of software and systems shall be established and applied to developments within the organization.",
            "relevance": "Secure development policies should include accessibility considerations to reduce security issues in responsive UIs.",
            "integration_tips": "Incorporate accessibility checks into SDLC and code review policies alongside security checks.",
            "priority": "Low",
            "verification_method": "Policy review and pipeline checks for accessibility/security gates."
          },
          {
            "standard": "NIST",
            "req_id": "RA-5",
            "chapter": "Risk Assessment",
            "section": "Vulnerability Monitoring and Scanning",
            "level": null,
            "requirement": "Scan for vulnerabilities in the information system and hosted applications and address identified vulnerabilities.",
            "relevance": "Responsive frontends may introduce security flaws; ongoing scanning and remediation sustains a secure, accessible experience.",
            "integration_tips": "Run regular dynamic scans against mobile and responsive views and triage findings promptly.",
            "priority": "Low",
            "verification_method": "Scan reports and remediation tracking."
          }
        ]
      }
    ],
    "cross_functional_controls": [
      {
        "control_name": "Transport Layer Security",
        "description": "Encrypt all data in transit using strong TLS and validate certificates.",
        "applies_to": [
          "User registration and login with role assignment and secure authentication",
          "Secure in-app messaging between users with optional verified contact reveal",
          "Secure payment gateway integration and payment record management",
          "Notifications system for adverts, messages and moderation status",
          "Interactive map with clustering and approximate location display"
        ],
        "implementation_guidance": "Enforce TLS 1.2+ with modern ciphers, HSTS, and certificate validation/pinning where appropriate."
      },
      {
        "control_name": "Centralized Authorization (RBAC/ABAC)",
        "description": "Consistent server-side authorization for all protected resources and operations.",
        "applies_to": [
          "User registration and login with role assignment and secure authentication",
          "Email domain verification and tier-based access controls (free vs paid advertisers)",
          "Advert creation, edit, delete lifecycle with support for multi-room properties",
          "Administrator and moderator dashboard for content, user and role management",
          "Paid-tier features: priority listing, branding, analytics, subscription and one-off payments"
        ],
        "implementation_guidance": "Use a policy engine or middleware to enforce per-request checks based on roles/attributes; deny by default."
      },
      {
        "control_name": "Comprehensive Logging and Audit",
        "description": "Generate, protect, and review logs for security-relevant events and administrative activities.",
        "applies_to": [
          "Automated and manual moderation workflow for adverts and content",
          "Notifications system for adverts, messages and moderation status",
          "Administrator and moderator dashboard for content, user and role management",
          "Logging, audit trails, and analytics for moderation, payments and admin actions",
          "Reporting and abuse-flagging system with dispute handling"
        ],
        "implementation_guidance": "Use structured logs with timestamps and correlation IDs; protect logs from tampering and perform regular reviews in a SIEM."
      },
      {
        "control_name": "Input Validation and Output Encoding",
        "description": "Validate all inputs and encode outputs to prevent injection and XSS.",
        "applies_to": [
          "Advert creation, edit, delete lifecycle with support for multi-room properties",
          "Advanced filtering, saveable searches, and alerting (instant and daily digest)",
          "Interactive map with clustering and approximate location display",
          "Notifications system for adverts, messages and moderation status"
        ],
        "implementation_guidance": "Adopt positive validation using schemas and perform contextual output encoding in templates and UI components."
      },
      {
        "control_name": "Privacy by Design and Data Minimization",
        "description": "Minimize collection and exposure of personal and location data and provide user controls.",
        "applies_to": [
          "User profile management with verifiable contact display options",
          "Geo-centric search and filtered discovery with map visualisation (approximate locations)",
          "Interactive map with clustering and approximate location display",
          "Privacy and data protection controls (GDPR compliance, consent management, data subject requests)"
        ],
        "implementation_guidance": "Classify data, limit retention, mask or approximate sensitive fields, and implement consent and data subject rights workflows."
      }
    ],
    "recommended_asvs_level": "L2"
  },
  "tasks": [
    {
      "name": "map_security_controls",
      "raw": "{\n  \"requirements_mapping\": [\n    {\n      \"high_level_requirement\": \"User registration and login with role assignment and secure authentication\",\n      \"requirement_id\": \"REQ-1\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.1.1\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.1 Password Security\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that user registration and login mechanisms require robust authentication, including secure password handling and account lifecycle management.\",\n          \"relevance\": \"Covers secure authentication during registration and login, ensuring robust password practices. Aligns directly with role assignment by enforcing strong authentication before authorization decisions.\",\n          \"integration_tips\": \"Implement password hashing with a modern algorithm (e.g., Argon2id, bcrypt) and enforce complexity and lockout policies. Ensure account lifecycle includes activation, lock, recovery workflows with secure tokens.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review auth flow design, inspect password storage configuration, and test registration/login including account lifecycle.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.1.1\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.1 General Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that a role-based access control (RBAC) or attribute-based access control (ABAC) scheme is enforced at the application level for all protected resources.\",\n          \"relevance\": \"Addresses role assignment and enforcement across resources, essential for separating user capabilities. Ensures authorization checks are centralized and consistent.\",\n          \"integration_tips\": \"Define roles and permissions in a policy store and enforce checks server-side on every request. Use middleware/filters to guard endpoints and include role claims in access tokens.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Policy review, code inspection of authorization middleware, and role-based access tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-2\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"IA-2\",\n          \"level\": null,\n          \"requirement\": \"Identify and authenticate organizational users (and/or processes acting on behalf of users).\",\n          \"relevance\": \"Ensures all users are uniquely identified and authenticated before accessing the system. Underpins secure login and session establishment.\",\n          \"integration_tips\": \"Use unique user IDs, enforce strong authenticators, and bind sessions/tokens to authenticated identities. Log authentication attempts and outcomes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect identity provider configuration, review auth logs, and perform positive/negative login tests.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.3\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"User access provisioning\",\n          \"level\": null,\n          \"requirement\": \"The provisioning of user access rights shall be formalized, including assignment of access rights to all types of users for all systems and services.\",\n          \"relevance\": \"Formalizes role assignment processes and approvals to prevent excessive privileges. Supports onboarding and changes in user roles.\",\n          \"integration_tips\": \"Implement joiner-mover-leaver workflows with approvals and documented RBAC matrices. Periodically review access rights and automate provisioning via IAM.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review access provisioning SOPs, sampling of access requests, and RBAC review records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Email domain verification and tier-based access controls (free vs paid advertisers)\",\n      \"requirement_id\": \"REQ-2\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.2.3\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.2 Authenticator Lifecycle\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application verifies the ownership of an email address or phone number during registration and prior to activation.\",\n          \"relevance\": \"Directly maps to verifying email ownership before granting access or features. Prevents fake or unverified accounts from accessing tiers.\",\n          \"integration_tips\": \"Send signed, single-use, time-limited verification links and require completion before enabling account. Track verification status and block feature access until verified.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional tests of email verification flow and review of token expiry/one-time use implementation.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2.1\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.2 Operation-Level Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that access controls enforce authorization decisions based on the authenticated user's role or attributes.\",\n          \"relevance\": \"Supports tier-based access by enforcing decisions tied to attributes such as subscription status. Ensures paid features are limited to authorized users.\",\n          \"integration_tips\": \"Model tier as user attributes/claims and enforce checks in controllers/services. Use policy-based authorization to centralize logic.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review authorization policies and test scenarios for free vs paid users.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-2\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Account Management\",\n          \"level\": null,\n          \"requirement\": \"Manage information system accounts, including establishing, activating, modifying, disabling, and removing accounts.\",\n          \"relevance\": \"Provides governance for account status changes tied to subscription lifecycle (e.g., downgrades, suspensions). Ensures only active, verified accounts access tiers.\",\n          \"integration_tips\": \"Automate activation post-verification, suspend on non-payment, and remove access on subscription end. Maintain audit trails for account state changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review account lifecycle automation and audit logs for state transitions.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.1.2\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access to networks and network services\",\n          \"level\": null,\n          \"requirement\": \"Users shall only be provided with access to the network and network services that they have been specifically authorized to use.\",\n          \"relevance\": \"Supports restricting platform services to the appropriate tier. Ensures least privilege across service boundaries.\",\n          \"integration_tips\": \"Segment paid-tier services and enforce service-level authorization checks. Configure API gateways to evaluate tier claims.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review service access configurations and test unauthorized access attempts.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User profile management with verifiable contact display options\",\n      \"requirement_id\": \"REQ-3\",\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and protection of personally identifiable information\",\n          \"level\": null,\n          \"requirement\": \"Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.\",\n          \"relevance\": \"PII in user profiles and contact details must be protected and processed lawfully. Governs how contact info is displayed and shared.\",\n          \"integration_tips\": \"Document lawful bases, implement consent where needed, and restrict display of PII via user-controlled settings. Apply masking by default.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review privacy documentation, data flows, and UI settings for PII exposure.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.3\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application collects and processes only the minimum amount of personal data necessary and provides users control over data sharing.\",\n          \"relevance\": \"Ensures profiles collect minimal data and provide controls for showing/hiding verified contacts. Reduces exposure and supports user choice.\",\n          \"integration_tips\": \"Design profile fields as optional where possible, and include per-field visibility toggles. Avoid storing unnecessary contact data.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Design review and UX testing of privacy controls; data inventory check for minimization.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Least Privilege\",\n          \"level\": null,\n          \"requirement\": \"Employ the principle of least privilege, allowing only authorized access for users (and processes acting on behalf of users) which are necessary to accomplish assigned tasks.\",\n          \"relevance\": \"Restricts who can view or modify profile and contact data. Supports controlled display options and backend enforcement.\",\n          \"integration_tips\": \"Enforce per-user and per-field access checks in APIs. Limit support/admin tools to read-only unless explicitly approved.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Access tests for different roles and review of API authorization rules.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.1.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.1 Data Classification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that the application protects personal data and supports data minimization consistent with privacy requirements.\",\n          \"relevance\": \"Classifies profile contact data as personal and enforces appropriate protections. Aligns with display options and minimization.\",\n          \"integration_tips\": \"Mark contact fields as sensitive and apply encryption and access restrictions. Ensure logs do not expose contact details.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review data classification and storage protections; check logs for PII leakage.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Advert creation, edit, delete lifecycle with support for multi-room properties\",\n      \"requirement_id\": \"REQ-4\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2.2\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.2 Operation-Level Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that users can only create, read, update, or delete resources that they own or are authorized to access.\",\n          \"relevance\": \"Ensures advert CRUD actions are limited to owners or authorized roles. Prevents unauthorized modifications across listings.\",\n          \"integration_tips\": \"Implement ownership checks using resource IDs and subject claims. Enforce at service layer and re-check at data access layer.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Unit/integration tests for owner vs non-owner scenarios; code review of authorization checks.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-3\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access Enforcement\",\n          \"level\": null,\n          \"requirement\": \"Enforce approved authorizations for logical access to information and system resources.\",\n          \"relevance\": \"General enforcement mechanism to apply policy for advert lifecycle operations. Supports multi-room record integrity.\",\n          \"integration_tips\": \"Centralize policy enforcement and ensure database queries include ownership constraints. Use deny-by-default posture.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Policy review and data-layer query inspection for authorization predicates.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.1.3\",\n          \"chapter\": \"V5 Validation, Sanitization and Encoding\",\n          \"section\": \"V5.1 Input Validation\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all inputs are validated using positive validation (allow lists) for expected data types, ranges, and formats.\",\n          \"relevance\": \"Advert fields (e.g., room counts, prices) need strict validation to prevent injection and logic abuse. Supports data integrity.\",\n          \"integration_tips\": \"Use server-side schema validation for all advert inputs and normalize data. Sanitize rich text fields and file uploads.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review validation schemas and fuzz test inputs; check that invalid data is rejected.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Security in development and support processes\",\n          \"level\": null,\n          \"requirement\": \"Security testing shall be carried out during development.\",\n          \"relevance\": \"Ensures advert lifecycle features undergo security testing to catch authorization and validation gaps. Reduces deployment risk.\",\n          \"integration_tips\": \"Include security test cases in CI for CRUD operations and access control. Perform code reviews focusing on ownership checks.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Evidence of CI security tests and review records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Automated and manual moderation workflow for adverts and content\",\n      \"requirement_id\": \"REQ-5\",\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-3\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Content of Audit Records\",\n          \"level\": null,\n          \"requirement\": \"Ensure that audit records contain information that establishes what events occurred, the sources of the events, and the outcomes of the events.\",\n          \"relevance\": \"Moderation actions must be auditable to trace who approved/rejected content and why. Supports accountability in workflows.\",\n          \"integration_tips\": \"Log moderation events with actor ID, object, action, reason, and outcome. Use immutable storage or WORM where feasible.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review audit log fields and sample records for completeness.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.1.1\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.1 Logging\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all security-relevant events are logged, including authentication, authorization decisions, and administrative actions.\",\n          \"relevance\": \"Moderation is an administrative function requiring comprehensive logging. Enables forensic review and dispute resolution.\",\n          \"integration_tips\": \"Instrument moderation services to emit structured logs and centralize them. Protect logs with RBAC and integrity controls.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check logging configuration and attempt to access logs with different roles.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Event logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities, exceptions, faults and information security events shall be produced, kept and regularly reviewed.\",\n          \"relevance\": \"Mandates ongoing review of moderation-related logs to detect issues or abuse. Complements automated and manual workflows.\",\n          \"integration_tips\": \"Establish review schedules and alerts for moderation anomalies (e.g., high rejection rate by a user). Document procedures.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review log review procedures and evidence of periodic reviews.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-6\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Review, Analysis, and Reporting\",\n          \"level\": null,\n          \"requirement\": \"Review and analyze information system audit records for indications of inappropriate or unusual activity and report findings.\",\n          \"relevance\": \"Requires active analysis of moderation logs for abuse or errors. Supports both automated alerts and manual oversight.\",\n          \"integration_tips\": \"Create dashboards for moderation KPIs and anomaly detection. Define escalation paths for suspicious patterns.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect SIEM dashboards and alert configurations for moderation events.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Geo-centric search and filtered discovery with map visualisation (approximate locations)\",\n      \"requirement_id\": \"REQ-6\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.2\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application limits collection and retention of location and other sensitive data to the minimum necessary.\",\n          \"relevance\": \"Approximate locations reduce privacy risks in map visualisation. Control mandates limiting collection/retention of geodata.\",\n          \"integration_tips\": \"Store coarse geohashes instead of exact coordinates and purge old location data per retention policy. Disable location logging by default.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review data model and retention jobs; verify only approximate location is exposed.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.4.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.4 Data Minimization\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that sensitive data such as geolocation is not exposed in logs or through APIs beyond what is necessary for business purposes.\",\n          \"relevance\": \"Prevents leakage of exact locations via logs or APIs during geo search and filters. Aligns to privacy-by-design.\",\n          \"integration_tips\": \"Mask or omit exact lat/long in API responses and redact in logs. Implement schema-level allowlists for fields.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"API response and log sampling to confirm no precise coordinates are present.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-8\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Information Security Architecture\",\n          \"level\": null,\n          \"requirement\": \"Develop an information security architecture for the system that describes the requirements and approach to protect organizational information.\",\n          \"relevance\": \"Ensures geo features are designed with security/privacy controls embedded. Guides architecture for map services and data flows.\",\n          \"integration_tips\": \"Document data flows for geo queries, caching, and third-party maps. Include threat modeling for location privacy.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review security architecture documents and threat models covering geo components.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.5\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Regulation of cryptographic controls\",\n          \"level\": null,\n          \"requirement\": \"Cryptographic controls shall be used in compliance with all relevant agreements, legislation and regulations.\",\n          \"relevance\": \"Map data transfer and storage may require cryptographic protections, especially for location data. Ensures compliant crypto usage.\",\n          \"integration_tips\": \"Use TLS for map APIs and encrypt sensitive caches at rest. Maintain cipher suites in line with policy.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Crypto configuration review and TLS scanning of map endpoints.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Advanced filtering, saveable searches, and alerting (instant and daily digest)\",\n      \"requirement_id\": \"REQ-7\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.4.1\",\n          \"chapter\": \"V10 Malicious Software and Business Logic\",\n          \"section\": \"V10.4 Business Logic Security\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application enforces business logic with appropriate limits and thresholds (e.g., rate limits) to prevent abuse.\",\n          \"relevance\": \"Alerting features can be abused for spam or resource exhaustion; rate limits mitigate abuse. Controls align with business logic enforcement.\",\n          \"integration_tips\": \"Apply per-user and per-destination quotas for alerts and digests. Implement backoff and queue throttling.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review rate limit configurations and simulate high-frequency alert creation.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.4.3\",\n          \"chapter\": \"V5 Validation, Sanitization and Encoding\",\n          \"section\": \"V5.4 Sanitization and Output Encoding\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that untrusted data is properly sanitized and output encoded to prevent injection in notifications and alerts.\",\n          \"relevance\": \"Search filters and results may be reflected in notifications; encoding prevents injection in emails/push messages.\",\n          \"integration_tips\": \"Template notifications with strict encoding and avoid HTML from users. Validate and sanitize saved search names/criteria.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review templates and perform injection tests in alert content.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-4\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information System Monitoring\",\n          \"level\": null,\n          \"requirement\": \"Monitor the information system to detect attacks and indicators of potential attacks.\",\n          \"relevance\": \"Monitoring helps detect alerting abuse or anomalous filter activity. Supports operational security of alert pipelines.\",\n          \"integration_tips\": \"Create alerts for unusual spikes in alert generation or delivery failures. Feed logs into SIEM for correlation.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check monitoring rules and SIEM dashboards for alerting subsystem.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.3\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Capacity management\",\n          \"level\": null,\n          \"requirement\": \"The use of resources shall be monitored, tuned and projections made of future capacity requirements to ensure system performance.\",\n          \"relevance\": \"Digest and alert jobs can impact capacity; capacity management ensures stability and prevents DoS-like conditions.\",\n          \"integration_tips\": \"Track queue sizes and throughput; auto-scale workers. Schedule digests to spread load.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Review capacity dashboards and auto-scaling policies.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Favourites/bookmarking and personalised saved-advert lists with organisation tools\",\n      \"requirement_id\": \"REQ-8\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.3.1\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.3 Record-Level Access Control\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that users can only access their own records, such as personal lists, favorites, or bookmarks.\",\n          \"relevance\": \"Directly addresses access isolation for saved lists and favorites. Prevents cross-user data exposure.\",\n          \"integration_tips\": \"Enforce user-scoped queries at the data layer and use tenant/user IDs in keys. Add tests for IDOR.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Conduct IDOR testing on list endpoints and inspect ORM scoping rules.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-16\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Security Attributes\",\n          \"level\": null,\n          \"requirement\": \"Associate security attributes with information by information systems and enforce attribute-based policies.\",\n          \"relevance\": \"Using attributes (owner, visibility) supports fine-grained control over lists and sharing options. Enhances policy enforcement.\",\n          \"integration_tips\": \"Tag list records with owner and visibility attributes and enforce at query time. Log attribute changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review database schema and policy enforcement logic for attribute checks.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.1\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Information access restriction\",\n          \"level\": null,\n          \"requirement\": \"Access to information and application system functions shall be restricted in accordance with the access control policy.\",\n          \"relevance\": \"Requires restricting list data and associated functions to authorized users only. Supports defined access policy.\",\n          \"integration_tips\": \"Map list operations to policy rules; implement deny by default. Periodically review permissions.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Policy review and functional testing of access restrictions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.3.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.3 Data in Storage\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that sensitive stored data is protected from unauthorized access and tampering.\",\n          \"relevance\": \"Protects saved lists and notes from tampering and unauthorized reads, especially if containing personal annotations.\",\n          \"integration_tips\": \"Use database-level encryption, strict ACLs, and integrity checks. Avoid exposing identifiers sequentially.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review storage encryption and access controls; test for tampering resistance.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Secure in-app messaging between users with optional verified contact reveal\",\n      \"requirement_id\": \"REQ-9\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.2.1\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.2 Data in Transit\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all sensitive communications are encrypted in transit using secure protocols.\",\n          \"relevance\": \"In-app messaging contains sensitive content and must be protected in transit. Prevents eavesdropping and tampering.\",\n          \"integration_tips\": \"Enforce TLS 1.2+ for APIs and websockets; use HSTS. Validate certificates and pin where appropriate.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"TLS configuration scan and packet inspection to confirm encryption.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-13\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Cryptographic Protection\",\n          \"level\": null,\n          \"requirement\": \"Employ cryptographic mechanisms to prevent unauthorized disclosure of information and detect changes to information during transmission.\",\n          \"relevance\": \"Mandates robust cryptographic protections for messaging channels. Supports integrity and confidentiality of messages.\",\n          \"integration_tips\": \"Use authenticated encryption ciphersuites; consider message signing if end-to-end requirements exist.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review cipher suites and test integrity verification on message transport.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.8.1\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.8 Re-authentication, Step-up, and MFA\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that re-authentication or step-up authentication is required before performing sensitive actions such as revealing personal contact details.\",\n          \"relevance\": \"Optional contact reveal is a sensitive action that should require step-up checks. Reduces risk of unauthorized exposure.\",\n          \"integration_tips\": \"Prompt for password/MFA re-check before revealing contact info. Use short-lived tokens to authorize the reveal action.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Functional test of step-up flow and token expiry behavior.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.13.2.3\",\n          \"chapter\": \"Communications security\",\n          \"section\": \"Electronic messaging\",\n          \"level\": null,\n          \"requirement\": \"Information involved in electronic messaging shall be appropriately protected.\",\n          \"relevance\": \"Establishes organizational requirements to safeguard messaging data at rest and in transit. Covers policies and controls.\",\n          \"integration_tips\": \"Define retention limits, enable encryption at rest for message stores, and restrict admin access to message content.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Policy review and storage configuration checks; access audit for admin views.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Interactive map with clustering and approximate location display\",\n      \"requirement_id\": \"REQ-10\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.1\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that privacy requirements such as data minimization and anonymization are addressed in the design.\",\n          \"relevance\": \"Approximate location display should anonymize user locations. Ensures privacy considerations are built into map features.\",\n          \"integration_tips\": \"Use aggregation/clustering thresholds and snap points to grids to avoid pinpointing exact addresses. Avoid storing raw coordinates in the client.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Design review and UI tests to confirm only approximate positions are shown.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.3.1\",\n          \"chapter\": \"V5 Validation, Sanitization and Encoding\",\n          \"section\": \"V5.3 Output Encoding\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that data rendered in the UI, including maps and visualizations, is properly encoded to prevent injection.\",\n          \"relevance\": \"Map popups and labels may render user-supplied data; encoding prevents XSS in map visualizations.\",\n          \"integration_tips\": \"Sanitize and encode all map label fields and disable HTML where possible. Use safe templating APIs.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Dynamic application security testing for XSS in map components.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-7\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Boundary Protection\",\n          \"level\": null,\n          \"requirement\": \"Monitor and control communications at the external boundary and key internal boundaries of the system.\",\n          \"relevance\": \"External map tiles/APIs often cross system boundaries; boundary protection controls access and monitoring.\",\n          \"integration_tips\": \"Route third-party map calls through controlled egress with allowlists and API keys vaulting. Monitor outbound traffic.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Network configuration review and monitoring of egress to mapping services.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.1\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure development policy\",\n          \"level\": null,\n          \"requirement\": \"Rules for the development of software and systems shall be established and applied to developments within the organization.\",\n          \"relevance\": \"Ensures secure coding and review standards apply to map components. Reduces vulnerabilities in interactive UIs.\",\n          \"integration_tips\": \"Adopt secure coding guidelines for frontend visualization and perform code reviews. Include threat modeling for map features.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Check SDLC policy adherence and code review records for map modules.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Notifications system for adverts, messages and moderation status\",\n      \"requirement_id\": \"REQ-11\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.4.2\",\n          \"chapter\": \"V10 Malicious Software and Business Logic\",\n          \"section\": \"V10.4 Business Logic Security\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application enforces anti-automation controls such as rate limiting for notification-triggering actions.\",\n          \"relevance\": \"Notifications can be abused for spamming or DoS; rate limiting protects system and users. Critical for user-triggered alerts.\",\n          \"integration_tips\": \"Throttle per user and per recipient address; implement CAPTCHA/anti-automation on high-risk endpoints.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review rate limiting middleware configuration and attempt burst notification generation.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"Check the validity of information inputs.\",\n          \"relevance\": \"Notification content and addresses must be validated to prevent injection or misrouting. Protects integrity of notifications.\",\n          \"integration_tips\": \"Validate email/phone formats and sanitize message content before enqueue. Reject invalid payloads at API boundary.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Input validation tests and code review of notification payload handling.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.1.2\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.1 Logging\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that logging includes sufficient detail to identify the subject, action, object, timestamp, and outcome for security-relevant events.\",\n          \"relevance\": \"Notification events, especially moderation status changes, need detailed logs for troubleshooting and audits.\",\n          \"integration_tips\": \"Ensure structured logging of notification sends, failures, and user actions with correlation IDs.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review sample logs for required fields and correlation.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.3\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Administrator and operator logs\",\n          \"level\": null,\n          \"requirement\": \"Administrator and operator activities shall be logged and the logs protected and regularly reviewed.\",\n          \"relevance\": \"Admin-triggered notifications (e.g., moderation decisions) must be logged and reviewed. Supports accountability.\",\n          \"integration_tips\": \"Restrict access to logs, enable integrity protection, and schedule reviews of admin activity related to notifications.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Access control check on log store and evidence of periodic reviews.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Administrator and moderator dashboard for content, user and role management\",\n      \"requirement_id\": \"REQ-12\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.1.3\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.1 General Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that administrative interfaces are protected with strong authentication and enforced least privilege.\",\n          \"relevance\": \"Admin and moderator dashboards require stronger protections due to high impact. Enforces least privilege on powerful actions.\",\n          \"integration_tips\": \"Require MFA for admin accounts, isolate admin UI, and implement fine-grained roles for moderation vs admin tasks.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Check admin auth configuration, MFA enforcement, and role matrix.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-5\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"Separate duties of individuals to reduce the risk of malevolent activity without collusion.\",\n          \"relevance\": \"Separates moderating content from managing roles/users to reduce risk. Prevents concentration of power.\",\n          \"integration_tips\": \"Create distinct roles and workflows requiring dual control for sensitive changes. Log approvals and changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review role definitions and evidence of dual-control workflows.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.6\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Removal or adjustment of access rights\",\n          \"level\": null,\n          \"requirement\": \"The access rights of all employees and external party users to information and information processing facilities shall be removed upon termination or adjusted upon change.\",\n          \"relevance\": \"Ensures timely adjustment of admin/moderator access when roles change. Reduces insider risk.\",\n          \"integration_tips\": \"Automate deprovisioning and role adjustments through IAM; tie to HR events. Periodic access reviews.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Access recertification records and deprovisioning audit trails.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-12\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Generation\",\n          \"level\": null,\n          \"requirement\": \"Provide audit record generation capability for defined auditable events within the system.\",\n          \"relevance\": \"Admin dashboards must generate detailed audit records for actions on users and roles. Supports traceability.\",\n          \"integration_tips\": \"Instrument all admin actions to emit auditable events and centralize logs. Protect logs from tampering.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit event catalog review and sampling of admin action logs.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Reporting and abuse-flagging system with dispute handling\",\n      \"requirement_id\": \"REQ-13\",\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IR-4\",\n          \"chapter\": \"Incident Response\",\n          \"section\": \"Incident Handling\",\n          \"level\": null,\n          \"requirement\": \"Implement an incident handling capability for incidents that includes preparation, detection and analysis, containment, eradication, and recovery.\",\n          \"relevance\": \"Abuse reports trigger incident handling processes, including analysis and resolution. Establishes lifecycle for disputes.\",\n          \"integration_tips\": \"Define triage SLAs and playbooks for abuse categories; integrate ticketing with evidence preservation.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review incident response playbooks and recent abuse case records.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.16.1.5\",\n          \"chapter\": \"Information security incident management\",\n          \"section\": \"Response to information security incidents\",\n          \"level\": null,\n          \"requirement\": \"Information security incidents shall be responded to in accordance with the documented procedures.\",\n          \"relevance\": \"Requires documented procedures for reacting to abuse/disputes. Ensures consistency and compliance.\",\n          \"integration_tips\": \"Create procedures covering intake, investigation, user communication, and closure. Train staff and log actions.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Procedure review and training records; audit of closed dispute tickets.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.2.1\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.2 Log Security\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that logs are protected from unauthorized access, tampering, and deletion.\",\n          \"relevance\": \"Abuse reports may be evidence; logs must be protected to maintain integrity for dispute handling.\",\n          \"integration_tips\": \"Use append-only log storage and restrict administrative access. Enable integrity checks and alerts on modifications.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Configuration review of log storage and integrity verification mechanisms.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"CM-9\",\n          \"chapter\": \"Configuration Management\",\n          \"section\": \"Configuration Management Plan\",\n          \"level\": null,\n          \"requirement\": \"Develop, document, and implement a configuration management plan for the system that addresses roles, responsibilities, and configuration control.\",\n          \"relevance\": \"Supports controlled changes to abuse handling workflows and tools, minimizing errors during disputes.\",\n          \"integration_tips\": \"Document roles and change approval for moderation/abuse tooling configuration. Track changes in version control.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Review CM plan and change logs for abuse tooling.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Automated expiry handling and lifecycle enforcement for adverts\",\n      \"requirement_id\": \"REQ-14\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.4.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.4 Data Minimization\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that data retention and disposal for sensitive data is defined, aligned to business need and regulatory requirements.\",\n          \"relevance\": \"Adverts should expire and be purged/archived per policy to reduce data exposure. Defines lifecycle enforcement.\",\n          \"integration_tips\": \"Implement retention policies and scheduled jobs to archive or delete expired adverts; document exceptions.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review retention schedules and job configurations; sample expired records.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-11\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Record Retention\",\n          \"level\": null,\n          \"requirement\": \"Retain audit records for an organization-defined time period to provide support for after-the-fact investigations.\",\n          \"relevance\": \"While adverts expire, related audit records must be retained appropriately for investigations. Balances lifecycle with audit needs.\",\n          \"integration_tips\": \"Separate advert content lifecycle from audit log retention; configure different retention windows and storage classes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Policy review and storage configuration for differing retention periods.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.7.1\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.7 Session Management\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that sessions have a defined idle timeout and absolute timeout aligned to the business risk.\",\n          \"relevance\": \"Though session-focused, timeouts exemplify lifecycle enforcement of time-bound entities. Supports consistent expiry handling patterns.\",\n          \"integration_tips\": \"Adopt similar scheduled expiration patterns for adverts as sessions: absolute end-of-life and grace periods.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Check timeout settings and compare with advert expiry jobs for consistency.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Paid-tier features: priority listing, branding, analytics, subscription and one-off payments\",\n      \"requirement_id\": \"REQ-15\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2.3\",\n          \"chapter\": \"V4 Access Control Verification Requirements\",\n          \"section\": \"V4.2 Operation-Level Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that the application enforces authorization checks for each function, especially paid or premium features.\",\n          \"relevance\": \"Critical to ensure only paying users access premium features like priority listings and branding.\",\n          \"integration_tips\": \"Gate premium endpoints on subscription status claims and re-check on each call. Include checks in background jobs as well.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Attempt to access premium features with non-paid accounts; review authorization middleware.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.4.3\",\n          \"chapter\": \"V10 Malicious Software and Business Logic\",\n          \"section\": \"V10.4 Business Logic Security\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that business logic enforces integrity of transactions and prevents abuse such as privilege escalation or bypass of payment checks.\",\n          \"relevance\": \"Prevents users from bypassing payment or escalating privileges to gain premium features.\",\n          \"integration_tips\": \"Implement server-side verification of payment status with PSP, and integrity checks on feature flags. Log anomalies.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Business logic tests simulating tampering with client-side flags and stale receipts.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Event Logging\",\n          \"level\": null,\n          \"requirement\": \"Define auditable events and ensure that the information system generates audit records for those events.\",\n          \"relevance\": \"Paid feature access and changes to subscription states must be auditable for dispute resolution and fraud detection.\",\n          \"integration_tips\": \"Log subscription activations, cancellations, and premium feature access with user and transaction IDs.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Audit event catalog review and sampling of payment-related logs.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.1\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Documented operating procedures\",\n          \"level\": null,\n          \"requirement\": \"Operating procedures shall be documented and made available to all users who need them.\",\n          \"relevance\": \"Defines procedures for subscription management, refunds, and disputes to reduce errors and fraud.\",\n          \"integration_tips\": \"Document SOPs for handling subscription changes and one-off payments; train support staff.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"SOP review and training records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Secure payment gateway integration and payment record management\",\n      \"requirement_id\": \"REQ-16\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.2.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.2 Data in Transit\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that connections to external payment service providers use strong TLS and validate certificates.\",\n          \"relevance\": \"Protects payment data in transit to PSPs, preventing MITM attacks. Essential for secure gateway integration.\",\n          \"integration_tips\": \"Enforce TLS 1.2+ with certificate validation and hostname verification; consider certificate pinning for PSP endpoints.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"TLS scan and connection tests to PSP endpoints; review client configuration.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.3.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.3 Data in Storage\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that payment-related data stored is minimized and protected using strong encryption and key management.\",\n          \"relevance\": \"Minimizes and protects stored payment records, reducing PCI scope and breach impact.\",\n          \"integration_tips\": \"Avoid storing PAN; store only tokens and necessary metadata encrypted with strong KMS-managed keys. Restrict access via RBAC.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Data inventory and storage encryption configuration review; access audit.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.15.1.1\",\n          \"chapter\": \"Supplier relationships\",\n          \"section\": \"Information security policy for supplier relationships\",\n          \"level\": null,\n          \"requirement\": \"Information security requirements for mitigating the risks associated with supplier\u2019s access to the organization\u2019s assets shall be agreed with the supplier and documented.\",\n          \"relevance\": \"Covers contractual and security requirements with payment gateway providers. Ensures third-party compliance.\",\n          \"integration_tips\": \"Define SLAs, security clauses, breach notification, and data protection requirements with the PSP. Review SOC/PCI reports.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Supplier agreement review and third-party assurance evidence.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SA-9\",\n          \"chapter\": \"System and Services Acquisition\",\n          \"section\": \"External Information System Services\",\n          \"level\": null,\n          \"requirement\": \"Require that providers of external information system services comply with organizational information security requirements.\",\n          \"relevance\": \"Mandates that the PSP meets security requirements, aligning integration with organizational policies.\",\n          \"integration_tips\": \"Assess PSP security posture and include compliance reporting requirements. Monitor PSP changes impacting security.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Third-party risk assessment records and periodic reassessment reports.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Logging, audit trails, and analytics for moderation, payments and admin actions\",\n      \"requirement_id\": \"REQ-17\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.1.3\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.1 Logging\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that logs are generated for administrative actions, access control events, and security-relevant events.\",\n          \"relevance\": \"Directly addresses logging of admin actions, payments, and moderation as security-relevant events.\",\n          \"integration_tips\": \"Adopt structured logging with unique IDs; centralize logs in a SIEM; ensure clocks are synchronized.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Log sampling and SIEM ingestion verification for all target event types.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-8\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Time Stamps\",\n          \"level\": null,\n          \"requirement\": \"Use internal system clocks to generate time stamps for audit records with sufficient granularity to meet system requirements.\",\n          \"relevance\": \"Accurate timestamps are vital for correlating events across moderation and payment systems.\",\n          \"integration_tips\": \"Enable NTP across services and include timezone and precision in logs. Use consistent time formats (e.g., RFC3339).\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check NTP configuration and compare timestamps across services.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.2\",\n          \"chapter\": \"Operations security\",\n          \"section\": \"Protection of log information\",\n          \"level\": null,\n          \"requirement\": \"Logging facilities and log information shall be protected against tampering and unauthorized access.\",\n          \"relevance\": \"Protects audit trails integrity for high-stakes areas like payments and admin actions.\",\n          \"integration_tips\": \"Use append-only storage, role-based access to logs, and cryptographic integrity verification.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect log storage controls and integrity check outcomes.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-9\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Protection of Audit Information\",\n          \"level\": null,\n          \"requirement\": \"Protect audit information and audit tools from unauthorized access, modification, and deletion.\",\n          \"relevance\": \"Ensures audit data and tooling cannot be tampered with by admins or attackers. Critical for trustworthiness.\",\n          \"integration_tips\": \"Separate duties for log management; restrict and monitor access to SIEM and log pipelines.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Access review for log tools and attempted unauthorized modification test.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Privacy and data protection controls (GDPR compliance, consent management, data subject requests)\",\n      \"requirement_id\": \"REQ-18\",\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and protection of personally identifiable information\",\n          \"level\": null,\n          \"requirement\": \"Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.\",\n          \"relevance\": \"Directly mandates GDPR-aligned protections for PII, covering lawful processing and safeguards.\",\n          \"integration_tips\": \"Map processing activities, implement DPIAs where applicable, and enforce access controls on PII.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review ROPA/DPIA documents and PII access controls.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.4.4\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.4 Privacy by Design\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that consent is obtained, recorded, and can be withdrawn for personal data processing.\",\n          \"relevance\": \"Covers consent management lifecycle required by GDPR, including withdrawal.\",\n          \"integration_tips\": \"Implement a consent store with versioning and timestamps; enforce consent checks in data processing flows.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Examine consent records and test withdrawal propagation to processing systems.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AR-8\",\n          \"chapter\": \"Authority and Purpose (Privacy)\",\n          \"section\": \"Accounting of Disclosures\",\n          \"level\": null,\n          \"requirement\": \"Provide an accounting of disclosures of personally identifiable information to individuals upon request.\",\n          \"relevance\": \"Supports GDPR data subject rights by tracking disclosures for subject access requests.\",\n          \"integration_tips\": \"Maintain disclosure logs linked to data subjects and expose them via DSAR workflows.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review disclosure log schema and perform a test DSAR.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.1\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Identification of applicable legislation and contractual requirements\",\n          \"level\": null,\n          \"requirement\": \"All relevant legislative statutory, regulatory and contractual requirements shall be explicitly identified and documented for each information system.\",\n          \"relevance\": \"Requires identifying GDPR and other legal obligations, forming the basis of privacy control implementation.\",\n          \"integration_tips\": \"Maintain a compliance register mapping requirements to controls and evidence. Review updates regularly.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Audit the compliance register and control mappings.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Security controls: encryption in transit and at rest, RBAC, MFA option, rate limiting and anti-abuse protections\",\n      \"requirement_id\": \"REQ-19\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.1.2\",\n          \"chapter\": \"V9 Data Protection Verification Requirements\",\n          \"section\": \"V9.1 Data Classification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that all sensitive data is identified and classified, and appropriate protections are applied.\",\n          \"relevance\": \"Data classification is prerequisite to applying correct encryption at rest/in transit and access controls.\",\n          \"integration_tips\": \"Create a data classification inventory and map protections (TLS, encryption at rest, access policies) per class.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review data inventory and control mappings to classification levels.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-12\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Cryptographic Key Establishment and Management\",\n          \"level\": null,\n          \"requirement\": \"Establish and manage cryptographic keys for required cryptography employed within the information system.\",\n          \"relevance\": \"Proper key management underpins encryption at rest and in transit. Prevents compromise of protected data.\",\n          \"integration_tips\": \"Use managed KMS/HSM for key lifecycle, rotation, and access controls; enforce separation of duties for key admins.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Key management policy review and evidence of key rotation/audit logs.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.7.5\",\n          \"chapter\": \"V2 Authentication Verification Requirements\",\n          \"section\": \"V2.7 Session Management\",\n          \"level\": \"L2\",\n          \"requirement\": \"Verify that session management and authentication support multi-factor authentication where appropriate.\",\n          \"relevance\": \"Satisfies MFA option requirement to harden authentication. Reduces account takeover risk.\",\n          \"integration_tips\": \"Offer TOTP/WebAuthn MFA and provide recovery mechanisms; enforce MFA for high-privilege roles.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Test MFA enrollment and enforcement; review auth configuration.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"System and Information Integrity\",\n          \"section\": \"Information Input Validation\",\n          \"level\": null,\n          \"requirement\": \"Check the validity of information inputs.\",\n          \"relevance\": \"Input validation is fundamental to anti-abuse; combined with rate limiting prevents injection and resource abuse.\",\n          \"integration_tips\": \"Apply centralized validation schemas and integrate with rate-limiting middleware at gateway level.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Code review of validation and gateway configs; fuzz testing of endpoints.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Accessibility and mobile responsiveness (WCAG conformance target)\",\n      \"requirement_id\": \"REQ-20\",\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.3.1\",\n          \"chapter\": \"V1 Architecture, Design and Threat Modeling Requirements\",\n          \"section\": \"V1.3 Secure Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that security is addressed in user experience and design, including error messages and user guidance that do not leak sensitive information.\",\n          \"relevance\": \"While WCAG is accessibility-focused, secure UX ensures accessible error handling without leaking sensitive data.\",\n          \"integration_tips\": \"Design accessible error states and guidance that are clear yet do not expose internals. Include security considerations in UX reviews.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"UX review of error messages and accessibility testing.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V7.3.1\",\n          \"chapter\": \"V7 Error Handling and Logging\",\n          \"section\": \"V7.3 Error Handling\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that error messages are handled in a user-friendly manner without revealing sensitive information.\",\n          \"relevance\": \"Accessible applications need clear errors, but they must not expose sensitive details. This balances both goals.\",\n          \"integration_tips\": \"Return generic messages to users and detailed errors only in logs. Ensure messages meet accessibility guidelines (e.g., ARIA).\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"UI testing for error content and accessibility audits.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.1\",\n          \"chapter\": \"System acquisition, development and maintenance\",\n          \"section\": \"Secure development policy\",\n          \"level\": null,\n          \"requirement\": \"Rules for the development of software and systems shall be established and applied to developments within the organization.\",\n          \"relevance\": \"Secure development policies should include accessibility considerations to reduce security issues in responsive UIs.\",\n          \"integration_tips\": \"Incorporate accessibility checks into SDLC and code review policies alongside security checks.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Policy review and pipeline checks for accessibility/security gates.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"RA-5\",\n          \"chapter\": \"Risk Assessment\",\n          \"section\": \"Vulnerability Monitoring and Scanning\",\n          \"level\": null,\n          \"requirement\": \"Scan for vulnerabilities in the information system and hosted applications and address identified vulnerabilities.\",\n          \"relevance\": \"Responsive frontends may introduce security flaws; ongoing scanning and remediation sustains a secure, accessible experience.\",\n          \"integration_tips\": \"Run regular dynamic scans against mobile and responsive views and triage findings promptly.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Scan reports and remediation tracking.\"\n        }\n      ]\n    }\n  ],\n  \"cross_functional_controls\": [\n    {\n      \"control_name\": \"Transport Layer Security\",\n      \"description\": \"Encrypt all data in transit using strong TLS and validate certificates.\",\n      \"applies_to\": [\n        \"User registration and login with role assignment and secure authentication\",\n        \"Secure in-app messaging between users with optional verified contact reveal\",\n        \"Secure payment gateway integration and payment record management\",\n        \"Notifications system for adverts, messages and moderation status\",\n        \"Interactive map with clustering and approximate location display\"\n      ],\n      \"implementation_guidance\": \"Enforce TLS 1.2+ with modern ciphers, HSTS, and certificate validation/pinning where appropriate.\"\n    },\n    {\n      \"control_name\": \"Centralized Authorization (RBAC/ABAC)\",\n      \"description\": \"Consistent server-side authorization for all protected resources and operations.\",\n      \"applies_to\": [\n        \"User registration and login with role assignment and secure authentication\",\n        \"Email domain verification and tier-based access controls (free vs paid advertisers)\",\n        \"Advert creation, edit, delete lifecycle with support for multi-room properties\",\n        \"Administrator and moderator dashboard for content, user and role management\",\n        \"Paid-tier features: priority listing, branding, analytics, subscription and one-off payments\"\n      ],\n      \"implementation_guidance\": \"Use a policy engine or middleware to enforce per-request checks based on roles/attributes; deny by default.\"\n    },\n    {\n      \"control_name\": \"Comprehensive Logging and Audit\",\n      \"description\": \"Generate, protect, and review logs for security-relevant events and administrative activities.\",\n      \"applies_to\": [\n        \"Automated and manual moderation workflow for adverts and content\",\n        \"Notifications system for adverts, messages and moderation status\",\n        \"Administrator and moderator dashboard for content, user and role management\",\n        \"Logging, audit trails, and analytics for moderation, payments and admin actions\",\n        \"Reporting and abuse-flagging system with dispute handling\"\n      ],\n      \"implementation_guidance\": \"Use structured logs with timestamps and correlation IDs; protect logs from tampering and perform regular reviews in a SIEM.\"\n    },\n    {\n      \"control_name\": \"Input Validation and Output Encoding\",\n      \"description\": \"Validate all inputs and encode outputs to prevent injection and XSS.\",\n      \"applies_to\": [\n        \"Advert creation, edit, delete lifecycle with support for multi-room properties\",\n        \"Advanced filtering, saveable searches, and alerting (instant and daily digest)\",\n        \"Interactive map with clustering and approximate location display\",\n        \"Notifications system for adverts, messages and moderation status\"\n      ],\n      \"implementation_guidance\": \"Adopt positive validation using schemas and perform contextual output encoding in templates and UI components.\"\n    },\n    {\n      \"control_name\": \"Privacy by Design and Data Minimization\",\n      \"description\": \"Minimize collection and exposure of personal and location data and provide user controls.\",\n      \"applies_to\": [\n        \"User profile management with verifiable contact display options\",\n        \"Geo-centric search and filtered discovery with map visualisation (approximate locations)\",\n        \"Interactive map with clustering and approximate location display\",\n        \"Privacy and data protection controls (GDPR compliance, consent management, data subject requests)\"\n      ],\n      \"implementation_guidance\": \"Classify data, limit retention, mask or approximate sensitive fields, and implement consent and data subject rights workflows.\"\n    }\n  ],\n  \"recommended_asvs_level\": \"L2\"\n}",
      "pydantic": {
        "requirements_mapping": [
          {
            "high_level_requirement": "User registration and login with role assignment and secure authentication",
            "requirement_id": "REQ-1",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V2.1.1",
                "chapter": "V2 Authentication Verification Requirements",
                "section": "V2.1 Password Security",
                "level": "L1",
                "requirement": "Verify that user registration and login mechanisms require robust authentication, including secure password handling and account lifecycle management.",
                "relevance": "Covers secure authentication during registration and login, ensuring robust password practices. Aligns directly with role assignment by enforcing strong authentication before authorization decisions.",
                "integration_tips": "Implement password hashing with a modern algorithm (e.g., Argon2id, bcrypt) and enforce complexity and lockout policies. Ensure account lifecycle includes activation, lock, recovery workflows with secure tokens.",
                "priority": "Critical",
                "verification_method": "Review auth flow design, inspect password storage configuration, and test registration/login including account lifecycle."
              },
              {
                "standard": "OWASP",
                "req_id": "V4.1.1",
                "chapter": "V4 Access Control Verification Requirements",
                "section": "V4.1 General Access Control",
                "level": "L1",
                "requirement": "Verify that a role-based access control (RBAC) or attribute-based access control (ABAC) scheme is enforced at the application level for all protected resources.",
                "relevance": "Addresses role assignment and enforcement across resources, essential for separating user capabilities. Ensures authorization checks are centralized and consistent.",
                "integration_tips": "Define roles and permissions in a policy store and enforce checks server-side on every request. Use middleware/filters to guard endpoints and include role claims in access tokens.",
                "priority": "Critical",
                "verification_method": "Policy review, code inspection of authorization middleware, and role-based access tests."
              },
              {
                "standard": "NIST",
                "req_id": "IA-2",
                "chapter": "Identification and Authentication",
                "section": "IA-2",
                "level": null,
                "requirement": "Identify and authenticate organizational users (and/or processes acting on behalf of users).",
                "relevance": "Ensures all users are uniquely identified and authenticated before accessing the system. Underpins secure login and session establishment.",
                "integration_tips": "Use unique user IDs, enforce strong authenticators, and bind sessions/tokens to authenticated identities. Log authentication attempts and outcomes.",
                "priority": "Critical",
                "verification_method": "Inspect identity provider configuration, review auth logs, and perform positive/negative login tests."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.3",
                "chapter": "Access Control",
                "section": "User access provisioning",
                "level": null,
                "requirement": "The provisioning of user access rights shall be formalized, including assignment of access rights to all types of users for all systems and services.",
                "relevance": "Formalizes role assignment processes and approvals to prevent excessive privileges. Supports onboarding and changes in user roles.",
                "integration_tips": "Implement joiner-mover-leaver workflows with approvals and documented RBAC matrices. Periodically review access rights and automate provisioning via IAM.",
                "priority": "High",
                "verification_method": "Review access provisioning SOPs, sampling of access requests, and RBAC review records."
              }
            ]
          },
          {
            "high_level_requirement": "Email domain verification and tier-based access controls (free vs paid advertisers)",
            "requirement_id": "REQ-2",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V2.2.3",
                "chapter": "V2 Authentication Verification Requirements",
                "section": "V2.2 Authenticator Lifecycle",
                "level": "L2",
                "requirement": "Verify that the application verifies the ownership of an email address or phone number during registration and prior to activation.",
                "relevance": "Directly maps to verifying email ownership before granting access or features. Prevents fake or unverified accounts from accessing tiers.",
                "integration_tips": "Send signed, single-use, time-limited verification links and require completion before enabling account. Track verification status and block feature access until verified.",
                "priority": "High",
                "verification_method": "Functional tests of email verification flow and review of token expiry/one-time use implementation."
              },
              {
                "standard": "OWASP",
                "req_id": "V4.2.1",
                "chapter": "V4 Access Control Verification Requirements",
                "section": "V4.2 Operation-Level Access Control",
                "level": "L1",
                "requirement": "Verify that access controls enforce authorization decisions based on the authenticated user's role or attributes.",
                "relevance": "Supports tier-based access by enforcing decisions tied to attributes such as subscription status. Ensures paid features are limited to authorized users.",
                "integration_tips": "Model tier as user attributes/claims and enforce checks in controllers/services. Use policy-based authorization to centralize logic.",
                "priority": "Critical",
                "verification_method": "Review authorization policies and test scenarios for free vs paid users."
              },
              {
                "standard": "NIST",
                "req_id": "AC-2",
                "chapter": "Access Control",
                "section": "Account Management",
                "level": null,
                "requirement": "Manage information system accounts, including establishing, activating, modifying, disabling, and removing accounts.",
                "relevance": "Provides governance for account status changes tied to subscription lifecycle (e.g., downgrades, suspensions). Ensures only active, verified accounts access tiers.",
                "integration_tips": "Automate activation post-verification, suspend on non-payment, and remove access on subscription end. Maintain audit trails for account state changes.",
                "priority": "High",
                "verification_method": "Review account lifecycle automation and audit logs for state transitions."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.1.2",
                "chapter": "Access Control",
                "section": "Access to networks and network services",
                "level": null,
                "requirement": "Users shall only be provided with access to the network and network services that they have been specifically authorized to use.",
                "relevance": "Supports restricting platform services to the appropriate tier. Ensures least privilege across service boundaries.",
                "integration_tips": "Segment paid-tier services and enforce service-level authorization checks. Configure API gateways to evaluate tier claims.",
                "priority": "Medium",
                "verification_method": "Review service access configurations and test unauthorized access attempts."
              }
            ]
          },
          {
            "high_level_requirement": "User profile management with verifiable contact display options",
            "requirement_id": "REQ-3",
            "security_controls": [
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.4",
                "chapter": "Compliance",
                "section": "Privacy and protection of personally identifiable information",
                "level": null,
                "requirement": "Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.",
                "relevance": "PII in user profiles and contact details must be protected and processed lawfully. Governs how contact info is displayed and shared.",
                "integration_tips": "Document lawful bases, implement consent where needed, and restrict display of PII via user-controlled settings. Apply masking by default.",
                "priority": "Critical",
                "verification_method": "Review privacy documentation, data flows, and UI settings for PII exposure."
              },
              {
                "standard": "OWASP",
                "req_id": "V1.4.3",
                "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
                "section": "V1.4 Privacy by Design",
                "level": "L2",
                "requirement": "Verify that the application collects and processes only the minimum amount of personal data necessary and provides users control over data sharing.",
                "relevance": "Ensures profiles collect minimal data and provide controls for showing/hiding verified contacts. Reduces exposure and supports user choice.",
                "integration_tips": "Design profile fields as optional where possible, and include per-field visibility toggles. Avoid storing unnecessary contact data.",
                "priority": "High",
                "verification_method": "Design review and UX testing of privacy controls; data inventory check for minimization."
              },
              {
                "standard": "NIST",
                "req_id": "AC-6",
                "chapter": "Access Control",
                "section": "Least Privilege",
                "level": null,
                "requirement": "Employ the principle of least privilege, allowing only authorized access for users (and processes acting on behalf of users) which are necessary to accomplish assigned tasks.",
                "relevance": "Restricts who can view or modify profile and contact data. Supports controlled display options and backend enforcement.",
                "integration_tips": "Enforce per-user and per-field access checks in APIs. Limit support/admin tools to read-only unless explicitly approved.",
                "priority": "High",
                "verification_method": "Access tests for different roles and review of API authorization rules."
              },
              {
                "standard": "OWASP",
                "req_id": "V9.1.1",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.1 Data Classification",
                "level": "L1",
                "requirement": "Verify that the application protects personal data and supports data minimization consistent with privacy requirements.",
                "relevance": "Classifies profile contact data as personal and enforces appropriate protections. Aligns with display options and minimization.",
                "integration_tips": "Mark contact fields as sensitive and apply encryption and access restrictions. Ensure logs do not expose contact details.",
                "priority": "High",
                "verification_method": "Review data classification and storage protections; check logs for PII leakage."
              }
            ]
          },
          {
            "high_level_requirement": "Advert creation, edit, delete lifecycle with support for multi-room properties",
            "requirement_id": "REQ-4",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.2.2",
                "chapter": "V4 Access Control Verification Requirements",
                "section": "V4.2 Operation-Level Access Control",
                "level": "L1",
                "requirement": "Verify that users can only create, read, update, or delete resources that they own or are authorized to access.",
                "relevance": "Ensures advert CRUD actions are limited to owners or authorized roles. Prevents unauthorized modifications across listings.",
                "integration_tips": "Implement ownership checks using resource IDs and subject claims. Enforce at service layer and re-check at data access layer.",
                "priority": "Critical",
                "verification_method": "Unit/integration tests for owner vs non-owner scenarios; code review of authorization checks."
              },
              {
                "standard": "NIST",
                "req_id": "AC-3",
                "chapter": "Access Control",
                "section": "Access Enforcement",
                "level": null,
                "requirement": "Enforce approved authorizations for logical access to information and system resources.",
                "relevance": "General enforcement mechanism to apply policy for advert lifecycle operations. Supports multi-room record integrity.",
                "integration_tips": "Centralize policy enforcement and ensure database queries include ownership constraints. Use deny-by-default posture.",
                "priority": "High",
                "verification_method": "Policy review and data-layer query inspection for authorization predicates."
              },
              {
                "standard": "OWASP",
                "req_id": "V5.1.3",
                "chapter": "V5 Validation, Sanitization and Encoding",
                "section": "V5.1 Input Validation",
                "level": "L1",
                "requirement": "Verify that all inputs are validated using positive validation (allow lists) for expected data types, ranges, and formats.",
                "relevance": "Advert fields (e.g., room counts, prices) need strict validation to prevent injection and logic abuse. Supports data integrity.",
                "integration_tips": "Use server-side schema validation for all advert inputs and normalize data. Sanitize rich text fields and file uploads.",
                "priority": "High",
                "verification_method": "Review validation schemas and fuzz test inputs; check that invalid data is rejected."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.5",
                "chapter": "System acquisition, development and maintenance",
                "section": "Security in development and support processes",
                "level": null,
                "requirement": "Security testing shall be carried out during development.",
                "relevance": "Ensures advert lifecycle features undergo security testing to catch authorization and validation gaps. Reduces deployment risk.",
                "integration_tips": "Include security test cases in CI for CRUD operations and access control. Perform code reviews focusing on ownership checks.",
                "priority": "Medium",
                "verification_method": "Evidence of CI security tests and review records."
              }
            ]
          },
          {
            "high_level_requirement": "Automated and manual moderation workflow for adverts and content",
            "requirement_id": "REQ-5",
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AU-3",
                "chapter": "Audit and Accountability",
                "section": "Content of Audit Records",
                "level": null,
                "requirement": "Ensure that audit records contain information that establishes what events occurred, the sources of the events, and the outcomes of the events.",
                "relevance": "Moderation actions must be auditable to trace who approved/rejected content and why. Supports accountability in workflows.",
                "integration_tips": "Log moderation events with actor ID, object, action, reason, and outcome. Use immutable storage or WORM where feasible.",
                "priority": "High",
                "verification_method": "Review audit log fields and sample records for completeness."
              },
              {
                "standard": "OWASP",
                "req_id": "V7.1.1",
                "chapter": "V7 Error Handling and Logging",
                "section": "V7.1 Logging",
                "level": "L1",
                "requirement": "Verify that all security-relevant events are logged, including authentication, authorization decisions, and administrative actions.",
                "relevance": "Moderation is an administrative function requiring comprehensive logging. Enables forensic review and dispute resolution.",
                "integration_tips": "Instrument moderation services to emit structured logs and centralize them. Protect logs with RBAC and integrity controls.",
                "priority": "High",
                "verification_method": "Check logging configuration and attempt to access logs with different roles."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.1",
                "chapter": "Operations security",
                "section": "Event logging",
                "level": null,
                "requirement": "Event logs recording user activities, exceptions, faults and information security events shall be produced, kept and regularly reviewed.",
                "relevance": "Mandates ongoing review of moderation-related logs to detect issues or abuse. Complements automated and manual workflows.",
                "integration_tips": "Establish review schedules and alerts for moderation anomalies (e.g., high rejection rate by a user). Document procedures.",
                "priority": "Medium",
                "verification_method": "Review log review procedures and evidence of periodic reviews."
              },
              {
                "standard": "NIST",
                "req_id": "AU-6",
                "chapter": "Audit and Accountability",
                "section": "Audit Review, Analysis, and Reporting",
                "level": null,
                "requirement": "Review and analyze information system audit records for indications of inappropriate or unusual activity and report findings.",
                "relevance": "Requires active analysis of moderation logs for abuse or errors. Supports both automated alerts and manual oversight.",
                "integration_tips": "Create dashboards for moderation KPIs and anomaly detection. Define escalation paths for suspicious patterns.",
                "priority": "Medium",
                "verification_method": "Inspect SIEM dashboards and alert configurations for moderation events."
              }
            ]
          },
          {
            "high_level_requirement": "Geo-centric search and filtered discovery with map visualisation (approximate locations)",
            "requirement_id": "REQ-6",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V1.4.2",
                "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
                "section": "V1.4 Privacy by Design",
                "level": "L2",
                "requirement": "Verify that the application limits collection and retention of location and other sensitive data to the minimum necessary.",
                "relevance": "Approximate locations reduce privacy risks in map visualisation. Control mandates limiting collection/retention of geodata.",
                "integration_tips": "Store coarse geohashes instead of exact coordinates and purge old location data per retention policy. Disable location logging by default.",
                "priority": "High",
                "verification_method": "Review data model and retention jobs; verify only approximate location is exposed."
              },
              {
                "standard": "OWASP",
                "req_id": "V9.4.1",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.4 Data Minimization",
                "level": "L1",
                "requirement": "Verify that sensitive data such as geolocation is not exposed in logs or through APIs beyond what is necessary for business purposes.",
                "relevance": "Prevents leakage of exact locations via logs or APIs during geo search and filters. Aligns to privacy-by-design.",
                "integration_tips": "Mask or omit exact lat/long in API responses and redact in logs. Implement schema-level allowlists for fields.",
                "priority": "High",
                "verification_method": "API response and log sampling to confirm no precise coordinates are present."
              },
              {
                "standard": "NIST",
                "req_id": "PL-8",
                "chapter": "Planning",
                "section": "Information Security Architecture",
                "level": null,
                "requirement": "Develop an information security architecture for the system that describes the requirements and approach to protect organizational information.",
                "relevance": "Ensures geo features are designed with security/privacy controls embedded. Guides architecture for map services and data flows.",
                "integration_tips": "Document data flows for geo queries, caching, and third-party maps. Include threat modeling for location privacy.",
                "priority": "Medium",
                "verification_method": "Review security architecture documents and threat models covering geo components."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.5",
                "chapter": "Compliance",
                "section": "Regulation of cryptographic controls",
                "level": null,
                "requirement": "Cryptographic controls shall be used in compliance with all relevant agreements, legislation and regulations.",
                "relevance": "Map data transfer and storage may require cryptographic protections, especially for location data. Ensures compliant crypto usage.",
                "integration_tips": "Use TLS for map APIs and encrypt sensitive caches at rest. Maintain cipher suites in line with policy.",
                "priority": "Medium",
                "verification_method": "Crypto configuration review and TLS scanning of map endpoints."
              }
            ]
          },
          {
            "high_level_requirement": "Advanced filtering, saveable searches, and alerting (instant and daily digest)",
            "requirement_id": "REQ-7",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V10.4.1",
                "chapter": "V10 Malicious Software and Business Logic",
                "section": "V10.4 Business Logic Security",
                "level": "L2",
                "requirement": "Verify that the application enforces business logic with appropriate limits and thresholds (e.g., rate limits) to prevent abuse.",
                "relevance": "Alerting features can be abused for spam or resource exhaustion; rate limits mitigate abuse. Controls align with business logic enforcement.",
                "integration_tips": "Apply per-user and per-destination quotas for alerts and digests. Implement backoff and queue throttling.",
                "priority": "High",
                "verification_method": "Review rate limit configurations and simulate high-frequency alert creation."
              },
              {
                "standard": "OWASP",
                "req_id": "V5.4.3",
                "chapter": "V5 Validation, Sanitization and Encoding",
                "section": "V5.4 Sanitization and Output Encoding",
                "level": "L1",
                "requirement": "Verify that untrusted data is properly sanitized and output encoded to prevent injection in notifications and alerts.",
                "relevance": "Search filters and results may be reflected in notifications; encoding prevents injection in emails/push messages.",
                "integration_tips": "Template notifications with strict encoding and avoid HTML from users. Validate and sanitize saved search names/criteria.",
                "priority": "High",
                "verification_method": "Review templates and perform injection tests in alert content."
              },
              {
                "standard": "NIST",
                "req_id": "SI-4",
                "chapter": "System and Information Integrity",
                "section": "Information System Monitoring",
                "level": null,
                "requirement": "Monitor the information system to detect attacks and indicators of potential attacks.",
                "relevance": "Monitoring helps detect alerting abuse or anomalous filter activity. Supports operational security of alert pipelines.",
                "integration_tips": "Create alerts for unusual spikes in alert generation or delivery failures. Feed logs into SIEM for correlation.",
                "priority": "Medium",
                "verification_method": "Check monitoring rules and SIEM dashboards for alerting subsystem."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.1.3",
                "chapter": "Operations security",
                "section": "Capacity management",
                "level": null,
                "requirement": "The use of resources shall be monitored, tuned and projections made of future capacity requirements to ensure system performance.",
                "relevance": "Digest and alert jobs can impact capacity; capacity management ensures stability and prevents DoS-like conditions.",
                "integration_tips": "Track queue sizes and throughput; auto-scale workers. Schedule digests to spread load.",
                "priority": "Low",
                "verification_method": "Review capacity dashboards and auto-scaling policies."
              }
            ]
          },
          {
            "high_level_requirement": "Favourites/bookmarking and personalised saved-advert lists with organisation tools",
            "requirement_id": "REQ-8",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.3.1",
                "chapter": "V4 Access Control Verification Requirements",
                "section": "V4.3 Record-Level Access Control",
                "level": "L1",
                "requirement": "Verify that users can only access their own records, such as personal lists, favorites, or bookmarks.",
                "relevance": "Directly addresses access isolation for saved lists and favorites. Prevents cross-user data exposure.",
                "integration_tips": "Enforce user-scoped queries at the data layer and use tenant/user IDs in keys. Add tests for IDOR.",
                "priority": "Critical",
                "verification_method": "Conduct IDOR testing on list endpoints and inspect ORM scoping rules."
              },
              {
                "standard": "NIST",
                "req_id": "AC-16",
                "chapter": "Access Control",
                "section": "Security Attributes",
                "level": null,
                "requirement": "Associate security attributes with information by information systems and enforce attribute-based policies.",
                "relevance": "Using attributes (owner, visibility) supports fine-grained control over lists and sharing options. Enhances policy enforcement.",
                "integration_tips": "Tag list records with owner and visibility attributes and enforce at query time. Log attribute changes.",
                "priority": "High",
                "verification_method": "Review database schema and policy enforcement logic for attribute checks."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.4.1",
                "chapter": "Access Control",
                "section": "Information access restriction",
                "level": null,
                "requirement": "Access to information and application system functions shall be restricted in accordance with the access control policy.",
                "relevance": "Requires restricting list data and associated functions to authorized users only. Supports defined access policy.",
                "integration_tips": "Map list operations to policy rules; implement deny by default. Periodically review permissions.",
                "priority": "Medium",
                "verification_method": "Policy review and functional testing of access restrictions."
              },
              {
                "standard": "OWASP",
                "req_id": "V9.3.1",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.3 Data in Storage",
                "level": "L1",
                "requirement": "Verify that sensitive stored data is protected from unauthorized access and tampering.",
                "relevance": "Protects saved lists and notes from tampering and unauthorized reads, especially if containing personal annotations.",
                "integration_tips": "Use database-level encryption, strict ACLs, and integrity checks. Avoid exposing identifiers sequentially.",
                "priority": "Medium",
                "verification_method": "Review storage encryption and access controls; test for tampering resistance."
              }
            ]
          },
          {
            "high_level_requirement": "Secure in-app messaging between users with optional verified contact reveal",
            "requirement_id": "REQ-9",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V9.2.1",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.2 Data in Transit",
                "level": "L1",
                "requirement": "Verify that all sensitive communications are encrypted in transit using secure protocols.",
                "relevance": "In-app messaging contains sensitive content and must be protected in transit. Prevents eavesdropping and tampering.",
                "integration_tips": "Enforce TLS 1.2+ for APIs and websockets; use HSTS. Validate certificates and pin where appropriate.",
                "priority": "Critical",
                "verification_method": "TLS configuration scan and packet inspection to confirm encryption."
              },
              {
                "standard": "NIST",
                "req_id": "SC-13",
                "chapter": "System and Communications Protection",
                "section": "Cryptographic Protection",
                "level": null,
                "requirement": "Employ cryptographic mechanisms to prevent unauthorized disclosure of information and detect changes to information during transmission.",
                "relevance": "Mandates robust cryptographic protections for messaging channels. Supports integrity and confidentiality of messages.",
                "integration_tips": "Use authenticated encryption ciphersuites; consider message signing if end-to-end requirements exist.",
                "priority": "High",
                "verification_method": "Review cipher suites and test integrity verification on message transport."
              },
              {
                "standard": "OWASP",
                "req_id": "V2.8.1",
                "chapter": "V2 Authentication Verification Requirements",
                "section": "V2.8 Re-authentication, Step-up, and MFA",
                "level": "L2",
                "requirement": "Verify that re-authentication or step-up authentication is required before performing sensitive actions such as revealing personal contact details.",
                "relevance": "Optional contact reveal is a sensitive action that should require step-up checks. Reduces risk of unauthorized exposure.",
                "integration_tips": "Prompt for password/MFA re-check before revealing contact info. Use short-lived tokens to authorize the reveal action.",
                "priority": "High",
                "verification_method": "Functional test of step-up flow and token expiry behavior."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.13.2.3",
                "chapter": "Communications security",
                "section": "Electronic messaging",
                "level": null,
                "requirement": "Information involved in electronic messaging shall be appropriately protected.",
                "relevance": "Establishes organizational requirements to safeguard messaging data at rest and in transit. Covers policies and controls.",
                "integration_tips": "Define retention limits, enable encryption at rest for message stores, and restrict admin access to message content.",
                "priority": "Medium",
                "verification_method": "Policy review and storage configuration checks; access audit for admin views."
              }
            ]
          },
          {
            "high_level_requirement": "Interactive map with clustering and approximate location display",
            "requirement_id": "REQ-10",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V1.4.1",
                "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
                "section": "V1.4 Privacy by Design",
                "level": "L1",
                "requirement": "Verify that privacy requirements such as data minimization and anonymization are addressed in the design.",
                "relevance": "Approximate location display should anonymize user locations. Ensures privacy considerations are built into map features.",
                "integration_tips": "Use aggregation/clustering thresholds and snap points to grids to avoid pinpointing exact addresses. Avoid storing raw coordinates in the client.",
                "priority": "High",
                "verification_method": "Design review and UI tests to confirm only approximate positions are shown."
              },
              {
                "standard": "OWASP",
                "req_id": "V5.3.1",
                "chapter": "V5 Validation, Sanitization and Encoding",
                "section": "V5.3 Output Encoding",
                "level": "L1",
                "requirement": "Verify that data rendered in the UI, including maps and visualizations, is properly encoded to prevent injection.",
                "relevance": "Map popups and labels may render user-supplied data; encoding prevents XSS in map visualizations.",
                "integration_tips": "Sanitize and encode all map label fields and disable HTML where possible. Use safe templating APIs.",
                "priority": "High",
                "verification_method": "Dynamic application security testing for XSS in map components."
              },
              {
                "standard": "NIST",
                "req_id": "SC-7",
                "chapter": "System and Communications Protection",
                "section": "Boundary Protection",
                "level": null,
                "requirement": "Monitor and control communications at the external boundary and key internal boundaries of the system.",
                "relevance": "External map tiles/APIs often cross system boundaries; boundary protection controls access and monitoring.",
                "integration_tips": "Route third-party map calls through controlled egress with allowlists and API keys vaulting. Monitor outbound traffic.",
                "priority": "Medium",
                "verification_method": "Network configuration review and monitoring of egress to mapping services."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.1",
                "chapter": "System acquisition, development and maintenance",
                "section": "Secure development policy",
                "level": null,
                "requirement": "Rules for the development of software and systems shall be established and applied to developments within the organization.",
                "relevance": "Ensures secure coding and review standards apply to map components. Reduces vulnerabilities in interactive UIs.",
                "integration_tips": "Adopt secure coding guidelines for frontend visualization and perform code reviews. Include threat modeling for map features.",
                "priority": "Low",
                "verification_method": "Check SDLC policy adherence and code review records for map modules."
              }
            ]
          },
          {
            "high_level_requirement": "Notifications system for adverts, messages and moderation status",
            "requirement_id": "REQ-11",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V10.4.2",
                "chapter": "V10 Malicious Software and Business Logic",
                "section": "V10.4 Business Logic Security",
                "level": "L2",
                "requirement": "Verify that the application enforces anti-automation controls such as rate limiting for notification-triggering actions.",
                "relevance": "Notifications can be abused for spamming or DoS; rate limiting protects system and users. Critical for user-triggered alerts.",
                "integration_tips": "Throttle per user and per recipient address; implement CAPTCHA/anti-automation on high-risk endpoints.",
                "priority": "High",
                "verification_method": "Review rate limiting middleware configuration and attempt burst notification generation."
              },
              {
                "standard": "NIST",
                "req_id": "SI-10",
                "chapter": "System and Information Integrity",
                "section": "Information Input Validation",
                "level": null,
                "requirement": "Check the validity of information inputs.",
                "relevance": "Notification content and addresses must be validated to prevent injection or misrouting. Protects integrity of notifications.",
                "integration_tips": "Validate email/phone formats and sanitize message content before enqueue. Reject invalid payloads at API boundary.",
                "priority": "High",
                "verification_method": "Input validation tests and code review of notification payload handling."
              },
              {
                "standard": "OWASP",
                "req_id": "V7.1.2",
                "chapter": "V7 Error Handling and Logging",
                "section": "V7.1 Logging",
                "level": "L2",
                "requirement": "Verify that logging includes sufficient detail to identify the subject, action, object, timestamp, and outcome for security-relevant events.",
                "relevance": "Notification events, especially moderation status changes, need detailed logs for troubleshooting and audits.",
                "integration_tips": "Ensure structured logging of notification sends, failures, and user actions with correlation IDs.",
                "priority": "Medium",
                "verification_method": "Review sample logs for required fields and correlation."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.3",
                "chapter": "Operations security",
                "section": "Administrator and operator logs",
                "level": null,
                "requirement": "Administrator and operator activities shall be logged and the logs protected and regularly reviewed.",
                "relevance": "Admin-triggered notifications (e.g., moderation decisions) must be logged and reviewed. Supports accountability.",
                "integration_tips": "Restrict access to logs, enable integrity protection, and schedule reviews of admin activity related to notifications.",
                "priority": "Low",
                "verification_method": "Access control check on log store and evidence of periodic reviews."
              }
            ]
          },
          {
            "high_level_requirement": "Administrator and moderator dashboard for content, user and role management",
            "requirement_id": "REQ-12",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.1.3",
                "chapter": "V4 Access Control Verification Requirements",
                "section": "V4.1 General Access Control",
                "level": "L2",
                "requirement": "Verify that administrative interfaces are protected with strong authentication and enforced least privilege.",
                "relevance": "Admin and moderator dashboards require stronger protections due to high impact. Enforces least privilege on powerful actions.",
                "integration_tips": "Require MFA for admin accounts, isolate admin UI, and implement fine-grained roles for moderation vs admin tasks.",
                "priority": "Critical",
                "verification_method": "Check admin auth configuration, MFA enforcement, and role matrix."
              },
              {
                "standard": "NIST",
                "req_id": "AC-5",
                "chapter": "Access Control",
                "section": "Separation of Duties",
                "level": null,
                "requirement": "Separate duties of individuals to reduce the risk of malevolent activity without collusion.",
                "relevance": "Separates moderating content from managing roles/users to reduce risk. Prevents concentration of power.",
                "integration_tips": "Create distinct roles and workflows requiring dual control for sensitive changes. Log approvals and changes.",
                "priority": "High",
                "verification_method": "Review role definitions and evidence of dual-control workflows."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.6",
                "chapter": "Access Control",
                "section": "Removal or adjustment of access rights",
                "level": null,
                "requirement": "The access rights of all employees and external party users to information and information processing facilities shall be removed upon termination or adjusted upon change.",
                "relevance": "Ensures timely adjustment of admin/moderator access when roles change. Reduces insider risk.",
                "integration_tips": "Automate deprovisioning and role adjustments through IAM; tie to HR events. Periodic access reviews.",
                "priority": "Medium",
                "verification_method": "Access recertification records and deprovisioning audit trails."
              },
              {
                "standard": "NIST",
                "req_id": "AU-12",
                "chapter": "Audit and Accountability",
                "section": "Audit Generation",
                "level": null,
                "requirement": "Provide audit record generation capability for defined auditable events within the system.",
                "relevance": "Admin dashboards must generate detailed audit records for actions on users and roles. Supports traceability.",
                "integration_tips": "Instrument all admin actions to emit auditable events and centralize logs. Protect logs from tampering.",
                "priority": "High",
                "verification_method": "Audit event catalog review and sampling of admin action logs."
              }
            ]
          },
          {
            "high_level_requirement": "Reporting and abuse-flagging system with dispute handling",
            "requirement_id": "REQ-13",
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "IR-4",
                "chapter": "Incident Response",
                "section": "Incident Handling",
                "level": null,
                "requirement": "Implement an incident handling capability for incidents that includes preparation, detection and analysis, containment, eradication, and recovery.",
                "relevance": "Abuse reports trigger incident handling processes, including analysis and resolution. Establishes lifecycle for disputes.",
                "integration_tips": "Define triage SLAs and playbooks for abuse categories; integrate ticketing with evidence preservation.",
                "priority": "High",
                "verification_method": "Review incident response playbooks and recent abuse case records."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.16.1.5",
                "chapter": "Information security incident management",
                "section": "Response to information security incidents",
                "level": null,
                "requirement": "Information security incidents shall be responded to in accordance with the documented procedures.",
                "relevance": "Requires documented procedures for reacting to abuse/disputes. Ensures consistency and compliance.",
                "integration_tips": "Create procedures covering intake, investigation, user communication, and closure. Train staff and log actions.",
                "priority": "High",
                "verification_method": "Procedure review and training records; audit of closed dispute tickets."
              },
              {
                "standard": "OWASP",
                "req_id": "V7.2.1",
                "chapter": "V7 Error Handling and Logging",
                "section": "V7.2 Log Security",
                "level": "L1",
                "requirement": "Verify that logs are protected from unauthorized access, tampering, and deletion.",
                "relevance": "Abuse reports may be evidence; logs must be protected to maintain integrity for dispute handling.",
                "integration_tips": "Use append-only log storage and restrict administrative access. Enable integrity checks and alerts on modifications.",
                "priority": "Medium",
                "verification_method": "Configuration review of log storage and integrity verification mechanisms."
              },
              {
                "standard": "NIST",
                "req_id": "CM-9",
                "chapter": "Configuration Management",
                "section": "Configuration Management Plan",
                "level": null,
                "requirement": "Develop, document, and implement a configuration management plan for the system that addresses roles, responsibilities, and configuration control.",
                "relevance": "Supports controlled changes to abuse handling workflows and tools, minimizing errors during disputes.",
                "integration_tips": "Document roles and change approval for moderation/abuse tooling configuration. Track changes in version control.",
                "priority": "Low",
                "verification_method": "Review CM plan and change logs for abuse tooling."
              }
            ]
          },
          {
            "high_level_requirement": "Automated expiry handling and lifecycle enforcement for adverts",
            "requirement_id": "REQ-14",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V9.4.2",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.4 Data Minimization",
                "level": "L2",
                "requirement": "Verify that data retention and disposal for sensitive data is defined, aligned to business need and regulatory requirements.",
                "relevance": "Adverts should expire and be purged/archived per policy to reduce data exposure. Defines lifecycle enforcement.",
                "integration_tips": "Implement retention policies and scheduled jobs to archive or delete expired adverts; document exceptions.",
                "priority": "High",
                "verification_method": "Review retention schedules and job configurations; sample expired records."
              },
              {
                "standard": "NIST",
                "req_id": "AU-11",
                "chapter": "Audit and Accountability",
                "section": "Audit Record Retention",
                "level": null,
                "requirement": "Retain audit records for an organization-defined time period to provide support for after-the-fact investigations.",
                "relevance": "While adverts expire, related audit records must be retained appropriately for investigations. Balances lifecycle with audit needs.",
                "integration_tips": "Separate advert content lifecycle from audit log retention; configure different retention windows and storage classes.",
                "priority": "Medium",
                "verification_method": "Policy review and storage configuration for differing retention periods."
              },
              {
                "standard": "OWASP",
                "req_id": "V2.7.1",
                "chapter": "V2 Authentication Verification Requirements",
                "section": "V2.7 Session Management",
                "level": "L1",
                "requirement": "Verify that sessions have a defined idle timeout and absolute timeout aligned to the business risk.",
                "relevance": "Though session-focused, timeouts exemplify lifecycle enforcement of time-bound entities. Supports consistent expiry handling patterns.",
                "integration_tips": "Adopt similar scheduled expiration patterns for adverts as sessions: absolute end-of-life and grace periods.",
                "priority": "Low",
                "verification_method": "Check timeout settings and compare with advert expiry jobs for consistency."
              }
            ]
          },
          {
            "high_level_requirement": "Paid-tier features: priority listing, branding, analytics, subscription and one-off payments",
            "requirement_id": "REQ-15",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.2.3",
                "chapter": "V4 Access Control Verification Requirements",
                "section": "V4.2 Operation-Level Access Control",
                "level": "L2",
                "requirement": "Verify that the application enforces authorization checks for each function, especially paid or premium features.",
                "relevance": "Critical to ensure only paying users access premium features like priority listings and branding.",
                "integration_tips": "Gate premium endpoints on subscription status claims and re-check on each call. Include checks in background jobs as well.",
                "priority": "Critical",
                "verification_method": "Attempt to access premium features with non-paid accounts; review authorization middleware."
              },
              {
                "standard": "OWASP",
                "req_id": "V10.4.3",
                "chapter": "V10 Malicious Software and Business Logic",
                "section": "V10.4 Business Logic Security",
                "level": "L2",
                "requirement": "Verify that business logic enforces integrity of transactions and prevents abuse such as privilege escalation or bypass of payment checks.",
                "relevance": "Prevents users from bypassing payment or escalating privileges to gain premium features.",
                "integration_tips": "Implement server-side verification of payment status with PSP, and integrity checks on feature flags. Log anomalies.",
                "priority": "High",
                "verification_method": "Business logic tests simulating tampering with client-side flags and stale receipts."
              },
              {
                "standard": "NIST",
                "req_id": "AU-2",
                "chapter": "Audit and Accountability",
                "section": "Event Logging",
                "level": null,
                "requirement": "Define auditable events and ensure that the information system generates audit records for those events.",
                "relevance": "Paid feature access and changes to subscription states must be auditable for dispute resolution and fraud detection.",
                "integration_tips": "Log subscription activations, cancellations, and premium feature access with user and transaction IDs.",
                "priority": "Medium",
                "verification_method": "Audit event catalog review and sampling of payment-related logs."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.1.1",
                "chapter": "Operations security",
                "section": "Documented operating procedures",
                "level": null,
                "requirement": "Operating procedures shall be documented and made available to all users who need them.",
                "relevance": "Defines procedures for subscription management, refunds, and disputes to reduce errors and fraud.",
                "integration_tips": "Document SOPs for handling subscription changes and one-off payments; train support staff.",
                "priority": "Low",
                "verification_method": "SOP review and training records."
              }
            ]
          },
          {
            "high_level_requirement": "Secure payment gateway integration and payment record management",
            "requirement_id": "REQ-16",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V9.2.2",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.2 Data in Transit",
                "level": "L1",
                "requirement": "Verify that connections to external payment service providers use strong TLS and validate certificates.",
                "relevance": "Protects payment data in transit to PSPs, preventing MITM attacks. Essential for secure gateway integration.",
                "integration_tips": "Enforce TLS 1.2+ with certificate validation and hostname verification; consider certificate pinning for PSP endpoints.",
                "priority": "Critical",
                "verification_method": "TLS scan and connection tests to PSP endpoints; review client configuration."
              },
              {
                "standard": "OWASP",
                "req_id": "V9.3.2",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.3 Data in Storage",
                "level": "L2",
                "requirement": "Verify that payment-related data stored is minimized and protected using strong encryption and key management.",
                "relevance": "Minimizes and protects stored payment records, reducing PCI scope and breach impact.",
                "integration_tips": "Avoid storing PAN; store only tokens and necessary metadata encrypted with strong KMS-managed keys. Restrict access via RBAC.",
                "priority": "High",
                "verification_method": "Data inventory and storage encryption configuration review; access audit."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.15.1.1",
                "chapter": "Supplier relationships",
                "section": "Information security policy for supplier relationships",
                "level": null,
                "requirement": "Information security requirements for mitigating the risks associated with supplier\u2019s access to the organization\u2019s assets shall be agreed with the supplier and documented.",
                "relevance": "Covers contractual and security requirements with payment gateway providers. Ensures third-party compliance.",
                "integration_tips": "Define SLAs, security clauses, breach notification, and data protection requirements with the PSP. Review SOC/PCI reports.",
                "priority": "Medium",
                "verification_method": "Supplier agreement review and third-party assurance evidence."
              },
              {
                "standard": "NIST",
                "req_id": "SA-9",
                "chapter": "System and Services Acquisition",
                "section": "External Information System Services",
                "level": null,
                "requirement": "Require that providers of external information system services comply with organizational information security requirements.",
                "relevance": "Mandates that the PSP meets security requirements, aligning integration with organizational policies.",
                "integration_tips": "Assess PSP security posture and include compliance reporting requirements. Monitor PSP changes impacting security.",
                "priority": "Medium",
                "verification_method": "Third-party risk assessment records and periodic reassessment reports."
              }
            ]
          },
          {
            "high_level_requirement": "Logging, audit trails, and analytics for moderation, payments and admin actions",
            "requirement_id": "REQ-17",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V7.1.3",
                "chapter": "V7 Error Handling and Logging",
                "section": "V7.1 Logging",
                "level": "L1",
                "requirement": "Verify that logs are generated for administrative actions, access control events, and security-relevant events.",
                "relevance": "Directly addresses logging of admin actions, payments, and moderation as security-relevant events.",
                "integration_tips": "Adopt structured logging with unique IDs; centralize logs in a SIEM; ensure clocks are synchronized.",
                "priority": "Critical",
                "verification_method": "Log sampling and SIEM ingestion verification for all target event types."
              },
              {
                "standard": "NIST",
                "req_id": "AU-8",
                "chapter": "Audit and Accountability",
                "section": "Time Stamps",
                "level": null,
                "requirement": "Use internal system clocks to generate time stamps for audit records with sufficient granularity to meet system requirements.",
                "relevance": "Accurate timestamps are vital for correlating events across moderation and payment systems.",
                "integration_tips": "Enable NTP across services and include timezone and precision in logs. Use consistent time formats (e.g., RFC3339).",
                "priority": "High",
                "verification_method": "Check NTP configuration and compare timestamps across services."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.2",
                "chapter": "Operations security",
                "section": "Protection of log information",
                "level": null,
                "requirement": "Logging facilities and log information shall be protected against tampering and unauthorized access.",
                "relevance": "Protects audit trails integrity for high-stakes areas like payments and admin actions.",
                "integration_tips": "Use append-only storage, role-based access to logs, and cryptographic integrity verification.",
                "priority": "High",
                "verification_method": "Inspect log storage controls and integrity check outcomes."
              },
              {
                "standard": "NIST",
                "req_id": "AU-9",
                "chapter": "Audit and Accountability",
                "section": "Protection of Audit Information",
                "level": null,
                "requirement": "Protect audit information and audit tools from unauthorized access, modification, and deletion.",
                "relevance": "Ensures audit data and tooling cannot be tampered with by admins or attackers. Critical for trustworthiness.",
                "integration_tips": "Separate duties for log management; restrict and monitor access to SIEM and log pipelines.",
                "priority": "High",
                "verification_method": "Access review for log tools and attempted unauthorized modification test."
              }
            ]
          },
          {
            "high_level_requirement": "Privacy and data protection controls (GDPR compliance, consent management, data subject requests)",
            "requirement_id": "REQ-18",
            "security_controls": [
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.4",
                "chapter": "Compliance",
                "section": "Privacy and protection of personally identifiable information",
                "level": null,
                "requirement": "Privacy and protection of personally identifiable information shall be ensured as required in relevant legislation and regulation.",
                "relevance": "Directly mandates GDPR-aligned protections for PII, covering lawful processing and safeguards.",
                "integration_tips": "Map processing activities, implement DPIAs where applicable, and enforce access controls on PII.",
                "priority": "Critical",
                "verification_method": "Review ROPA/DPIA documents and PII access controls."
              },
              {
                "standard": "OWASP",
                "req_id": "V1.4.4",
                "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
                "section": "V1.4 Privacy by Design",
                "level": "L2",
                "requirement": "Verify that consent is obtained, recorded, and can be withdrawn for personal data processing.",
                "relevance": "Covers consent management lifecycle required by GDPR, including withdrawal.",
                "integration_tips": "Implement a consent store with versioning and timestamps; enforce consent checks in data processing flows.",
                "priority": "High",
                "verification_method": "Examine consent records and test withdrawal propagation to processing systems."
              },
              {
                "standard": "NIST",
                "req_id": "AR-8",
                "chapter": "Authority and Purpose (Privacy)",
                "section": "Accounting of Disclosures",
                "level": null,
                "requirement": "Provide an accounting of disclosures of personally identifiable information to individuals upon request.",
                "relevance": "Supports GDPR data subject rights by tracking disclosures for subject access requests.",
                "integration_tips": "Maintain disclosure logs linked to data subjects and expose them via DSAR workflows.",
                "priority": "Medium",
                "verification_method": "Review disclosure log schema and perform a test DSAR."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.1",
                "chapter": "Compliance",
                "section": "Identification of applicable legislation and contractual requirements",
                "level": null,
                "requirement": "All relevant legislative statutory, regulatory and contractual requirements shall be explicitly identified and documented for each information system.",
                "relevance": "Requires identifying GDPR and other legal obligations, forming the basis of privacy control implementation.",
                "integration_tips": "Maintain a compliance register mapping requirements to controls and evidence. Review updates regularly.",
                "priority": "Medium",
                "verification_method": "Audit the compliance register and control mappings."
              }
            ]
          },
          {
            "high_level_requirement": "Security controls: encryption in transit and at rest, RBAC, MFA option, rate limiting and anti-abuse protections",
            "requirement_id": "REQ-19",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V9.1.2",
                "chapter": "V9 Data Protection Verification Requirements",
                "section": "V9.1 Data Classification",
                "level": "L1",
                "requirement": "Verify that all sensitive data is identified and classified, and appropriate protections are applied.",
                "relevance": "Data classification is prerequisite to applying correct encryption at rest/in transit and access controls.",
                "integration_tips": "Create a data classification inventory and map protections (TLS, encryption at rest, access policies) per class.",
                "priority": "Critical",
                "verification_method": "Review data inventory and control mappings to classification levels."
              },
              {
                "standard": "NIST",
                "req_id": "SC-12",
                "chapter": "System and Communications Protection",
                "section": "Cryptographic Key Establishment and Management",
                "level": null,
                "requirement": "Establish and manage cryptographic keys for required cryptography employed within the information system.",
                "relevance": "Proper key management underpins encryption at rest and in transit. Prevents compromise of protected data.",
                "integration_tips": "Use managed KMS/HSM for key lifecycle, rotation, and access controls; enforce separation of duties for key admins.",
                "priority": "High",
                "verification_method": "Key management policy review and evidence of key rotation/audit logs."
              },
              {
                "standard": "OWASP",
                "req_id": "V2.7.5",
                "chapter": "V2 Authentication Verification Requirements",
                "section": "V2.7 Session Management",
                "level": "L2",
                "requirement": "Verify that session management and authentication support multi-factor authentication where appropriate.",
                "relevance": "Satisfies MFA option requirement to harden authentication. Reduces account takeover risk.",
                "integration_tips": "Offer TOTP/WebAuthn MFA and provide recovery mechanisms; enforce MFA for high-privilege roles.",
                "priority": "High",
                "verification_method": "Test MFA enrollment and enforcement; review auth configuration."
              },
              {
                "standard": "NIST",
                "req_id": "SI-10",
                "chapter": "System and Information Integrity",
                "section": "Information Input Validation",
                "level": null,
                "requirement": "Check the validity of information inputs.",
                "relevance": "Input validation is fundamental to anti-abuse; combined with rate limiting prevents injection and resource abuse.",
                "integration_tips": "Apply centralized validation schemas and integrate with rate-limiting middleware at gateway level.",
                "priority": "Medium",
                "verification_method": "Code review of validation and gateway configs; fuzz testing of endpoints."
              }
            ]
          },
          {
            "high_level_requirement": "Accessibility and mobile responsiveness (WCAG conformance target)",
            "requirement_id": "REQ-20",
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V1.3.1",
                "chapter": "V1 Architecture, Design and Threat Modeling Requirements",
                "section": "V1.3 Secure Design",
                "level": "L1",
                "requirement": "Verify that security is addressed in user experience and design, including error messages and user guidance that do not leak sensitive information.",
                "relevance": "While WCAG is accessibility-focused, secure UX ensures accessible error handling without leaking sensitive data.",
                "integration_tips": "Design accessible error states and guidance that are clear yet do not expose internals. Include security considerations in UX reviews.",
                "priority": "Low",
                "verification_method": "UX review of error messages and accessibility testing."
              },
              {
                "standard": "OWASP",
                "req_id": "V7.3.1",
                "chapter": "V7 Error Handling and Logging",
                "section": "V7.3 Error Handling",
                "level": "L1",
                "requirement": "Verify that error messages are handled in a user-friendly manner without revealing sensitive information.",
                "relevance": "Accessible applications need clear errors, but they must not expose sensitive details. This balances both goals.",
                "integration_tips": "Return generic messages to users and detailed errors only in logs. Ensure messages meet accessibility guidelines (e.g., ARIA).",
                "priority": "Low",
                "verification_method": "UI testing for error content and accessibility audits."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.1",
                "chapter": "System acquisition, development and maintenance",
                "section": "Secure development policy",
                "level": null,
                "requirement": "Rules for the development of software and systems shall be established and applied to developments within the organization.",
                "relevance": "Secure development policies should include accessibility considerations to reduce security issues in responsive UIs.",
                "integration_tips": "Incorporate accessibility checks into SDLC and code review policies alongside security checks.",
                "priority": "Low",
                "verification_method": "Policy review and pipeline checks for accessibility/security gates."
              },
              {
                "standard": "NIST",
                "req_id": "RA-5",
                "chapter": "Risk Assessment",
                "section": "Vulnerability Monitoring and Scanning",
                "level": null,
                "requirement": "Scan for vulnerabilities in the information system and hosted applications and address identified vulnerabilities.",
                "relevance": "Responsive frontends may introduce security flaws; ongoing scanning and remediation sustains a secure, accessible experience.",
                "integration_tips": "Run regular dynamic scans against mobile and responsive views and triage findings promptly.",
                "priority": "Low",
                "verification_method": "Scan reports and remediation tracking."
              }
            ]
          }
        ],
        "cross_functional_controls": [
          {
            "control_name": "Transport Layer Security",
            "description": "Encrypt all data in transit using strong TLS and validate certificates.",
            "applies_to": [
              "User registration and login with role assignment and secure authentication",
              "Secure in-app messaging between users with optional verified contact reveal",
              "Secure payment gateway integration and payment record management",
              "Notifications system for adverts, messages and moderation status",
              "Interactive map with clustering and approximate location display"
            ],
            "implementation_guidance": "Enforce TLS 1.2+ with modern ciphers, HSTS, and certificate validation/pinning where appropriate."
          },
          {
            "control_name": "Centralized Authorization (RBAC/ABAC)",
            "description": "Consistent server-side authorization for all protected resources and operations.",
            "applies_to": [
              "User registration and login with role assignment and secure authentication",
              "Email domain verification and tier-based access controls (free vs paid advertisers)",
              "Advert creation, edit, delete lifecycle with support for multi-room properties",
              "Administrator and moderator dashboard for content, user and role management",
              "Paid-tier features: priority listing, branding, analytics, subscription and one-off payments"
            ],
            "implementation_guidance": "Use a policy engine or middleware to enforce per-request checks based on roles/attributes; deny by default."
          },
          {
            "control_name": "Comprehensive Logging and Audit",
            "description": "Generate, protect, and review logs for security-relevant events and administrative activities.",
            "applies_to": [
              "Automated and manual moderation workflow for adverts and content",
              "Notifications system for adverts, messages and moderation status",
              "Administrator and moderator dashboard for content, user and role management",
              "Logging, audit trails, and analytics for moderation, payments and admin actions",
              "Reporting and abuse-flagging system with dispute handling"
            ],
            "implementation_guidance": "Use structured logs with timestamps and correlation IDs; protect logs from tampering and perform regular reviews in a SIEM."
          },
          {
            "control_name": "Input Validation and Output Encoding",
            "description": "Validate all inputs and encode outputs to prevent injection and XSS.",
            "applies_to": [
              "Advert creation, edit, delete lifecycle with support for multi-room properties",
              "Advanced filtering, saveable searches, and alerting (instant and daily digest)",
              "Interactive map with clustering and approximate location display",
              "Notifications system for adverts, messages and moderation status"
            ],
            "implementation_guidance": "Adopt positive validation using schemas and perform contextual output encoding in templates and UI components."
          },
          {
            "control_name": "Privacy by Design and Data Minimization",
            "description": "Minimize collection and exposure of personal and location data and provide user controls.",
            "applies_to": [
              "User profile management with verifiable contact display options",
              "Geo-centric search and filtered discovery with map visualisation (approximate locations)",
              "Interactive map with clustering and approximate location display",
              "Privacy and data protection controls (GDPR compliance, consent management, data subject requests)"
            ],
            "implementation_guidance": "Classify data, limit retention, mask or approximate sensitive fields, and implement consent and data subject rights workflows."
          }
        ],
        "recommended_asvs_level": "L2"
      }
    }
  ]
}