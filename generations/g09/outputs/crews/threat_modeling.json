{
  "raw": "{\n  \"methodology\": \"STRIDE\",\n  \"threats\": [\n    {\n      \"threat_id\": \"THR-001\",\n      \"component\": \"Frontend Layer (SPA) - Calendar & Tables\",\n      \"threat_category\": \"Information Disclosure / Spoofing\",\n      \"description\": \"Reflected or stored XSS in UI (calendar, shift preview, user profile) allows an attacker to run JS in another user's session, exfiltrate session tokens, hijack accounts, or perform actions on behalf of the user.\",\n      \"likelihood\": \"High\",\n      \"impact\": \"High\",\n      \"risk_level\": \"Critical\",\n      \"mitigation_strategy\": \"Enforce output encoding/escaping on all user-supplied content; use a strict Content Security Policy (CSP) with nonces; sanitize inputs server-side and client-side, avoid innerHTML; use frameworks' safe templating; review third-party libs; run regular automated and manual XSS testing (DAST/SAST).\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-002\",\n      \"component\": \"Frontend Layer & Application Services (Forms & Actions)\",\n      \"threat_category\": \"Tampering (CSRF)\",\n      \"description\": \"Cross-Site Request Forgery: authenticated users could be induced to submit state-changing requests (assignments, accept generated shifts) from another origin.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Implement anti-CSRF tokens on state-changing endpoints or use SameSite=strict/strictish cookies for session tokens; require explicit user confirmation for risky ops (e.g., commit auto-assignment); validate Origin/Referer headers; use CORS allowlist.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-003\",\n      \"component\": \"Frontend Layer (Token Handling)\",\n      \"threat_category\": \"Spoofing / Information Disclosure\",\n      \"description\": \"Session tokens or OAuth tokens stored insecurely in localStorage or accessible JS can be stolen via XSS or malicious extensions, enabling account takeover.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use secure, httpOnly cookies with SameSite attributes for session tokens; minimize token lifetime; use token rotation and refresh tokens stored securely; implement strong CSP and XSS mitigations; detect anomalous sessions and revoke tokens.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-004\",\n      \"component\": \"Frontend Layer / External Services (Google OAuth)\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Open redirect or incorrect OAuth redirect URI validation allows attackers to capture authorization codes or tokens via a malicious callback, leading to account takeover.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Strictly validate redirect_uris against allowlist; use PKCE for OAuth flows; verify state parameter and nonce; enforce HTTPS on callback URIs; monitor for abnormal OAuth grant patterns.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-005\",\n      \"component\": \"Edge Layer (CDN/WAF/TLS)\",\n      \"threat_category\": \"Information Disclosure / Tampering\",\n      \"description\": \"TLS termination or CDN misconfiguration (weak ciphers, expired certs, missing HSTS) could allow MitM, protocol downgrade, or data interception between clients and edge.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Enforce strong TLS configuration (TLS1.2+ recommended, prefer 1.3), HSTS, secure certificate lifecycle management, automate renewals, monitor TLS telemetry, enable HTTP Strict Transport Security, and perform periodic TLS scans.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-006\",\n      \"component\": \"Edge Layer (WAF & API Gateway)\",\n      \"threat_category\": \"Tampering / Information Disclosure\",\n      \"description\": \"WAF rule bypass or insufficient WAF rules allow injection payloads (SQLi, XSS) to reach backend; misconfigured gateway could leak internal details via verbose errors.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Implement layered WAF rules including OWASP top 10 protections; use positive allowlists for APIs; sanitize error messages; enable anomaly detection and tuning; use gateway-level request validation and schema checks.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-007\",\n      \"component\": \"Edge Layer (Rate Limiting)\",\n      \"threat_category\": \"Denial of Service\",\n      \"description\": \"Absence or weak rate limiting allows brute-force, enumeration, or abusive polling (e.g., optimizer polling) causing backend overload or service degradation.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Apply per-IP, per-user, and per-endpoint rate limits; exponential backoff; CAPTCHAs for suspicious flows (login); token bucket throttling; protect long-polling endpoints with quotas; monitor metrics and alert on spikes.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-008\",\n      \"component\": \"Application Services - Authentication\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Credential stuffing, weak passwords, or lack of MFA leads to account takeover of ADMIN/MANAGER accounts allowing large-scale damage.\",\n      \"likelihood\": \"High\",\n      \"impact\": \"High\",\n      \"risk_level\": \"Critical\",\n      \"mitigation_strategy\": \"Enforce strong password policies, rate-limit authentication attempts, use account lockouts or adaptive throttling, require MFA for privileged roles, integrate breached-password checks and anomaly detection, encourage SSO (Google) with secure config.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-009\",\n      \"component\": \"Application Services - Password Reset\",\n      \"threat_category\": \"Spoofing / Repudiation\",\n      \"description\": \"Weak or predictable password reset tokens, or emails sent with insufficient verification, allow attackers to reset passwords and take over accounts.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use long, cryptographically secure, single-use tokens with short TTL; bind token to user agent/IP metadata; log and notify users of resets; rate limit reset requests; verify identity for high-privilege resets; avoid leaking account existence info.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-010\",\n      \"component\": \"Application Services - OAuth Integration\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Compromised or replayed OAuth tokens from Google OAuth could be used to impersonate users if token validation is insufficient.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Validate ID token signatures and claims server-side; check token expiry and audience; implement token revocation and rotation; use PKCE and state parameters; map OAuth identities carefully to internal accounts with additional checks for privileged ops.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-011\",\n      \"component\": \"Application Services - RBAC / Multi-tenant Checks\",\n      \"threat_category\": \"Elevation of Privilege\",\n      \"description\": \"Broken access control or insufficient tenant scoping may allow a manager/admin/employee to view or modify data for other companies or elevate privileges.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Implement centralized, fine-grained RBAC and tenant authorization checks on the server side (deny-by-default); perform authorization at every entry point; use automated tests for tenant isolation; include ABAC claims (tenant_id, role) in tokens and validate them server-side.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-012\",\n      \"component\": \"Application Services - Multi-Tenancy\",\n      \"threat_category\": \"Information Disclosure / Tampering\",\n      \"description\": \"Data leakage across tenants due to incorrect SQL queries, shared caches, or improper tenant-scoped identifiers could expose PII and shift data of other companies.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use strict tenant_id scoping in queries, prepared statements, row-level security or separate schemas per tenant if appropriate; segregate caches (prefix keys by tenant_id), encrypt data at rest, review multi-tenant design in threat model.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-013\",\n      \"component\": \"Application Services - Shift APIs / DB Layer\",\n      \"threat_category\": \"Tampering (Injection)\",\n      \"description\": \"SQL injection, NoSQL injection or command injection via poorly validated parameters (search, filtering, sorting) could lead to data theft or corruption.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use parameterized queries/ORMs, input validation and canonicalization, allowlist sorting/filtering fields, use least privilege DB accounts, run SAST and SQLi testing, employ web application firewall rules tailored to injections.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-014\",\n      \"component\": \"Auto-Assignment (Optimizer Orchestration)\",\n      \"threat_category\": \"Tampering / Integrity\",\n      \"description\": \"An attacker could manipulate optimization payloads, acceptance flow, or solver responses (malformed or malicious solution) to force incorrect assignments (e.g., assign unauthorized employees to shifts) or bypass constraints.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Sign and validate payloads and responses; use mutual TLS or API keys with IP allowlisting for Timefold; validate solver results against business rules server-side; sandbox and review solutions; require manager approval for critical changes; maintain an immutable audit trail.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-015\",\n      \"component\": \"Application Services - Background Jobs / Queue\",\n      \"threat_category\": \"Denial of Service / Tampering\",\n      \"description\": \"Queue or job system abuse (poisoned jobs, replayed jobs, or malformed payloads) can cause failures in optimizer orchestration, duplicate processing, or resource exhaustion.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Validate and sanitize queued payloads, enforce max job size and rate limits, implement dead-letter queues and idempotency tokens, use job signing or auth, monitor queue depth and job error rates, and use per-tenant job quotas.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-016\",\n      \"component\": \"Application Services - Audit & Logging\",\n      \"threat_category\": \"Repudiation\",\n      \"description\": \"Insufficient or tamperable audit logs allow malicious actors to erase traces of actions (shift changes, acceptance) or administrators to repudiate actions.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Append-only audit logs, write to immutable storage or WORM-enabled object storage, centralize logs to a managed SIEM, sign or hash log entries, restrict log access, and monitor for log deletion events.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-017\",\n      \"component\": \"Data Layer - Object Storage (Exports/Artifacts)\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Misconfigured S3-like buckets or signed URLs with overly long TTLs could leak CSV/XLSX exports or optimizer artifacts publicly, exposing PII and shift data.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Enforce bucket policies denying public access, use short-lived signed URLs, server-side access control by tenant, encrypt objects at rest, log and monitor object access, and scan object buckets for public exposure.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-018\",\n      \"component\": \"Data Layer - Managed RDBMS\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Database credentials stored insecurely (in code, misconfigured secrets management) or overly-permissive DB accounts allow attackers or insiders to dump tenant data.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use managed secrets (KMS/Secret Manager), rotate credentials regularly, enforce least privilege DB roles, network isolate DB (VPC), enable encryption at rest, enable DB auditing, and use IAM-based auth where available.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-019\",\n      \"component\": \"Data Layer - Backups & Export Files\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Backups, exported CSV/XLSX, or optimizer artifacts containing PII may be retained insecurely or sent to external systems without encryption, leading to data leakage.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Encrypt backups and exports at rest and in transit, restrict access to backups, apply retention and deletion policies, sanitize exports (redact sensitive fields when possible), and log export/download events per tenant.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-020\",\n      \"component\": \"Data Layer - Cache/Session Store (Redis)\",\n      \"threat_category\": \"Spoofing / Information Disclosure\",\n      \"description\": \"Compromise of cache/session store could allow theft of session tokens or tenant-scoped cached data, enabling session hijacking or data leakage.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Network-restrict access to cache (VPC security groups), enable AUTH and TLS on Redis, do not store long-lived secrets in cache, rotate session tokens and invalidate sessions on suspicious activity, isolate keys per tenant, and monitor access.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-021\",\n      \"component\": \"External Services - Timefold Solver Integration\",\n      \"threat_category\": \"Information Disclosure / Tampering\",\n      \"description\": \"Sensitive optimization payloads (employee availability, leave, skills) transmitted to or stored by the external solver may be exposed if the external service is compromised or communication is intercepted.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Minimize sensitive data sent to external solver; use strong transport security (mTLS), enable payload encryption where possible, contractually require security controls from provider, implement data minimization and anonymization, and maintain an audit of payloads sent.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-022\",\n      \"component\": \"External Services - Timefold Solver / Solver Responses\",\n      \"threat_category\": \"Tampering / Elevation of Privilege\",\n      \"description\": \"Malicious or malformed solver responses could instruct the application to create invalid/privileged assignments or bypass constraints if insufficiently validated.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Validate solver outputs against server-side business rules and constraints before applying; require manager acceptance for significant changes; verify score integrity; sandbox parsing logic and implement strict schema validation for responses.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-023\",\n      \"component\": \"External Services - Email Delivery Provider\",\n      \"threat_category\": \"Information Disclosure / Repudiation\",\n      \"description\": \"Compromised email provider or mis-sent transactional emails (password resets, verification) can be used for phishing or account takeover or accidental leakage of PII.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use a reputable provider with security SLAs; sign emails (DKIM/SPF/DMARC), limit PII in emails, use templated safe content, rate-limit mass emails, monitor bounce/reputation, and provide out-of-band verification for critical operations.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-024\",\n      \"component\": \"External Services - Google OAuth Provider\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Compromise of Google OAuth accounts or misconfiguration (improperly mapped accounts) allowing attackers to authenticate as other users or link accounts incorrectly.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Implement verification steps when linking OAuth accounts; check verified email claims; require additional verification for privileged role assignment; detect and alert on suspicious OAuth logins (new IP/geo), and support account unlinking and emergency access removal.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-025\",\n      \"component\": \"External Services - Monitoring & Logging\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Sensitive data (PII, tokens) in logs or monitoring metrics sent to third-party services may leak across organizations or be accessible to unauthorized parties.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Redact or mask PII/tokens before sending to logs; use sampling and data minimization; restrict access to monitoring dashboards; apply retention policies; use encryption for logs in transit and at rest.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-026\",\n      \"component\": \"Data Export Feature (CSV/XLSX)\",\n      \"threat_category\": \"Tampering / Information Disclosure\",\n      \"description\": \"Exported spreadsheets containing user-entered fields could include CSV injection (formula injection) or contain sensitive PII unexpectedly; exported files may be downloaded using unsecured links.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Sanitize cell content (prefix ' or use safe formatting to avoid formula execution), require authentication to download, use short-lived signed URLs, perform pre-export redaction options, and log export events per user and tenant.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-027\",\n      \"component\": \"Auto-Assignment (Concurrency)\",\n      \"threat_category\": \"Tampering / Denial of Service\",\n      \"description\": \"Race conditions between auto-assignment job acceptance and manual edits can create duplicate shifts, gaps, or inconsistent state across tenants.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Use transactional operations, optimistic concurrency control (versioning), idempotency tokens for operations, and perform final validation before commit; provide conflict resolution UI and alerting.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-028\",\n      \"component\": \"API Gateway / Frontend Polling (Optimizer Polling)\",\n      \"threat_category\": \"Denial of Service\",\n      \"description\": \"Abuse of real-time polling endpoints (frequent polling for optimization status) can overwhelm backend services, increasing costs and causing outages.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Implement backoff, push mechanisms (WebSockets/Server-Sent Events) with authenticated subscribe, enforce polling rate limits, introduce caching for status, and apply quotas per tenant.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-029\",\n      \"component\": \"Internationalization / Date-Time Handling\",\n      \"threat_category\": \"Tampering / Information Disclosure\",\n      \"description\": \"Locale and timezone misparsing or injection of malformed locale strings could cause incorrect shift calculations, exposing different tenants' data or mis-scheduling employees.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Normalize and validate all locale/timezone inputs against known allowlists, store all times in UTC and render locale-aware only in UI, add unit and integration tests for date conversions, and log unexpected locale values.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-030\",\n      \"component\": \"User Interface (Cookies / Session)\",\n      \"threat_category\": \"Elevation of Privilege\",\n      \"description\": \"XSS or insecure cookie settings allow session cookie theft leading to privilege escalation (e.g., attacker operates as manager/admin).\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use httpOnly and Secure cookies with SameSite attributes, rotate sessions on privilege changes, provide session management UI for users, invalidate sessions on suspicious activity, and enforce MFA for privileged actions.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    }\n  ],\n  \"risk_summary\": \"Critical threats center on authentication/authorization failures, multi-tenant isolation errors, and injection/XSS allowing account takeover or cross-tenant data exposure. Attackers' primary entry points are the frontend (XSS, token storage), authentication flows (credential stuffing, OAuth misconfig), the API gateway (injection and WAF bypass), and external integrations (Timefold, email, OAuth). The highest-risk items requiring immediate attention are: (1) XSS leading to session theft (THR-001), (2) credential-based account takeover and lack of MFA for privileged roles (THR-008), (3) broken RBAC / tenant isolation allowing cross-tenant access (THR-011/THR-012), (4) SQL/command injection and WAF bypass (THR-013/THR-006), and (5) leakage of exports/optimizer payloads via misconfigured object storage or external services (THR-017/THR-021). Overall posture is medium-to-high risk until core controls are implemented: robust server-side authorization and tenant scoping, secure authentication (MFA, strong password policy, OAuth hardening), comprehensive input validation and encoding (prevent XSS/SQLi), secure token handling, network and secrets hygiene, and strict controls for third-party integrations. Priorities: implement strong RBAC and tenancy enforcement, fix XSS vectors and switch to httpOnly secure cookies, enable MFA, enforce parameterized queries and WAF rules, harden edge TLS and rate limiting, encrypt and restrict access to backups/exports, and secure external solver integrations with mTLS and payload validation. Regular controls to deploy: threat-aware secure coding, SAST/DAST, fuzzing/testing around date/time/locale handling, blue/green deployments with security gating, incident detection/response capabilities, and contractual + technical risk controls for third-party providers.\"\n}",
  "pydantic": {
    "methodology": "STRIDE",
    "threats": [
      {
        "threat_id": "THR-001",
        "component": "Frontend Layer (SPA) - Calendar & Tables",
        "threat_category": "Information Disclosure / Spoofing",
        "description": "Reflected or stored XSS in UI (calendar, shift preview, user profile) allows an attacker to run JS in another user's session, exfiltrate session tokens, hijack accounts, or perform actions on behalf of the user.",
        "likelihood": "High",
        "impact": "High",
        "risk_level": "Critical",
        "mitigation_strategy": "Enforce output encoding/escaping on all user-supplied content; use a strict Content Security Policy (CSP) with nonces; sanitize inputs server-side and client-side, avoid innerHTML; use frameworks' safe templating; review third-party libs; run regular automated and manual XSS testing (DAST/SAST).",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-002",
        "component": "Frontend Layer & Application Services (Forms & Actions)",
        "threat_category": "Tampering (CSRF)",
        "description": "Cross-Site Request Forgery: authenticated users could be induced to submit state-changing requests (assignments, accept generated shifts) from another origin.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Implement anti-CSRF tokens on state-changing endpoints or use SameSite=strict/strictish cookies for session tokens; require explicit user confirmation for risky ops (e.g., commit auto-assignment); validate Origin/Referer headers; use CORS allowlist.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-003",
        "component": "Frontend Layer (Token Handling)",
        "threat_category": "Spoofing / Information Disclosure",
        "description": "Session tokens or OAuth tokens stored insecurely in localStorage or accessible JS can be stolen via XSS or malicious extensions, enabling account takeover.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use secure, httpOnly cookies with SameSite attributes for session tokens; minimize token lifetime; use token rotation and refresh tokens stored securely; implement strong CSP and XSS mitigations; detect anomalous sessions and revoke tokens.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-004",
        "component": "Frontend Layer / External Services (Google OAuth)",
        "threat_category": "Spoofing",
        "description": "Open redirect or incorrect OAuth redirect URI validation allows attackers to capture authorization codes or tokens via a malicious callback, leading to account takeover.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Strictly validate redirect_uris against allowlist; use PKCE for OAuth flows; verify state parameter and nonce; enforce HTTPS on callback URIs; monitor for abnormal OAuth grant patterns.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-005",
        "component": "Edge Layer (CDN/WAF/TLS)",
        "threat_category": "Information Disclosure / Tampering",
        "description": "TLS termination or CDN misconfiguration (weak ciphers, expired certs, missing HSTS) could allow MitM, protocol downgrade, or data interception between clients and edge.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Enforce strong TLS configuration (TLS1.2+ recommended, prefer 1.3), HSTS, secure certificate lifecycle management, automate renewals, monitor TLS telemetry, enable HTTP Strict Transport Security, and perform periodic TLS scans.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-006",
        "component": "Edge Layer (WAF & API Gateway)",
        "threat_category": "Tampering / Information Disclosure",
        "description": "WAF rule bypass or insufficient WAF rules allow injection payloads (SQLi, XSS) to reach backend; misconfigured gateway could leak internal details via verbose errors.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Implement layered WAF rules including OWASP top 10 protections; use positive allowlists for APIs; sanitize error messages; enable anomaly detection and tuning; use gateway-level request validation and schema checks.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-007",
        "component": "Edge Layer (Rate Limiting)",
        "threat_category": "Denial of Service",
        "description": "Absence or weak rate limiting allows brute-force, enumeration, or abusive polling (e.g., optimizer polling) causing backend overload or service degradation.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Apply per-IP, per-user, and per-endpoint rate limits; exponential backoff; CAPTCHAs for suspicious flows (login); token bucket throttling; protect long-polling endpoints with quotas; monitor metrics and alert on spikes.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-008",
        "component": "Application Services - Authentication",
        "threat_category": "Spoofing",
        "description": "Credential stuffing, weak passwords, or lack of MFA leads to account takeover of ADMIN/MANAGER accounts allowing large-scale damage.",
        "likelihood": "High",
        "impact": "High",
        "risk_level": "Critical",
        "mitigation_strategy": "Enforce strong password policies, rate-limit authentication attempts, use account lockouts or adaptive throttling, require MFA for privileged roles, integrate breached-password checks and anomaly detection, encourage SSO (Google) with secure config.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-009",
        "component": "Application Services - Password Reset",
        "threat_category": "Spoofing / Repudiation",
        "description": "Weak or predictable password reset tokens, or emails sent with insufficient verification, allow attackers to reset passwords and take over accounts.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use long, cryptographically secure, single-use tokens with short TTL; bind token to user agent/IP metadata; log and notify users of resets; rate limit reset requests; verify identity for high-privilege resets; avoid leaking account existence info.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-010",
        "component": "Application Services - OAuth Integration",
        "threat_category": "Spoofing",
        "description": "Compromised or replayed OAuth tokens from Google OAuth could be used to impersonate users if token validation is insufficient.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Validate ID token signatures and claims server-side; check token expiry and audience; implement token revocation and rotation; use PKCE and state parameters; map OAuth identities carefully to internal accounts with additional checks for privileged ops.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-011",
        "component": "Application Services - RBAC / Multi-tenant Checks",
        "threat_category": "Elevation of Privilege",
        "description": "Broken access control or insufficient tenant scoping may allow a manager/admin/employee to view or modify data for other companies or elevate privileges.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Implement centralized, fine-grained RBAC and tenant authorization checks on the server side (deny-by-default); perform authorization at every entry point; use automated tests for tenant isolation; include ABAC claims (tenant_id, role) in tokens and validate them server-side.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-012",
        "component": "Application Services - Multi-Tenancy",
        "threat_category": "Information Disclosure / Tampering",
        "description": "Data leakage across tenants due to incorrect SQL queries, shared caches, or improper tenant-scoped identifiers could expose PII and shift data of other companies.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use strict tenant_id scoping in queries, prepared statements, row-level security or separate schemas per tenant if appropriate; segregate caches (prefix keys by tenant_id), encrypt data at rest, review multi-tenant design in threat model.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-013",
        "component": "Application Services - Shift APIs / DB Layer",
        "threat_category": "Tampering (Injection)",
        "description": "SQL injection, NoSQL injection or command injection via poorly validated parameters (search, filtering, sorting) could lead to data theft or corruption.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use parameterized queries/ORMs, input validation and canonicalization, allowlist sorting/filtering fields, use least privilege DB accounts, run SAST and SQLi testing, employ web application firewall rules tailored to injections.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-014",
        "component": "Auto-Assignment (Optimizer Orchestration)",
        "threat_category": "Tampering / Integrity",
        "description": "An attacker could manipulate optimization payloads, acceptance flow, or solver responses (malformed or malicious solution) to force incorrect assignments (e.g., assign unauthorized employees to shifts) or bypass constraints.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Sign and validate payloads and responses; use mutual TLS or API keys with IP allowlisting for Timefold; validate solver results against business rules server-side; sandbox and review solutions; require manager approval for critical changes; maintain an immutable audit trail.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-015",
        "component": "Application Services - Background Jobs / Queue",
        "threat_category": "Denial of Service / Tampering",
        "description": "Queue or job system abuse (poisoned jobs, replayed jobs, or malformed payloads) can cause failures in optimizer orchestration, duplicate processing, or resource exhaustion.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Validate and sanitize queued payloads, enforce max job size and rate limits, implement dead-letter queues and idempotency tokens, use job signing or auth, monitor queue depth and job error rates, and use per-tenant job quotas.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-016",
        "component": "Application Services - Audit & Logging",
        "threat_category": "Repudiation",
        "description": "Insufficient or tamperable audit logs allow malicious actors to erase traces of actions (shift changes, acceptance) or administrators to repudiate actions.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Append-only audit logs, write to immutable storage or WORM-enabled object storage, centralize logs to a managed SIEM, sign or hash log entries, restrict log access, and monitor for log deletion events.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-017",
        "component": "Data Layer - Object Storage (Exports/Artifacts)",
        "threat_category": "Information Disclosure",
        "description": "Misconfigured S3-like buckets or signed URLs with overly long TTLs could leak CSV/XLSX exports or optimizer artifacts publicly, exposing PII and shift data.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Enforce bucket policies denying public access, use short-lived signed URLs, server-side access control by tenant, encrypt objects at rest, log and monitor object access, and scan object buckets for public exposure.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-018",
        "component": "Data Layer - Managed RDBMS",
        "threat_category": "Information Disclosure",
        "description": "Database credentials stored insecurely (in code, misconfigured secrets management) or overly-permissive DB accounts allow attackers or insiders to dump tenant data.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use managed secrets (KMS/Secret Manager), rotate credentials regularly, enforce least privilege DB roles, network isolate DB (VPC), enable encryption at rest, enable DB auditing, and use IAM-based auth where available.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-019",
        "component": "Data Layer - Backups & Export Files",
        "threat_category": "Information Disclosure",
        "description": "Backups, exported CSV/XLSX, or optimizer artifacts containing PII may be retained insecurely or sent to external systems without encryption, leading to data leakage.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Encrypt backups and exports at rest and in transit, restrict access to backups, apply retention and deletion policies, sanitize exports (redact sensitive fields when possible), and log export/download events per tenant.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-020",
        "component": "Data Layer - Cache/Session Store (Redis)",
        "threat_category": "Spoofing / Information Disclosure",
        "description": "Compromise of cache/session store could allow theft of session tokens or tenant-scoped cached data, enabling session hijacking or data leakage.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Network-restrict access to cache (VPC security groups), enable AUTH and TLS on Redis, do not store long-lived secrets in cache, rotate session tokens and invalidate sessions on suspicious activity, isolate keys per tenant, and monitor access.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-021",
        "component": "External Services - Timefold Solver Integration",
        "threat_category": "Information Disclosure / Tampering",
        "description": "Sensitive optimization payloads (employee availability, leave, skills) transmitted to or stored by the external solver may be exposed if the external service is compromised or communication is intercepted.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Minimize sensitive data sent to external solver; use strong transport security (mTLS), enable payload encryption where possible, contractually require security controls from provider, implement data minimization and anonymization, and maintain an audit of payloads sent.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-022",
        "component": "External Services - Timefold Solver / Solver Responses",
        "threat_category": "Tampering / Elevation of Privilege",
        "description": "Malicious or malformed solver responses could instruct the application to create invalid/privileged assignments or bypass constraints if insufficiently validated.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Validate solver outputs against server-side business rules and constraints before applying; require manager acceptance for significant changes; verify score integrity; sandbox parsing logic and implement strict schema validation for responses.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-023",
        "component": "External Services - Email Delivery Provider",
        "threat_category": "Information Disclosure / Repudiation",
        "description": "Compromised email provider or mis-sent transactional emails (password resets, verification) can be used for phishing or account takeover or accidental leakage of PII.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use a reputable provider with security SLAs; sign emails (DKIM/SPF/DMARC), limit PII in emails, use templated safe content, rate-limit mass emails, monitor bounce/reputation, and provide out-of-band verification for critical operations.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-024",
        "component": "External Services - Google OAuth Provider",
        "threat_category": "Spoofing",
        "description": "Compromise of Google OAuth accounts or misconfiguration (improperly mapped accounts) allowing attackers to authenticate as other users or link accounts incorrectly.",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Implement verification steps when linking OAuth accounts; check verified email claims; require additional verification for privileged role assignment; detect and alert on suspicious OAuth logins (new IP/geo), and support account unlinking and emergency access removal.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-025",
        "component": "External Services - Monitoring & Logging",
        "threat_category": "Information Disclosure",
        "description": "Sensitive data (PII, tokens) in logs or monitoring metrics sent to third-party services may leak across organizations or be accessible to unauthorized parties.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Redact or mask PII/tokens before sending to logs; use sampling and data minimization; restrict access to monitoring dashboards; apply retention policies; use encryption for logs in transit and at rest.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-026",
        "component": "Data Export Feature (CSV/XLSX)",
        "threat_category": "Tampering / Information Disclosure",
        "description": "Exported spreadsheets containing user-entered fields could include CSV injection (formula injection) or contain sensitive PII unexpectedly; exported files may be downloaded using unsecured links.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Sanitize cell content (prefix ' or use safe formatting to avoid formula execution), require authentication to download, use short-lived signed URLs, perform pre-export redaction options, and log export events per user and tenant.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-027",
        "component": "Auto-Assignment (Concurrency)",
        "threat_category": "Tampering / Denial of Service",
        "description": "Race conditions between auto-assignment job acceptance and manual edits can create duplicate shifts, gaps, or inconsistent state across tenants.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Use transactional operations, optimistic concurrency control (versioning), idempotency tokens for operations, and perform final validation before commit; provide conflict resolution UI and alerting.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-028",
        "component": "API Gateway / Frontend Polling (Optimizer Polling)",
        "threat_category": "Denial of Service",
        "description": "Abuse of real-time polling endpoints (frequent polling for optimization status) can overwhelm backend services, increasing costs and causing outages.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Implement backoff, push mechanisms (WebSockets/Server-Sent Events) with authenticated subscribe, enforce polling rate limits, introduce caching for status, and apply quotas per tenant.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-029",
        "component": "Internationalization / Date-Time Handling",
        "threat_category": "Tampering / Information Disclosure",
        "description": "Locale and timezone misparsing or injection of malformed locale strings could cause incorrect shift calculations, exposing different tenants' data or mis-scheduling employees.",
        "likelihood": "Medium",
        "impact": "Medium",
        "risk_level": "Medium",
        "mitigation_strategy": "Normalize and validate all locale/timezone inputs against known allowlists, store all times in UTC and render locale-aware only in UI, add unit and integration tests for date conversions, and log unexpected locale values.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      },
      {
        "threat_id": "THR-030",
        "component": "User Interface (Cookies / Session)",
        "threat_category": "Elevation of Privilege",
        "description": "XSS or insecure cookie settings allow session cookie theft leading to privilege escalation (e.g., attacker operates as manager/admin).",
        "likelihood": "Medium",
        "impact": "High",
        "risk_level": "High",
        "mitigation_strategy": "Use httpOnly and Secure cookies with SameSite attributes, rotate sessions on privilege changes, provide session management UI for users, invalidate sessions on suspicious activity, and enforce MFA for privileged actions.",
        "applicable_controls": null,
        "control_effectiveness": null,
        "residual_risk_level": null,
        "residual_risk_acceptance": null
      }
    ],
    "risk_summary": "Critical threats center on authentication/authorization failures, multi-tenant isolation errors, and injection/XSS allowing account takeover or cross-tenant data exposure. Attackers' primary entry points are the frontend (XSS, token storage), authentication flows (credential stuffing, OAuth misconfig), the API gateway (injection and WAF bypass), and external integrations (Timefold, email, OAuth). The highest-risk items requiring immediate attention are: (1) XSS leading to session theft (THR-001), (2) credential-based account takeover and lack of MFA for privileged roles (THR-008), (3) broken RBAC / tenant isolation allowing cross-tenant access (THR-011/THR-012), (4) SQL/command injection and WAF bypass (THR-013/THR-006), and (5) leakage of exports/optimizer payloads via misconfigured object storage or external services (THR-017/THR-021). Overall posture is medium-to-high risk until core controls are implemented: robust server-side authorization and tenant scoping, secure authentication (MFA, strong password policy, OAuth hardening), comprehensive input validation and encoding (prevent XSS/SQLi), secure token handling, network and secrets hygiene, and strict controls for third-party integrations. Priorities: implement strong RBAC and tenancy enforcement, fix XSS vectors and switch to httpOnly secure cookies, enable MFA, enforce parameterized queries and WAF rules, harden edge TLS and rate limiting, encrypt and restrict access to backups/exports, and secure external solver integrations with mTLS and payload validation. Regular controls to deploy: threat-aware secure coding, SAST/DAST, fuzzing/testing around date/time/locale handling, blue/green deployments with security gating, incident detection/response capabilities, and contractual + technical risk controls for third-party providers."
  },
  "tasks": [
    {
      "name": "perform_threat_modeling",
      "raw": "{\n  \"methodology\": \"STRIDE\",\n  \"threats\": [\n    {\n      \"threat_id\": \"THR-001\",\n      \"component\": \"Frontend Layer (SPA) - Calendar & Tables\",\n      \"threat_category\": \"Information Disclosure / Spoofing\",\n      \"description\": \"Reflected or stored XSS in UI (calendar, shift preview, user profile) allows an attacker to run JS in another user's session, exfiltrate session tokens, hijack accounts, or perform actions on behalf of the user.\",\n      \"likelihood\": \"High\",\n      \"impact\": \"High\",\n      \"risk_level\": \"Critical\",\n      \"mitigation_strategy\": \"Enforce output encoding/escaping on all user-supplied content; use a strict Content Security Policy (CSP) with nonces; sanitize inputs server-side and client-side, avoid innerHTML; use frameworks' safe templating; review third-party libs; run regular automated and manual XSS testing (DAST/SAST).\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-002\",\n      \"component\": \"Frontend Layer & Application Services (Forms & Actions)\",\n      \"threat_category\": \"Tampering (CSRF)\",\n      \"description\": \"Cross-Site Request Forgery: authenticated users could be induced to submit state-changing requests (assignments, accept generated shifts) from another origin.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Implement anti-CSRF tokens on state-changing endpoints or use SameSite=strict/strictish cookies for session tokens; require explicit user confirmation for risky ops (e.g., commit auto-assignment); validate Origin/Referer headers; use CORS allowlist.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-003\",\n      \"component\": \"Frontend Layer (Token Handling)\",\n      \"threat_category\": \"Spoofing / Information Disclosure\",\n      \"description\": \"Session tokens or OAuth tokens stored insecurely in localStorage or accessible JS can be stolen via XSS or malicious extensions, enabling account takeover.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use secure, httpOnly cookies with SameSite attributes for session tokens; minimize token lifetime; use token rotation and refresh tokens stored securely; implement strong CSP and XSS mitigations; detect anomalous sessions and revoke tokens.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-004\",\n      \"component\": \"Frontend Layer / External Services (Google OAuth)\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Open redirect or incorrect OAuth redirect URI validation allows attackers to capture authorization codes or tokens via a malicious callback, leading to account takeover.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Strictly validate redirect_uris against allowlist; use PKCE for OAuth flows; verify state parameter and nonce; enforce HTTPS on callback URIs; monitor for abnormal OAuth grant patterns.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-005\",\n      \"component\": \"Edge Layer (CDN/WAF/TLS)\",\n      \"threat_category\": \"Information Disclosure / Tampering\",\n      \"description\": \"TLS termination or CDN misconfiguration (weak ciphers, expired certs, missing HSTS) could allow MitM, protocol downgrade, or data interception between clients and edge.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Enforce strong TLS configuration (TLS1.2+ recommended, prefer 1.3), HSTS, secure certificate lifecycle management, automate renewals, monitor TLS telemetry, enable HTTP Strict Transport Security, and perform periodic TLS scans.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-006\",\n      \"component\": \"Edge Layer (WAF & API Gateway)\",\n      \"threat_category\": \"Tampering / Information Disclosure\",\n      \"description\": \"WAF rule bypass or insufficient WAF rules allow injection payloads (SQLi, XSS) to reach backend; misconfigured gateway could leak internal details via verbose errors.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Implement layered WAF rules including OWASP top 10 protections; use positive allowlists for APIs; sanitize error messages; enable anomaly detection and tuning; use gateway-level request validation and schema checks.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-007\",\n      \"component\": \"Edge Layer (Rate Limiting)\",\n      \"threat_category\": \"Denial of Service\",\n      \"description\": \"Absence or weak rate limiting allows brute-force, enumeration, or abusive polling (e.g., optimizer polling) causing backend overload or service degradation.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Apply per-IP, per-user, and per-endpoint rate limits; exponential backoff; CAPTCHAs for suspicious flows (login); token bucket throttling; protect long-polling endpoints with quotas; monitor metrics and alert on spikes.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-008\",\n      \"component\": \"Application Services - Authentication\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Credential stuffing, weak passwords, or lack of MFA leads to account takeover of ADMIN/MANAGER accounts allowing large-scale damage.\",\n      \"likelihood\": \"High\",\n      \"impact\": \"High\",\n      \"risk_level\": \"Critical\",\n      \"mitigation_strategy\": \"Enforce strong password policies, rate-limit authentication attempts, use account lockouts or adaptive throttling, require MFA for privileged roles, integrate breached-password checks and anomaly detection, encourage SSO (Google) with secure config.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-009\",\n      \"component\": \"Application Services - Password Reset\",\n      \"threat_category\": \"Spoofing / Repudiation\",\n      \"description\": \"Weak or predictable password reset tokens, or emails sent with insufficient verification, allow attackers to reset passwords and take over accounts.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use long, cryptographically secure, single-use tokens with short TTL; bind token to user agent/IP metadata; log and notify users of resets; rate limit reset requests; verify identity for high-privilege resets; avoid leaking account existence info.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-010\",\n      \"component\": \"Application Services - OAuth Integration\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Compromised or replayed OAuth tokens from Google OAuth could be used to impersonate users if token validation is insufficient.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Validate ID token signatures and claims server-side; check token expiry and audience; implement token revocation and rotation; use PKCE and state parameters; map OAuth identities carefully to internal accounts with additional checks for privileged ops.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-011\",\n      \"component\": \"Application Services - RBAC / Multi-tenant Checks\",\n      \"threat_category\": \"Elevation of Privilege\",\n      \"description\": \"Broken access control or insufficient tenant scoping may allow a manager/admin/employee to view or modify data for other companies or elevate privileges.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Implement centralized, fine-grained RBAC and tenant authorization checks on the server side (deny-by-default); perform authorization at every entry point; use automated tests for tenant isolation; include ABAC claims (tenant_id, role) in tokens and validate them server-side.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-012\",\n      \"component\": \"Application Services - Multi-Tenancy\",\n      \"threat_category\": \"Information Disclosure / Tampering\",\n      \"description\": \"Data leakage across tenants due to incorrect SQL queries, shared caches, or improper tenant-scoped identifiers could expose PII and shift data of other companies.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use strict tenant_id scoping in queries, prepared statements, row-level security or separate schemas per tenant if appropriate; segregate caches (prefix keys by tenant_id), encrypt data at rest, review multi-tenant design in threat model.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-013\",\n      \"component\": \"Application Services - Shift APIs / DB Layer\",\n      \"threat_category\": \"Tampering (Injection)\",\n      \"description\": \"SQL injection, NoSQL injection or command injection via poorly validated parameters (search, filtering, sorting) could lead to data theft or corruption.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use parameterized queries/ORMs, input validation and canonicalization, allowlist sorting/filtering fields, use least privilege DB accounts, run SAST and SQLi testing, employ web application firewall rules tailored to injections.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-014\",\n      \"component\": \"Auto-Assignment (Optimizer Orchestration)\",\n      \"threat_category\": \"Tampering / Integrity\",\n      \"description\": \"An attacker could manipulate optimization payloads, acceptance flow, or solver responses (malformed or malicious solution) to force incorrect assignments (e.g., assign unauthorized employees to shifts) or bypass constraints.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Sign and validate payloads and responses; use mutual TLS or API keys with IP allowlisting for Timefold; validate solver results against business rules server-side; sandbox and review solutions; require manager approval for critical changes; maintain an immutable audit trail.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-015\",\n      \"component\": \"Application Services - Background Jobs / Queue\",\n      \"threat_category\": \"Denial of Service / Tampering\",\n      \"description\": \"Queue or job system abuse (poisoned jobs, replayed jobs, or malformed payloads) can cause failures in optimizer orchestration, duplicate processing, or resource exhaustion.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Validate and sanitize queued payloads, enforce max job size and rate limits, implement dead-letter queues and idempotency tokens, use job signing or auth, monitor queue depth and job error rates, and use per-tenant job quotas.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-016\",\n      \"component\": \"Application Services - Audit & Logging\",\n      \"threat_category\": \"Repudiation\",\n      \"description\": \"Insufficient or tamperable audit logs allow malicious actors to erase traces of actions (shift changes, acceptance) or administrators to repudiate actions.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Append-only audit logs, write to immutable storage or WORM-enabled object storage, centralize logs to a managed SIEM, sign or hash log entries, restrict log access, and monitor for log deletion events.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-017\",\n      \"component\": \"Data Layer - Object Storage (Exports/Artifacts)\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Misconfigured S3-like buckets or signed URLs with overly long TTLs could leak CSV/XLSX exports or optimizer artifacts publicly, exposing PII and shift data.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Enforce bucket policies denying public access, use short-lived signed URLs, server-side access control by tenant, encrypt objects at rest, log and monitor object access, and scan object buckets for public exposure.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-018\",\n      \"component\": \"Data Layer - Managed RDBMS\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Database credentials stored insecurely (in code, misconfigured secrets management) or overly-permissive DB accounts allow attackers or insiders to dump tenant data.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use managed secrets (KMS/Secret Manager), rotate credentials regularly, enforce least privilege DB roles, network isolate DB (VPC), enable encryption at rest, enable DB auditing, and use IAM-based auth where available.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-019\",\n      \"component\": \"Data Layer - Backups & Export Files\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Backups, exported CSV/XLSX, or optimizer artifacts containing PII may be retained insecurely or sent to external systems without encryption, leading to data leakage.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Encrypt backups and exports at rest and in transit, restrict access to backups, apply retention and deletion policies, sanitize exports (redact sensitive fields when possible), and log export/download events per tenant.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-020\",\n      \"component\": \"Data Layer - Cache/Session Store (Redis)\",\n      \"threat_category\": \"Spoofing / Information Disclosure\",\n      \"description\": \"Compromise of cache/session store could allow theft of session tokens or tenant-scoped cached data, enabling session hijacking or data leakage.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Network-restrict access to cache (VPC security groups), enable AUTH and TLS on Redis, do not store long-lived secrets in cache, rotate session tokens and invalidate sessions on suspicious activity, isolate keys per tenant, and monitor access.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-021\",\n      \"component\": \"External Services - Timefold Solver Integration\",\n      \"threat_category\": \"Information Disclosure / Tampering\",\n      \"description\": \"Sensitive optimization payloads (employee availability, leave, skills) transmitted to or stored by the external solver may be exposed if the external service is compromised or communication is intercepted.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Minimize sensitive data sent to external solver; use strong transport security (mTLS), enable payload encryption where possible, contractually require security controls from provider, implement data minimization and anonymization, and maintain an audit of payloads sent.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-022\",\n      \"component\": \"External Services - Timefold Solver / Solver Responses\",\n      \"threat_category\": \"Tampering / Elevation of Privilege\",\n      \"description\": \"Malicious or malformed solver responses could instruct the application to create invalid/privileged assignments or bypass constraints if insufficiently validated.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Validate solver outputs against server-side business rules and constraints before applying; require manager acceptance for significant changes; verify score integrity; sandbox parsing logic and implement strict schema validation for responses.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-023\",\n      \"component\": \"External Services - Email Delivery Provider\",\n      \"threat_category\": \"Information Disclosure / Repudiation\",\n      \"description\": \"Compromised email provider or mis-sent transactional emails (password resets, verification) can be used for phishing or account takeover or accidental leakage of PII.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use a reputable provider with security SLAs; sign emails (DKIM/SPF/DMARC), limit PII in emails, use templated safe content, rate-limit mass emails, monitor bounce/reputation, and provide out-of-band verification for critical operations.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-024\",\n      \"component\": \"External Services - Google OAuth Provider\",\n      \"threat_category\": \"Spoofing\",\n      \"description\": \"Compromise of Google OAuth accounts or misconfiguration (improperly mapped accounts) allowing attackers to authenticate as other users or link accounts incorrectly.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Implement verification steps when linking OAuth accounts; check verified email claims; require additional verification for privileged role assignment; detect and alert on suspicious OAuth logins (new IP/geo), and support account unlinking and emergency access removal.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-025\",\n      \"component\": \"External Services - Monitoring & Logging\",\n      \"threat_category\": \"Information Disclosure\",\n      \"description\": \"Sensitive data (PII, tokens) in logs or monitoring metrics sent to third-party services may leak across organizations or be accessible to unauthorized parties.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Redact or mask PII/tokens before sending to logs; use sampling and data minimization; restrict access to monitoring dashboards; apply retention policies; use encryption for logs in transit and at rest.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-026\",\n      \"component\": \"Data Export Feature (CSV/XLSX)\",\n      \"threat_category\": \"Tampering / Information Disclosure\",\n      \"description\": \"Exported spreadsheets containing user-entered fields could include CSV injection (formula injection) or contain sensitive PII unexpectedly; exported files may be downloaded using unsecured links.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Sanitize cell content (prefix ' or use safe formatting to avoid formula execution), require authentication to download, use short-lived signed URLs, perform pre-export redaction options, and log export events per user and tenant.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-027\",\n      \"component\": \"Auto-Assignment (Concurrency)\",\n      \"threat_category\": \"Tampering / Denial of Service\",\n      \"description\": \"Race conditions between auto-assignment job acceptance and manual edits can create duplicate shifts, gaps, or inconsistent state across tenants.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Use transactional operations, optimistic concurrency control (versioning), idempotency tokens for operations, and perform final validation before commit; provide conflict resolution UI and alerting.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-028\",\n      \"component\": \"API Gateway / Frontend Polling (Optimizer Polling)\",\n      \"threat_category\": \"Denial of Service\",\n      \"description\": \"Abuse of real-time polling endpoints (frequent polling for optimization status) can overwhelm backend services, increasing costs and causing outages.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Implement backoff, push mechanisms (WebSockets/Server-Sent Events) with authenticated subscribe, enforce polling rate limits, introduce caching for status, and apply quotas per tenant.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-029\",\n      \"component\": \"Internationalization / Date-Time Handling\",\n      \"threat_category\": \"Tampering / Information Disclosure\",\n      \"description\": \"Locale and timezone misparsing or injection of malformed locale strings could cause incorrect shift calculations, exposing different tenants' data or mis-scheduling employees.\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"Medium\",\n      \"risk_level\": \"Medium\",\n      \"mitigation_strategy\": \"Normalize and validate all locale/timezone inputs against known allowlists, store all times in UTC and render locale-aware only in UI, add unit and integration tests for date conversions, and log unexpected locale values.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    },\n    {\n      \"threat_id\": \"THR-030\",\n      \"component\": \"User Interface (Cookies / Session)\",\n      \"threat_category\": \"Elevation of Privilege\",\n      \"description\": \"XSS or insecure cookie settings allow session cookie theft leading to privilege escalation (e.g., attacker operates as manager/admin).\",\n      \"likelihood\": \"Medium\",\n      \"impact\": \"High\",\n      \"risk_level\": \"High\",\n      \"mitigation_strategy\": \"Use httpOnly and Secure cookies with SameSite attributes, rotate sessions on privilege changes, provide session management UI for users, invalidate sessions on suspicious activity, and enforce MFA for privileged actions.\",\n      \"applicable_controls\": null,\n      \"control_effectiveness\": null,\n      \"residual_risk_level\": null,\n      \"residual_risk_acceptance\": null\n    }\n  ],\n  \"risk_summary\": \"Critical threats center on authentication/authorization failures, multi-tenant isolation errors, and injection/XSS allowing account takeover or cross-tenant data exposure. Attackers' primary entry points are the frontend (XSS, token storage), authentication flows (credential stuffing, OAuth misconfig), the API gateway (injection and WAF bypass), and external integrations (Timefold, email, OAuth). The highest-risk items requiring immediate attention are: (1) XSS leading to session theft (THR-001), (2) credential-based account takeover and lack of MFA for privileged roles (THR-008), (3) broken RBAC / tenant isolation allowing cross-tenant access (THR-011/THR-012), (4) SQL/command injection and WAF bypass (THR-013/THR-006), and (5) leakage of exports/optimizer payloads via misconfigured object storage or external services (THR-017/THR-021). Overall posture is medium-to-high risk until core controls are implemented: robust server-side authorization and tenant scoping, secure authentication (MFA, strong password policy, OAuth hardening), comprehensive input validation and encoding (prevent XSS/SQLi), secure token handling, network and secrets hygiene, and strict controls for third-party integrations. Priorities: implement strong RBAC and tenancy enforcement, fix XSS vectors and switch to httpOnly secure cookies, enable MFA, enforce parameterized queries and WAF rules, harden edge TLS and rate limiting, encrypt and restrict access to backups/exports, and secure external solver integrations with mTLS and payload validation. Regular controls to deploy: threat-aware secure coding, SAST/DAST, fuzzing/testing around date/time/locale handling, blue/green deployments with security gating, incident detection/response capabilities, and contractual + technical risk controls for third-party providers.\"\n}",
      "pydantic": {
        "methodology": "STRIDE",
        "threats": [
          {
            "threat_id": "THR-001",
            "component": "Frontend Layer (SPA) - Calendar & Tables",
            "threat_category": "Information Disclosure / Spoofing",
            "description": "Reflected or stored XSS in UI (calendar, shift preview, user profile) allows an attacker to run JS in another user's session, exfiltrate session tokens, hijack accounts, or perform actions on behalf of the user.",
            "likelihood": "High",
            "impact": "High",
            "risk_level": "Critical",
            "mitigation_strategy": "Enforce output encoding/escaping on all user-supplied content; use a strict Content Security Policy (CSP) with nonces; sanitize inputs server-side and client-side, avoid innerHTML; use frameworks' safe templating; review third-party libs; run regular automated and manual XSS testing (DAST/SAST).",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-002",
            "component": "Frontend Layer & Application Services (Forms & Actions)",
            "threat_category": "Tampering (CSRF)",
            "description": "Cross-Site Request Forgery: authenticated users could be induced to submit state-changing requests (assignments, accept generated shifts) from another origin.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Implement anti-CSRF tokens on state-changing endpoints or use SameSite=strict/strictish cookies for session tokens; require explicit user confirmation for risky ops (e.g., commit auto-assignment); validate Origin/Referer headers; use CORS allowlist.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-003",
            "component": "Frontend Layer (Token Handling)",
            "threat_category": "Spoofing / Information Disclosure",
            "description": "Session tokens or OAuth tokens stored insecurely in localStorage or accessible JS can be stolen via XSS or malicious extensions, enabling account takeover.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use secure, httpOnly cookies with SameSite attributes for session tokens; minimize token lifetime; use token rotation and refresh tokens stored securely; implement strong CSP and XSS mitigations; detect anomalous sessions and revoke tokens.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-004",
            "component": "Frontend Layer / External Services (Google OAuth)",
            "threat_category": "Spoofing",
            "description": "Open redirect or incorrect OAuth redirect URI validation allows attackers to capture authorization codes or tokens via a malicious callback, leading to account takeover.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Strictly validate redirect_uris against allowlist; use PKCE for OAuth flows; verify state parameter and nonce; enforce HTTPS on callback URIs; monitor for abnormal OAuth grant patterns.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-005",
            "component": "Edge Layer (CDN/WAF/TLS)",
            "threat_category": "Information Disclosure / Tampering",
            "description": "TLS termination or CDN misconfiguration (weak ciphers, expired certs, missing HSTS) could allow MitM, protocol downgrade, or data interception between clients and edge.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Enforce strong TLS configuration (TLS1.2+ recommended, prefer 1.3), HSTS, secure certificate lifecycle management, automate renewals, monitor TLS telemetry, enable HTTP Strict Transport Security, and perform periodic TLS scans.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-006",
            "component": "Edge Layer (WAF & API Gateway)",
            "threat_category": "Tampering / Information Disclosure",
            "description": "WAF rule bypass or insufficient WAF rules allow injection payloads (SQLi, XSS) to reach backend; misconfigured gateway could leak internal details via verbose errors.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Implement layered WAF rules including OWASP top 10 protections; use positive allowlists for APIs; sanitize error messages; enable anomaly detection and tuning; use gateway-level request validation and schema checks.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-007",
            "component": "Edge Layer (Rate Limiting)",
            "threat_category": "Denial of Service",
            "description": "Absence or weak rate limiting allows brute-force, enumeration, or abusive polling (e.g., optimizer polling) causing backend overload or service degradation.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Apply per-IP, per-user, and per-endpoint rate limits; exponential backoff; CAPTCHAs for suspicious flows (login); token bucket throttling; protect long-polling endpoints with quotas; monitor metrics and alert on spikes.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-008",
            "component": "Application Services - Authentication",
            "threat_category": "Spoofing",
            "description": "Credential stuffing, weak passwords, or lack of MFA leads to account takeover of ADMIN/MANAGER accounts allowing large-scale damage.",
            "likelihood": "High",
            "impact": "High",
            "risk_level": "Critical",
            "mitigation_strategy": "Enforce strong password policies, rate-limit authentication attempts, use account lockouts or adaptive throttling, require MFA for privileged roles, integrate breached-password checks and anomaly detection, encourage SSO (Google) with secure config.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-009",
            "component": "Application Services - Password Reset",
            "threat_category": "Spoofing / Repudiation",
            "description": "Weak or predictable password reset tokens, or emails sent with insufficient verification, allow attackers to reset passwords and take over accounts.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use long, cryptographically secure, single-use tokens with short TTL; bind token to user agent/IP metadata; log and notify users of resets; rate limit reset requests; verify identity for high-privilege resets; avoid leaking account existence info.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-010",
            "component": "Application Services - OAuth Integration",
            "threat_category": "Spoofing",
            "description": "Compromised or replayed OAuth tokens from Google OAuth could be used to impersonate users if token validation is insufficient.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Validate ID token signatures and claims server-side; check token expiry and audience; implement token revocation and rotation; use PKCE and state parameters; map OAuth identities carefully to internal accounts with additional checks for privileged ops.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-011",
            "component": "Application Services - RBAC / Multi-tenant Checks",
            "threat_category": "Elevation of Privilege",
            "description": "Broken access control or insufficient tenant scoping may allow a manager/admin/employee to view or modify data for other companies or elevate privileges.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Implement centralized, fine-grained RBAC and tenant authorization checks on the server side (deny-by-default); perform authorization at every entry point; use automated tests for tenant isolation; include ABAC claims (tenant_id, role) in tokens and validate them server-side.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-012",
            "component": "Application Services - Multi-Tenancy",
            "threat_category": "Information Disclosure / Tampering",
            "description": "Data leakage across tenants due to incorrect SQL queries, shared caches, or improper tenant-scoped identifiers could expose PII and shift data of other companies.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use strict tenant_id scoping in queries, prepared statements, row-level security or separate schemas per tenant if appropriate; segregate caches (prefix keys by tenant_id), encrypt data at rest, review multi-tenant design in threat model.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-013",
            "component": "Application Services - Shift APIs / DB Layer",
            "threat_category": "Tampering (Injection)",
            "description": "SQL injection, NoSQL injection or command injection via poorly validated parameters (search, filtering, sorting) could lead to data theft or corruption.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use parameterized queries/ORMs, input validation and canonicalization, allowlist sorting/filtering fields, use least privilege DB accounts, run SAST and SQLi testing, employ web application firewall rules tailored to injections.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-014",
            "component": "Auto-Assignment (Optimizer Orchestration)",
            "threat_category": "Tampering / Integrity",
            "description": "An attacker could manipulate optimization payloads, acceptance flow, or solver responses (malformed or malicious solution) to force incorrect assignments (e.g., assign unauthorized employees to shifts) or bypass constraints.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Sign and validate payloads and responses; use mutual TLS or API keys with IP allowlisting for Timefold; validate solver results against business rules server-side; sandbox and review solutions; require manager approval for critical changes; maintain an immutable audit trail.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-015",
            "component": "Application Services - Background Jobs / Queue",
            "threat_category": "Denial of Service / Tampering",
            "description": "Queue or job system abuse (poisoned jobs, replayed jobs, or malformed payloads) can cause failures in optimizer orchestration, duplicate processing, or resource exhaustion.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Validate and sanitize queued payloads, enforce max job size and rate limits, implement dead-letter queues and idempotency tokens, use job signing or auth, monitor queue depth and job error rates, and use per-tenant job quotas.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-016",
            "component": "Application Services - Audit & Logging",
            "threat_category": "Repudiation",
            "description": "Insufficient or tamperable audit logs allow malicious actors to erase traces of actions (shift changes, acceptance) or administrators to repudiate actions.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Append-only audit logs, write to immutable storage or WORM-enabled object storage, centralize logs to a managed SIEM, sign or hash log entries, restrict log access, and monitor for log deletion events.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-017",
            "component": "Data Layer - Object Storage (Exports/Artifacts)",
            "threat_category": "Information Disclosure",
            "description": "Misconfigured S3-like buckets or signed URLs with overly long TTLs could leak CSV/XLSX exports or optimizer artifacts publicly, exposing PII and shift data.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Enforce bucket policies denying public access, use short-lived signed URLs, server-side access control by tenant, encrypt objects at rest, log and monitor object access, and scan object buckets for public exposure.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-018",
            "component": "Data Layer - Managed RDBMS",
            "threat_category": "Information Disclosure",
            "description": "Database credentials stored insecurely (in code, misconfigured secrets management) or overly-permissive DB accounts allow attackers or insiders to dump tenant data.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use managed secrets (KMS/Secret Manager), rotate credentials regularly, enforce least privilege DB roles, network isolate DB (VPC), enable encryption at rest, enable DB auditing, and use IAM-based auth where available.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-019",
            "component": "Data Layer - Backups & Export Files",
            "threat_category": "Information Disclosure",
            "description": "Backups, exported CSV/XLSX, or optimizer artifacts containing PII may be retained insecurely or sent to external systems without encryption, leading to data leakage.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Encrypt backups and exports at rest and in transit, restrict access to backups, apply retention and deletion policies, sanitize exports (redact sensitive fields when possible), and log export/download events per tenant.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-020",
            "component": "Data Layer - Cache/Session Store (Redis)",
            "threat_category": "Spoofing / Information Disclosure",
            "description": "Compromise of cache/session store could allow theft of session tokens or tenant-scoped cached data, enabling session hijacking or data leakage.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Network-restrict access to cache (VPC security groups), enable AUTH and TLS on Redis, do not store long-lived secrets in cache, rotate session tokens and invalidate sessions on suspicious activity, isolate keys per tenant, and monitor access.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-021",
            "component": "External Services - Timefold Solver Integration",
            "threat_category": "Information Disclosure / Tampering",
            "description": "Sensitive optimization payloads (employee availability, leave, skills) transmitted to or stored by the external solver may be exposed if the external service is compromised or communication is intercepted.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Minimize sensitive data sent to external solver; use strong transport security (mTLS), enable payload encryption where possible, contractually require security controls from provider, implement data minimization and anonymization, and maintain an audit of payloads sent.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-022",
            "component": "External Services - Timefold Solver / Solver Responses",
            "threat_category": "Tampering / Elevation of Privilege",
            "description": "Malicious or malformed solver responses could instruct the application to create invalid/privileged assignments or bypass constraints if insufficiently validated.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Validate solver outputs against server-side business rules and constraints before applying; require manager acceptance for significant changes; verify score integrity; sandbox parsing logic and implement strict schema validation for responses.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-023",
            "component": "External Services - Email Delivery Provider",
            "threat_category": "Information Disclosure / Repudiation",
            "description": "Compromised email provider or mis-sent transactional emails (password resets, verification) can be used for phishing or account takeover or accidental leakage of PII.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use a reputable provider with security SLAs; sign emails (DKIM/SPF/DMARC), limit PII in emails, use templated safe content, rate-limit mass emails, monitor bounce/reputation, and provide out-of-band verification for critical operations.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-024",
            "component": "External Services - Google OAuth Provider",
            "threat_category": "Spoofing",
            "description": "Compromise of Google OAuth accounts or misconfiguration (improperly mapped accounts) allowing attackers to authenticate as other users or link accounts incorrectly.",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Implement verification steps when linking OAuth accounts; check verified email claims; require additional verification for privileged role assignment; detect and alert on suspicious OAuth logins (new IP/geo), and support account unlinking and emergency access removal.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-025",
            "component": "External Services - Monitoring & Logging",
            "threat_category": "Information Disclosure",
            "description": "Sensitive data (PII, tokens) in logs or monitoring metrics sent to third-party services may leak across organizations or be accessible to unauthorized parties.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Redact or mask PII/tokens before sending to logs; use sampling and data minimization; restrict access to monitoring dashboards; apply retention policies; use encryption for logs in transit and at rest.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-026",
            "component": "Data Export Feature (CSV/XLSX)",
            "threat_category": "Tampering / Information Disclosure",
            "description": "Exported spreadsheets containing user-entered fields could include CSV injection (formula injection) or contain sensitive PII unexpectedly; exported files may be downloaded using unsecured links.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Sanitize cell content (prefix ' or use safe formatting to avoid formula execution), require authentication to download, use short-lived signed URLs, perform pre-export redaction options, and log export events per user and tenant.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-027",
            "component": "Auto-Assignment (Concurrency)",
            "threat_category": "Tampering / Denial of Service",
            "description": "Race conditions between auto-assignment job acceptance and manual edits can create duplicate shifts, gaps, or inconsistent state across tenants.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Use transactional operations, optimistic concurrency control (versioning), idempotency tokens for operations, and perform final validation before commit; provide conflict resolution UI and alerting.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-028",
            "component": "API Gateway / Frontend Polling (Optimizer Polling)",
            "threat_category": "Denial of Service",
            "description": "Abuse of real-time polling endpoints (frequent polling for optimization status) can overwhelm backend services, increasing costs and causing outages.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Implement backoff, push mechanisms (WebSockets/Server-Sent Events) with authenticated subscribe, enforce polling rate limits, introduce caching for status, and apply quotas per tenant.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-029",
            "component": "Internationalization / Date-Time Handling",
            "threat_category": "Tampering / Information Disclosure",
            "description": "Locale and timezone misparsing or injection of malformed locale strings could cause incorrect shift calculations, exposing different tenants' data or mis-scheduling employees.",
            "likelihood": "Medium",
            "impact": "Medium",
            "risk_level": "Medium",
            "mitigation_strategy": "Normalize and validate all locale/timezone inputs against known allowlists, store all times in UTC and render locale-aware only in UI, add unit and integration tests for date conversions, and log unexpected locale values.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          },
          {
            "threat_id": "THR-030",
            "component": "User Interface (Cookies / Session)",
            "threat_category": "Elevation of Privilege",
            "description": "XSS or insecure cookie settings allow session cookie theft leading to privilege escalation (e.g., attacker operates as manager/admin).",
            "likelihood": "Medium",
            "impact": "High",
            "risk_level": "High",
            "mitigation_strategy": "Use httpOnly and Secure cookies with SameSite attributes, rotate sessions on privilege changes, provide session management UI for users, invalidate sessions on suspicious activity, and enforce MFA for privileged actions.",
            "applicable_controls": null,
            "control_effectiveness": null,
            "residual_risk_level": null,
            "residual_risk_acceptance": null
          }
        ],
        "risk_summary": "Critical threats center on authentication/authorization failures, multi-tenant isolation errors, and injection/XSS allowing account takeover or cross-tenant data exposure. Attackers' primary entry points are the frontend (XSS, token storage), authentication flows (credential stuffing, OAuth misconfig), the API gateway (injection and WAF bypass), and external integrations (Timefold, email, OAuth). The highest-risk items requiring immediate attention are: (1) XSS leading to session theft (THR-001), (2) credential-based account takeover and lack of MFA for privileged roles (THR-008), (3) broken RBAC / tenant isolation allowing cross-tenant access (THR-011/THR-012), (4) SQL/command injection and WAF bypass (THR-013/THR-006), and (5) leakage of exports/optimizer payloads via misconfigured object storage or external services (THR-017/THR-021). Overall posture is medium-to-high risk until core controls are implemented: robust server-side authorization and tenant scoping, secure authentication (MFA, strong password policy, OAuth hardening), comprehensive input validation and encoding (prevent XSS/SQLi), secure token handling, network and secrets hygiene, and strict controls for third-party integrations. Priorities: implement strong RBAC and tenancy enforcement, fix XSS vectors and switch to httpOnly secure cookies, enable MFA, enforce parameterized queries and WAF rules, harden edge TLS and rate limiting, encrypt and restrict access to backups/exports, and secure external solver integrations with mTLS and payload validation. Regular controls to deploy: threat-aware secure coding, SAST/DAST, fuzzing/testing around date/time/locale handling, blue/green deployments with security gating, incident detection/response capabilities, and contractual + technical risk controls for third-party providers."
      }
    }
  ]
}