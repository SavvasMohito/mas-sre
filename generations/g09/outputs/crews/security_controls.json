{
  "raw": "{\n  \"requirements_mapping\": [\n    {\n      \"high_level_requirement\": \"User registration with email verification and account lifecycle management\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.1\",\n          \"chapter\": \"Authentication Verification\",\n          \"section\": \"Account Creation and Verification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify new user registrations via email or other out-of-band mechanisms to ensure account ownership.\",\n          \"relevance\": \"Directly addresses the need to confirm user ownership of email accounts during registration and reduces fraudulent account creation. It maps to the verification and lifecycle control aspects of the requirement.\",\n          \"integration_tips\": \"Implement email confirmation tokens that are single-use and time-limited; require confirmation before enabling privileged features. Tie the verification status to account state in the user lifecycle management flows.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review implementation of email verification flow, inspect token properties (single-use, expiry), and test account behavior before and after verification.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-2\",\n          \"chapter\": \"Account Management\",\n          \"section\": \"Account Lifecycle\",\n          \"level\": null,\n          \"requirement\": \"The organization manages information system accounts, including account creation, enablement, modification, disabling, and removal.\",\n          \"relevance\": \"Specifies lifecycle operations which map to registration, activation, suspension, and removal of user accounts required by the feature.\",\n          \"integration_tips\": \"Establish automated workflows and approval steps for account creation and deactivation; maintain authoritative records of account states and reason codes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Audit account management procedures, review logs of account create/disable/delete events, and verify policy enforcement through test cases.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.1\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"User registration and de-registration\",\n          \"level\": null,\n          \"requirement\": \"A formal user registration and de-registration process shall be implemented to enable assignment of access rights.\",\n          \"relevance\": \"Mandates a formal process for onboarding/offboarding which ensures registration ties into access rights and lifecycle.\",\n          \"integration_tips\": \"Document procedures for registration and de-registration, include steps for verification, approvals, and role assignment during onboarding/offboarding.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect documented procedures and sample records for adherence; validate that de-registration revokes access promptly.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-5\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Authenticator Management\",\n          \"level\": null,\n          \"requirement\": \"Manage, distribute, and revoke credentials and authenticators throughout the account lifecycle.\",\n          \"relevance\": \"Addresses credential issuance and revocation tied to account lifecycle which complements email verification and lifecycle management.\",\n          \"integration_tips\": \"Implement credential issuance policies, track authenticator provenance, and ensure revocation paths (e.g., when email changes or accounts disabled).\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review credential lifecycle processes, test revocation and re-issuance flows, and inspect logs for authenticator events.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Authentication and single sign-on via credentials and Google OAuth\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.2\",\n          \"chapter\": \"Authentication Verification\",\n          \"section\": \"Credential & Third-party Authentication\",\n          \"level\": \"L2\",\n          \"requirement\": \"Support secure authentication including credential-based and federated authentication (OAuth2, OpenID Connect) with proper validation and token handling.\",\n          \"relevance\": \"Directly covers secure handling of credential-based login and federated SSO (Google OAuth) required by the requirement.\",\n          \"integration_tips\": \"Use well-vetted OAuth2/OpenID Connect libraries, validate ID tokens server-side, enforce scopes and claims, and handle token storage securely.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review OAuth/OIDC implementation, verify token validation, scope restrictions, and perform token replay/forgery tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-2\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Identification and Authentication (Organizational Users)\",\n          \"level\": null,\n          \"requirement\": \"Identify and authenticate organizational users using authenticators and, where appropriate, federated identity mechanisms.\",\n          \"relevance\": \"Provides organizational control guidance for authenticating users via both local credentials and federated providers like Google.\",\n          \"integration_tips\": \"Define acceptable authenticators, document trust relationships with identity providers, and require secure channels for federation.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Examine policies for federated identity, test SSO flows for proper authentication, and verify credential handling meets organizational standards.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.2\",\n          \"chapter\": \"System and Application Access Control\",\n          \"section\": \"Secure log-on procedures\",\n          \"level\": null,\n          \"requirement\": \"Secure log-on procedures shall be implemented, where appropriate supporting single sign-on and federated identity.\",\n          \"relevance\": \"Requires secure log-on procedures and supports SSO, aligning with the need for secure Google OAuth integration.\",\n          \"integration_tips\": \"Implement SSO with secure session establishment, multi-factor option where required, and maintain centralized session policies.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Validate the log-on workflow, verify session creation after SSO, and review session timeout and logout behavior.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.3\",\n          \"chapter\": \"Session Management\",\n          \"section\": \"OAuth and Token Handling\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure tokens are validated, scoped, stored securely, and revoked when necessary for SSO and OAuth use-cases.\",\n          \"relevance\": \"Covers secure token lifecycle for SSO, ensuring tokens from Google are handled safely and revocable.\",\n          \"integration_tips\": \"Use secure token storage (HTTP-only cookies or secure token stores), implement token revocation and rotation, and minimize token scopes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect token storage methods, test revocation and refresh flows, and review scope requests during OAuth handshake.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Password reset and account recovery\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.3\",\n          \"chapter\": \"Authentication Verification\",\n          \"section\": \"Password Reset & Account Recovery\",\n          \"level\": \"L1\",\n          \"requirement\": \"Implement secure password reset flows using verified contact channels and protections against account takeover (OTP, expiring tokens, rate limiting).\",\n          \"relevance\": \"Directly maps to the need for secure password reset flows and protections against abuse or account takeover.\",\n          \"integration_tips\": \"Use single-use, short-lived reset tokens delivered via verified channels, add rate limiting and anomaly detection on reset attempts.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test reset flows for token reuse, expiry, and ensure resets require verified contact; perform abuse-case testing.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-5 (5)\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Password and Recovery Credential Management\",\n          \"level\": null,\n          \"requirement\": \"Establish policies and mechanisms for managing password resets and recovery in a manner that resists credential compromise.\",\n          \"relevance\": \"Provides organizational expectations for secure recovery procedures to reduce risk of credential compromise.\",\n          \"integration_tips\": \"Document recovery procedures, require multi-step verification for high-risk account changes, and log recovery events for auditing.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review recovery policies, validate multi-step verification for sensitive accounts, and inspect logs of recovery events.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.1\",\n          \"chapter\": \"Session Management\",\n          \"section\": \"One-time tokens and recovery tokens\",\n          \"level\": \"L2\",\n          \"requirement\": \"Recovery tokens and one-time use links must be single-use, short-lived, and protected against replay attacks.\",\n          \"relevance\": \"Specifies properties of recovery tokens which mitigate replay and abuse in password reset flows.\",\n          \"integration_tips\": \"Implement cryptographically-random tokens, mark tokens used after redemption, and expire tokens quickly (e.g., 15 minutes).\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect token generation and storage, attempt token replay tests, and verify expiry enforcement.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.3\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"Management of privileged access rights\",\n          \"level\": null,\n          \"requirement\": \"Ensure controlled management of authentication data and password resets, including policies and procedures.\",\n          \"relevance\": \"Supports governance over reset and recovery processes to prevent misuse, particularly for privileged accounts.\",\n          \"integration_tips\": \"Apply stricter reset controls for privileged roles, require manual approvals where appropriate, and log privileged resets.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review privileged reset controls, sampling of privileged account reset logs, and policy documentation.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Role-based access control (ADMIN, MANAGER, EMPLOYEE) and user status management\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.1\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Role-based Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Enforce role-based access control with least privilege and separation of duties; implement role checks on both client and server sides.\",\n          \"relevance\": \"Directly prescribes RBAC enforcement necessary for ADMIN/MANAGER/EMPLOYEE roles and ensures server-side enforcement to prevent privilege escalation.\",\n          \"integration_tips\": \"Centralize role checks in authorization middleware, enforce least privilege for each role, and prevent client-side-only enforcement.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review role definitions, test access control enforcement across endpoints for each role, and perform privilege escalation attempts.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-3\",\n          \"chapter\": \"Access Enforcement\",\n          \"section\": \"Access Control Policy and Enforcement\",\n          \"level\": null,\n          \"requirement\": \"Enforce access restrictions and ensure users are granted access only to authorized functions and data.\",\n          \"relevance\": \"Mandates access enforcement which supports role-based controls and status-based access (active/disabled/suspended).\",\n          \"integration_tips\": \"Implement centralized access control checks, map roles to permissions, and enforce account status checks before granting access.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect policy-to-implementation mapping, run access matrix tests, and verify that disabled users cannot access resources.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.1.2\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"Access Control Policy\",\n          \"level\": null,\n          \"requirement\": \"An access control policy based on business and security requirements shall be established, documented, and reviewed.\",\n          \"relevance\": \"Requires documented access control policies to define role responsibilities and status management.\",\n          \"integration_tips\": \"Create and maintain an access control policy describing roles, permissions, and lifecycle procedures; align with HR onboarding/offboarding.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review access control policy documentation and interview personnel to confirm implementation.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-2 (3)\",\n          \"chapter\": \"Account Management\",\n          \"section\": \"Account Status and Automation\",\n          \"level\": null,\n          \"requirement\": \"Automate account status changes (enable/disable) and maintain authoritative account state.\",\n          \"relevance\": \"Supports user status management by prescribing automation and authoritative state control to prevent orphaned or active-but-disabled accounts.\",\n          \"integration_tips\": \"Integrate with HR systems for status changes, implement automated disabling for inactivity or termination, and record change reasons.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit automation integrations, simulate HR-driven status changes, and verify system enforces new statuses immediately.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User profile management and company assignment\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.6\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Authorization for Profile and Resource Assignment\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that updates to user profiles and assignments (e.g., company membership) are protected by server-side authorization checks.\",\n          \"relevance\": \"Directly addresses the need to protect profile updates and company assignments from unauthorized changes.\",\n          \"integration_tips\": \"Enforce server-side permission checks tied to role and ownership; validate company assignment changes against authoritative sources.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review code paths for profile update endpoints, perform unauthorized modification tests, and inspect audit logs.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6\",\n          \"chapter\": \"Least Privilege\",\n          \"section\": \"Least Privilege and Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"Employ least privilege mechanisms for user profile updates and assignment of organizational attributes.\",\n          \"relevance\": \"Ensures only authorized personnel or processes can assign users to companies or alter profile attributes, reducing risk of misuse.\",\n          \"integration_tips\": \"Assign minimal privileges to services and operators that manage profile/company attributes and require approvals for sensitive changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check privilege assignments for profile-management components and test unauthorized assignment attempts.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.2\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"User access provisioning\",\n          \"level\": null,\n          \"requirement\": \"A formal process for granting and revoking access rights and attributes should be followed, including assignment to organizational units.\",\n          \"relevance\": \"Requires formal provisioning processes which should include company assignment and profile attribute handling.\",\n          \"integration_tips\": \"Implement provisioning workflows with approvals and record keeping, and enforce verification of company membership during assignment.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review provisioning records and test the end-to-end process for correctness and auditability.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.1\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Trust Boundaries and Multi-tenancy\",\n          \"level\": \"L2\",\n          \"requirement\": \"Design systems to maintain clear trust boundaries so profile attributes that determine access are authoritative and validated.\",\n          \"relevance\": \"Ensures profile attributes like company assignment are authoritative and cannot be spoofed to gain access across boundaries.\",\n          \"integration_tips\": \"Store canonical profile attributes in a trusted service or database, and validate tokens/claims used to assert company membership.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect trust boundary design, review data flow diagrams, and test for attribute spoofing.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Company CRUD and multi-tenant scoping of data\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V14.1\",\n          \"chapter\": \"Multi-Tenancy\",\n          \"section\": \"Tenant Isolation and Data Separation\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure logical separation of tenant data and enforce access controls to prevent cross-tenant data leakage.\",\n          \"relevance\": \"Directly addresses multi-tenant scoping and the need to prevent cross-company data access when performing CRUD operations.\",\n          \"integration_tips\": \"Enforce tenant checks at data access layer and include tenant_id in every query predicate; implement row-level security where possible.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review data access code, run multi-tenant isolation tests (attempt cross-tenant reads/writes), and inspect database policies.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-7\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Boundary Protection\",\n          \"level\": null,\n          \"requirement\": \"Implement controls to separate and protect system components and data flows; apply isolation as necessary.\",\n          \"relevance\": \"Supports the requirement to protect and isolate tenant data by prescribing boundary and isolation controls.\",\n          \"integration_tips\": \"Segment logical components by tenant boundaries, apply network and access controls for management interfaces, and minimize shared state.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Assess architecture diagrams, test separation of management interfaces, and review network segmentation controls.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.13.2.1\",\n          \"chapter\": \"Communications Security\",\n          \"section\": \"Information transfer policies and procedures\",\n          \"level\": null,\n          \"requirement\": \"Information transfer and segregation mechanisms should be defined to protect the exchange and separation of information between entities.\",\n          \"relevance\": \"Requires documented segregation mechanisms relevant to multi-tenant CRUD operations and data transfer between tenants.\",\n          \"integration_tips\": \"Document transfer policies, implement enforcement controls for inter-tenant transfers, and require approvals for cross-tenant data export.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review policy documents and sample transfer approvals; test that transfers are blocked or logged when not permitted.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6 (10)\",\n          \"chapter\": \"Least Privilege\",\n          \"section\": \"Tenant-specific Access Controls\",\n          \"level\": null,\n          \"requirement\": \"Apply tenant-specific access restrictions and scoping to limit access to tenant resources.\",\n          \"relevance\": \"Specifies tailoring of least-privilege controls to tenant-specific resources which is essential for company CRUD scoping.\",\n          \"integration_tips\": \"Map permissions to tenant-scoped roles, implement enforcement in APIs and DB, and maintain per-tenant admin scopes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Verify per-tenant role mappings, test scoped permissions, and run negative tests attempting cross-tenant CRUD.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Shift type management with time ranges and required skills\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.3\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Data Validation and Business Logic Integrity\",\n          \"level\": \"L1\",\n          \"requirement\": \"Validate business input (e.g., time ranges, required skills) server-side to prevent logic abuse and ensure data integrity.\",\n          \"relevance\": \"Protects shift-type definitions from malformed or malicious inputs that could break scheduling logic or grant unauthorized capabilities.\",\n          \"integration_tips\": \"Implement strict server-side validation for time ranges, enforce constraints (no overlap, valid skill IDs), and canonicalize inputs.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review validation code, perform fuzzing of time/skill inputs, and check DB for invalid persisted records.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"Information Integrity\",\n          \"section\": \"Input Validation and Integrity Verification\",\n          \"level\": null,\n          \"requirement\": \"Employ integrity checks and input validation to ensure data consistency and correctness.\",\n          \"relevance\": \"Ensures integrity of shift-type data and supports detection of tampering or corruption.\",\n          \"integration_tips\": \"Apply schema validation, integrity checksums where necessary, and enforce business rule validation in services.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect schema validations, run integrity checks in test harness, and verify constraints via unit tests.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.2\",\n          \"chapter\": \"Operational Procedures and Responsibilities\",\n          \"section\": \"Change Management and Data Integrity\",\n          \"level\": null,\n          \"requirement\": \"Changes to systems and data (including configuration of business objects like shift types) should be controlled to preserve integrity.\",\n          \"relevance\": \"Requires controlled change processes for shift-type configurations to prevent unauthorized or erroneous changes.\",\n          \"integration_tips\": \"Use controlled deployment/change processes for shift-type schema or rule changes, include review/approval steps for business-impacting changes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review change records for shift-type modifications and check that approvals were captured.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V6.4\",\n          \"chapter\": \"Business Logic\",\n          \"section\": \"Enforce Business Rules\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure business logic (e.g., required skills per shift type) is enforced server-side and cannot be bypassed by client manipulation.\",\n          \"relevance\": \"Directly ensures shift-type business rules are enforced server-side to prevent client-side tampering.\",\n          \"integration_tips\": \"Centralize business rules in service layer, implement tests for rule enforcement, and prevent direct DB writes that bypass logic.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt to bypass rules via direct API/DB calls and validate server rejects inconsistent or unauthorized changes.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Manual shift creation, update, deletion, and calendar presentation\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.4\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Authorization for Data Modification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Authorize all modification endpoints and verify checks server-side to prevent unauthorized creation, update, or deletion.\",\n          \"relevance\": \"Ensures only authorized users can create/update/delete shifts, which is central to manual shift management.\",\n          \"integration_tips\": \"Protect endpoints via role checks and ownership checks; ensure calendar UI actions invoke server-side authorization.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test role-based access to create/update/delete endpoints, and attempt unauthorized operations.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"Determine and log auditable events including create, modify, delete operations.\",\n          \"relevance\": \"Records manual shift changes for accountability and incident investigation as required by the feature.\",\n          \"integration_tips\": \"Log change events with user, timestamp, before/after state and reason; protect logs from tampering.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review audit logs for shift CRUD events and validate completeness and integrity.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Event Logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities, exceptions, and security events shall be produced and retained.\",\n          \"relevance\": \"Mandates retaining logs for manual shift operations and UI interactions for compliance and troubleshooting.\",\n          \"integration_tips\": \"Define retention periods, ensure secure storage, and include calendar-related events as auditable actions.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect logs for the required events, retention configuration, and access controls around logs.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6\",\n          \"chapter\": \"Least Privilege\",\n          \"section\": \"Enforce least privilege on modification endpoints\",\n          \"level\": null,\n          \"requirement\": \"Restrict modify/delete/create operations to roles with explicit permissions.\",\n          \"relevance\": \"Supports limiting who may perform manual shift operations to defined roles, reducing misuse risk.\",\n          \"integration_tips\": \"Map CRUD permissions to ADMIN/MANAGER roles and apply checks in API and UI layers.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review permission mappings and test that lower-privileged roles cannot modify shifts.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Shift status tracking and filtering (SCHEDULED, CONFIRMED, COMPLETED, CANCELLED, NO_SHOW)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-6\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Review, Analysis, and Reporting\",\n          \"level\": null,\n          \"requirement\": \"Regularly review and analyze audit records for indications of unauthorized activity or changes.\",\n          \"relevance\": \"Encourages review of status transitions to detect unauthorized or anomalous status changes such as NO_SHOW flags being manipulated.\",\n          \"integration_tips\": \"Log status transitions with actor and context, implement periodic reviews and alerts for unusual patterns.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review audit processes, sample status transition logs, and ensure alerts are configured for anomalies.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.1\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Tamper-resistant Logging\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure logs and status transitions are recorded in tamper-resistant logs and integrity-protected storage.\",\n          \"relevance\": \"Protects the integrity of status history to provide trustworthy records for scheduling outcomes.\",\n          \"integration_tips\": \"Use append-only logs or secure log storage with integrity checks and restrict log modification privileges.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect log storage protections and attempt to modify logs; verify detection of tamper attempts.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.3\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Administrator and Operator Logs\",\n          \"level\": null,\n          \"requirement\": \"Administrator and operator activities, including status changes, should be logged and reviewed.\",\n          \"relevance\": \"Mandates logging of operator actions affecting shift statuses to maintain accountability.\",\n          \"integration_tips\": \"Capture operator ID and reason for manual status changes, and include review procedures for sensitive transitions.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check logs for operator entries and review processes for manual status changes.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"CM-3\",\n          \"chapter\": \"Configuration Management\",\n          \"section\": \"Configuration Change Control\",\n          \"level\": null,\n          \"requirement\": \"Control and document changes to system configuration and state transitions.\",\n          \"relevance\": \"Ensures system state transitions for shift statuses are controlled and documented, preventing unauthorized state changes.\",\n          \"integration_tips\": \"Treat status transition rules as configuration items, version them, and require approvals for rule changes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review change records for status transition rule updates and verify approvals were enforced.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Automated shift assignment (auto-assignment) via external solver with preview and accept/reject\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V13.1\",\n          \"chapter\": \"API Security\",\n          \"section\": \"Secure API Consumption and Third-party Integration\",\n          \"level\": \"L2\",\n          \"requirement\": \"Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.\",\n          \"relevance\": \"Applies to integrating with external solver for auto-assignment and ensuring previews and accepts/rejects are securely transmitted and validated.\",\n          \"integration_tips\": \"Use mutual TLS or OAuth for API calls, validate solver responses before applying changes, and implement signed payloads or record hashes for integrity.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review API authentication configuration, test injection or malformed response handling, and verify server validates solver outputs.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SA-9\",\n          \"chapter\": \"System and Services Acquisition\",\n          \"section\": \"External System Interactions and API Security\",\n          \"level\": null,\n          \"requirement\": \"Ensure that external interfaces are secured and that integration with external systems follows organizational policies.\",\n          \"relevance\": \"Mandates governance around external solver usage and how solver results are accepted into the system.\",\n          \"integration_tips\": \"Define security requirements in supplier agreements, document expected APIs, and ensure change management for solver integration.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review supplier contracts, interface security documentation, and test compliance with the defined integration policy.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.15.1.1\",\n          \"chapter\": \"Supplier Relationships\",\n          \"section\": \"Information Security in Supplier Relationships\",\n          \"level\": null,\n          \"requirement\": \"Establish controls for supplier relationships including security requirements for shared data and interfaces.\",\n          \"relevance\": \"Supports contractual and security requirements for using an external solver service for assignments.\",\n          \"integration_tips\": \"Include SLAs and security requirements in supplier agreements, require proof of secure handling, and define incident responsibilities.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect supplier agreements and evidence of supplier security practices and audits.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-8\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Transmission Confidentiality and Integrity\",\n          \"level\": null,\n          \"requirement\": \"Protect the confidentiality and integrity of information during transmission to external services.\",\n          \"relevance\": \"Ensures solver payloads and returned solutions are transmitted securely to prevent tampering or eavesdropping.\",\n          \"integration_tips\": \"Use TLS with strong ciphers, enforce certificate validation, and consider payload signing for end-to-end integrity.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect TLS configuration, perform MITM tests, and verify payload signatures if implemented.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Real-time asynchronous job processing, polling, and solution status tracking\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-13\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Use of Cryptography\",\n          \"level\": null,\n          \"requirement\": \"Use cryptography to protect data in transit and at rest in asynchronous messaging systems.\",\n          \"relevance\": \"Secures messages and job payloads in transit and at rest as they move through job queues and polling endpoints.\",\n          \"integration_tips\": \"Encrypt messages in transit with TLS and at rest with appropriate encryption keys; protect queue access with authentication.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review encryption configurations for queues and endpoints, and test interception attempts.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V14.3\",\n          \"chapter\": \"Backend and Infrastructure\",\n          \"section\": \"Secure Asynchronous Processing\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure job queues and background processing components enforce authentication, authorization, and message validation.\",\n          \"relevance\": \"Specifies securing job processing elements to ensure only authorized jobs are enqueued/processed and status updates are validated.\",\n          \"integration_tips\": \"Authenticate producers/consumers, validate job payloads schema, and authorize status-change operations based on role.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect queue ACLs, test unauthorized enqueue/dequeue attempts, and validate payload schema checks.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.1\",\n          \"chapter\": \"Operational Procedures\",\n          \"section\": \"Documented operating procedures for operations including job processing\",\n          \"level\": null,\n          \"requirement\": \"Operational procedures should define and control background processing and message handling.\",\n          \"relevance\": \"Mandates documented procedures around real-time job processing and polling operations.\",\n          \"integration_tips\": \"Document job lifecycle, polling intervals, retry limits, and error handling; include operational runbooks for failures.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review operational procedures and perform runbook drills to validate behavior.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-7\",\n          \"chapter\": \"Software, Firmware, and Information Integrity\",\n          \"section\": \"Integrity Check Mechanisms\",\n          \"level\": null,\n          \"requirement\": \"Implement integrity checks for data processed asynchronously to detect tampering or corruption.\",\n          \"relevance\": \"Ensures the integrity of solutions and job payloads is verifiable during the asynchronous processing lifecycle.\",\n          \"integration_tips\": \"Include checksums, signatures, or message authentication codes (MACs) on job payloads and verify them before processing.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect integrity verification code paths and attempt to submit tampered payloads to confirm detection.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Solution scoring, constraint violation analysis, and reporting\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V11.2\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Algorithmic Transparency and Audit Trails\",\n          \"level\": \"L2\",\n          \"requirement\": \"Log inputs, configuration, and outputs of automated decision algorithms to support auditing and explainability.\",\n          \"relevance\": \"Directly applies to capturing evidence of scoring and constraint violations for review and dispute resolution.\",\n          \"integration_tips\": \"Record solver inputs, scoring parameters, and output diffs; store logs securely with access controls for auditors.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check that algorithmic inputs/outputs are logged and can be correlated to user-visible reports.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PM-22\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Algorithmic Accountability\",\n          \"level\": null,\n          \"requirement\": \"Document and analyze how automated solutions are validated, scored, and how violations are reported.\",\n          \"relevance\": \"Mandates documentation and governance around automated scoring which supports trustworthy reporting.\",\n          \"integration_tips\": \"Maintain documentation of scoring methodology, test datasets, and validation results; define reporting formats and owners.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review documentation and validation artifacts and confirm reporting pipelines produce expected outputs.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.\",\n          \"relevance\": \"Ensures scoring and reporting practices comply with privacy and regulatory requirements, especially if personal data influences scores.\",\n          \"integration_tips\": \"Assess privacy impacts of scoring data, avoid unnecessary personal data in scoring logs, and provide explanations where decisions affect individuals.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review privacy assessments and validate that logs/reporting exclude unnecessary personal data or are appropriately protected.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-12\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Generation\",\n          \"level\": null,\n          \"requirement\": \"Generate audit records for security-relevant events including algorithm outputs and violations.\",\n          \"relevance\": \"Ensures scoring and violation events are auditable and recorded for security/review purposes.\",\n          \"integration_tips\": \"Define which scoring events are auditable, include identifiers correlating to inputs, and protect audit logs from tampering.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect audit logs for scoring events and test correlation between algorithm runs and generated logs.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Shift preferences management (date-specific desired/undesired) and preference tracking\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.\",\n          \"relevance\": \"Preferences may be personal data; this control ensures processing complies with privacy requirements and is documented.\",\n          \"integration_tips\": \"Limit retention of preference data, document how preferences are used in automated assignment, and expose preference reports for user review.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review privacy documentation and confirm preference handling is aligned with policy and retention rules.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-4\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Privacy Impact Assessment\",\n          \"level\": null,\n          \"requirement\": \"Conduct privacy impact assessments for systems processing personal preferences.\",\n          \"relevance\": \"Requires assessing privacy risks around storing and using user shift preferences.\",\n          \"integration_tips\": \"Perform PIA to identify sensitive preferences (e.g., religious holidays) and apply minimization or extra protections as needed.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Provide PIA documentation and evidence of mitigations implemented based on findings.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.5\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Privacy by Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Design systems to minimize collection of personal data and protect user preferences and privacy.\",\n          \"relevance\": \"Encourages design choices that limit privacy exposure for preference tracking features.\",\n          \"integration_tips\": \"Collect only necessary preference attributes, provide user controls to view/edit/delete preferences, and protect data at rest.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect data schemas and UI controls for preference management and test deletion/exports to ensure removal.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-19\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access Control for Mobile Devices and User Attributes\",\n          \"level\": null,\n          \"requirement\": \"Protect user attribute data including preferences with appropriate access controls.\",\n          \"relevance\": \"Ensures preferences are only visible and editable by authorized entities to prevent privacy violations.\",\n          \"integration_tips\": \"Apply attribute-level ACLs so preferences are scoped to the user or authorized managers; restrict export of sensitive preferences.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Test access to preference records from different roles and verify unauthorized reads are blocked.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Unavailable dates and leave management (multiple leave types, date ranges, reasons)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.\",\n          \"relevance\": \"Leave reasons may contain sensitive personal data (e.g., medical reasons); this control ensures privacy compliance for processing and storage.\",\n          \"integration_tips\": \"Classify leave data sensitivity, apply stricter access controls for medical leave, and document legal bases for processing.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review data classification, access controls, and privacy handling for leave data.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-4\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Privacy Impact Assessment\",\n          \"level\": null,\n          \"requirement\": \"Conduct privacy impact assessments when processing sensitive personal data such as health-related leave.\",\n          \"relevance\": \"Requires evaluating privacy risks posed by collecting leave reasons and ranges and drives protective controls.\",\n          \"integration_tips\": \"Conduct PIA focusing on special categories of data, implement minimization, and consider pseudonymization where possible.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Provide PIA output and evidence of mitigations (pseudonymization, restricted access).\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"MP-6\",\n          \"chapter\": \"Media Protection\",\n          \"section\": \"Sanitization and Protection of Sensitive Data\",\n          \"level\": null,\n          \"requirement\": \"Protect sensitive personal data at rest and in transit, and sanitize when exporting or transferring.\",\n          \"relevance\": \"Applies to exporting or transferring leave records and ensuring sensitive reasons are sanitized or redacted.\",\n          \"integration_tips\": \"Encrypt leave records at rest, apply field-level redaction for exports, and limit who can download leave data.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect encryption at rest, review export sanitization routines, and test role-based export restrictions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.5\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Privacy by Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Implement privacy-by-design for sensitive employee data, minimizing collection and ensuring secure storage.\",\n          \"relevance\": \"Reinforces data minimization and secure handling for leave management modules.\",\n          \"integration_tips\": \"Collect only required fields for leave processing, provide limited retention, and notify users about purpose and retention periods.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review UI/data collection forms and retention policies; verify secure storage controls in place.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Skills management and skill-based matching for assignments\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-3 (5)\",\n          \"chapter\": \"Access Enforcement\",\n          \"section\": \"Attribute-Based Access Control (ABAC)\",\n          \"level\": null,\n          \"requirement\": \"Support attribute-based access control when access decisions depend on attributes such as skills.\",\n          \"relevance\": \"Directly enables using skills as attributes for matching and access decisions in assignment processes.\",\n          \"integration_tips\": \"Model skills as authoritative attributes, implement ABAC policies for matching, and ensure attribute sources are validated.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review ABAC policies and test that assignments respect skill attribute constraints.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Attribute-based Authorization\",\n          \"level\": \"L2\",\n          \"requirement\": \"Implement and verify attribute-based authorization where access and matching logic relies on user attributes (skills).\",\n          \"relevance\": \"Ensures matching logic based on skills is enforced and protected from manipulation.\",\n          \"integration_tips\": \"Centralize attribute evaluation, prevent client-side overrides of attributes, and audit attribute changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt to alter skill attributes via API/UI and confirm authorization prevents incorrect matching.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.2\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"User Access Provisioning\",\n          \"level\": null,\n          \"requirement\": \"Provision access and attributes carefully to ensure accurate assignment of skills and privileges.\",\n          \"relevance\": \"Requires controlled provisioning of skill attributes so matching is based on trusted data.\",\n          \"integration_tips\": \"Use administrative workflows for adding/removing skills, record provenance, and require approvals for critical attributes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review provisioning logs and sample attribute provenance to ensure correct assignment.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PM-11\",\n          \"chapter\": \"Program Management\",\n          \"section\": \"Data Quality and Integrity\",\n          \"level\": null,\n          \"requirement\": \"Ensure data used for decision making (e.g., skills) is accurate and maintained.\",\n          \"relevance\": \"Ensures matching results are reliable by mandating data quality controls around skills datasets.\",\n          \"integration_tips\": \"Implement periodic reviews and validation of skill records and provide user workflows to correct inaccuracies.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check data quality reports and validation procedures for skill records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Export of data (shifts, users, companies, skills, shift types, preferences, unavailable dates) in CSV/XLSX\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"MP-6\",\n          \"chapter\": \"Media Protection\",\n          \"section\": \"Sanitization and Protection of Sensitive Data\",\n          \"level\": null,\n          \"requirement\": \"Protect sensitive data when exporting; sanitize or redact as required before transfer or export.\",\n          \"relevance\": \"Directly applicable to preventing leakage of sensitive fields during data exports.\",\n          \"integration_tips\": \"Implement export templates that redact PII or sensitive fields by role, and require explicit authorization for exports containing sensitive data.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test exports for redaction correctness across roles and ensure sanitized outputs do not expose sensitive data.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V3.9\",\n          \"chapter\": \"Data Protection\",\n          \"section\": \"Export Controls and Data Leakage Prevention\",\n          \"level\": \"L2\",\n          \"requirement\": \"Implement controls and authorization checks on data export features and ensure exported files do not leak sensitive data.\",\n          \"relevance\": \"Specifies authorization and DLP measures for export functionality requested.\",\n          \"integration_tips\": \"Require role-based export permissions, log all export operations, and throttle/alert on large exports to prevent exfiltration.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review export permission mappings, audit logs of exports, and perform attempts to export restricted datasets.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.8.2.3\",\n          \"chapter\": \"Asset Management\",\n          \"section\": \"Handling of Assets and Sensitive Information\",\n          \"level\": null,\n          \"requirement\": \"Procedures for handling and transferring information assets including exports should be implemented.\",\n          \"relevance\": \"Requires formal handling procedures for exported data assets to ensure protection and accountability.\",\n          \"integration_tips\": \"Document export procedures, include approval steps for sensitive exports, and archive export copies securely if retained.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect documented procedures and sample approvals for export actions.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-17\",\n          \"chapter\": \"Remote Access\",\n          \"section\": \"Controls for Remote Connection and Transfer\",\n          \"level\": null,\n          \"requirement\": \"Control remote access and transfers including file exports to prevent data exfiltration.\",\n          \"relevance\": \"Applies to how exported files are transferred or downloaded to user endpoints and helps prevent exfiltration.\",\n          \"integration_tips\": \"Restrict export downloads to secure channels, enforce endpoint device checks or warn about saving sensitive files, and record provenance.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Test downloads over remote sessions and verify transfer controls are enforced.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"External API integration with Timefold solver including payload generation and solution parsing\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V13.1\",\n          \"chapter\": \"API Security\",\n          \"section\": \"Secure API Consumption and Third-party Integration\",\n          \"level\": \"L2\",\n          \"requirement\": \"Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.\",\n          \"relevance\": \"Directly addresses securing the Timefold solver integration, verifying payloads, and safely parsing responses.\",\n          \"integration_tips\": \"Apply strong authentication to the Timefold API, validate all solver responses against schema, and handle errors without exposing internal details.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect API authentication setup, review parsing code for schema validation, and execute malformed response tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SA-9\",\n          \"chapter\": \"System and Services Acquisition\",\n          \"section\": \"External System Interactions and API Security\",\n          \"level\": null,\n          \"requirement\": \"Ensure that external interfaces are secured and that integration with external systems follows organizational policies.\",\n          \"relevance\": \"Mandates governance for integrating external solvers and ensuring compliance with internal policies.\",\n          \"integration_tips\": \"Document integration requirements, include security controls in the acquisition process, and require supplier security attestations.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review acquisition/integration documentation and evidence of supplier security posture checks.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System Acquisition, Development and Maintenance\",\n          \"section\": \"Secure development practices for interfaces\",\n          \"level\": null,\n          \"requirement\": \"Security requirements for development and integration of interfaces should be defined and implemented.\",\n          \"relevance\": \"Ensures development practices for payload generation and parsing include security requirements to avoid vulnerabilities.\",\n          \"integration_tips\": \"Define interface contracts, include input/output validation, and perform secure code reviews and testing for parsing logic.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect interface contracts and review secure development artifacts and test results.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-8\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Transmission Confidentiality and Integrity\",\n          \"level\": null,\n          \"requirement\": \"Protect the confidentiality and integrity of information during transmission to external services.\",\n          \"relevance\": \"Ensures payloads and solutions exchanged with Timefold are protected from interception or tampering.\",\n          \"integration_tips\": \"Use TLS, validate certificates, and consider message signing to ensure end-to-end integrity.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Verify TLS config, perform MITM tests, and validate signature verification if implemented.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Internationalization (multi-language UI and localized date/time formatting)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.7\",\n          \"chapter\": \"Internationalization and Encoding\",\n          \"section\": \"Unicode and Encoding Handling\",\n          \"level\": \"L2\",\n          \"requirement\": \"Properly handle Unicode, normalization, and encoding to prevent injection and XSS vulnerabilities across locales.\",\n          \"relevance\": \"Directly relevant for multi-language UI and localized date/time handling to avoid injection vectors introduced by locale-specific encodings.\",\n          \"integration_tips\": \"Normalize and canonicalize text inputs/outputs, apply proper encoding/escaping per output context, and validate locale-specific formats.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Test inputs with various Unicode characters and locale-specific formats to detect XSS or parsing issues.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-17\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Public Key Infrastructure and Localisation considerations\",\n          \"level\": null,\n          \"requirement\": \"Ensure localized data formats and time/date handling do not weaken security mechanisms and are consistently handled.\",\n          \"relevance\": \"Ensures localized formatting does not break security checks like signature verification or token expiry calculations.\",\n          \"integration_tips\": \"Use locale-aware libraries for date/time parsing, store timestamps in canonical format (UTC) internally, and format only at presentation layer.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review date/time handling code and test across locales for consistent behavior of security-sensitive features.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System Acquisition, Development and Maintenance\",\n          \"section\": \"Secure development practices for localization\",\n          \"level\": null,\n          \"requirement\": \"Include security requirements for localized applications and data handling in development.\",\n          \"relevance\": \"Mandates inclusion of localization security needs in development practices for internationalized UI.\",\n          \"integration_tips\": \"Include localization security checks in SDLC, perform code reviews focused on encoding/formatting, and update test suites for locales.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Inspect development checklists and localized test cases for security considerations.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.1\",\n          \"chapter\": \"Input Validation\",\n          \"section\": \"Locale-aware Input Validation\",\n          \"level\": \"L1\",\n          \"requirement\": \"Validate and canonicalize input considering locale-specific encodings and formats.\",\n          \"relevance\": \"Supports safe handling of user inputs in various languages and formats to prevent logic or parsing errors.\",\n          \"integration_tips\": \"Implement validators that accept locale-specific formats but convert to canonical representations for processing and storage.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Run locale-specific input validation tests and check canonicalization outputs.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User interface features: responsive navigation, tables with pagination/sorting/filtering, calendar views, alerts/notifications, breadcrumbs\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.2\",\n          \"chapter\": \"Injection Prevention and XSS\",\n          \"section\": \"Cross-Site Scripting and Output Encoding\",\n          \"level\": \"L1\",\n          \"requirement\": \"Encode output and validate input to prevent XSS, especially in tables, filters, and dynamic navigation elements.\",\n          \"relevance\": \"Directly applies to UI elements which render user-controlled content and are susceptible to XSS and injection attacks.\",\n          \"integration_tips\": \"Escape/encode user data in the proper HTML/JS context, apply CSP headers, and avoid dangerous innerHTML patterns.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Perform XSS testing across UI components including pagination and dynamic filters.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"Software Integrity\",\n          \"section\": \"Input Validation and Error Handling\",\n          \"level\": null,\n          \"requirement\": \"Validate input and handle errors gracefully to avoid exposing sensitive information in UI components.\",\n          \"relevance\": \"Encourages sanitizing/filtering user inputs used for sorting/pagination and ensuring error messages do not leak internals.\",\n          \"integration_tips\": \"Validate query parameters for pagination/sorting on server-side and sanitize user-visible error messages.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review server-side validation for UI query parameters and inspect error messages for sensitive info.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.2.1\",\n          \"chapter\": \"Protection from Malware\",\n          \"section\": \"Controls for application security\",\n          \"level\": null,\n          \"requirement\": \"Apply secure development and application-level controls to mitigate common application threats.\",\n          \"relevance\": \"Provides general secure development guidance for UI features to reduce vulnerabilities like XSS and CSRF.\",\n          \"integration_tips\": \"Adopt secure UI development practices, include security tests in CI, and ensure third-party UI libs are vetted.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check secure development artifacts, dependency scans, and UI security test results.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.4\",\n          \"chapter\": \"Session Management\",\n          \"section\": \"CSRF Protections\",\n          \"level\": \"L1\",\n          \"requirement\": \"Implement CSRF protections for state-changing UI actions like shift creation or accept/reject.\",\n          \"relevance\": \"Protects UI actions (calendar interactions, form submissions) from CSRF attacks that could create/change shifts.\",\n          \"integration_tips\": \"Use anti-CSRF tokens for state-modifying requests and validate origin/referrer where appropriate.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Perform CSRF attack simulations against state-changing endpoints and verify tokens are required and validated.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Audit logging, legal documents availability (Privacy Policy, Terms of Service), and consent tracking\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"Determine and log auditable events including user consent and policy acceptance.\",\n          \"relevance\": \"Directly maps to logging consent events and availability of legal document acceptance records.\",\n          \"integration_tips\": \"Log consent events with timestamp, user ID, document version, and store immutably; ensure logs are searchable for audit.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review consent logs, verify they contain required fields, and test retrieval for audit scenarios.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with privacy requirements and record legal consents and policy acknowledgments.\",\n          \"relevance\": \"Establishes requirement to track legal consents and ensure privacy compliance for policy-driven behaviors.\",\n          \"integration_tips\": \"Retain versions of legal documents, capture consent metadata, and provide user-facing access to documents and consent history.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Verify retention of document versions and sample consent records match user acknowledgments.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.3\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Consent and Legal Events Logging\",\n          \"level\": \"L1\",\n          \"requirement\": \"Log legal acknowledgements and consent events and ensure integrity of such records.\",\n          \"relevance\": \"Specifies logging of legal events and integrity protections which are key to proving consent.\",\n          \"integration_tips\": \"Use tamper-evident storage for consent records or append-only logs and ensure access controls over consent records.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt to alter consent records in test environment and verify tamper detection and access controls.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-2\",\n          \"chapter\": \"Planning\",\n          \"section\": \"System and Communications Protection Policy\",\n          \"level\": null,\n          \"requirement\": \"Establish policies for handling legal documents and consent records.\",\n          \"relevance\": \"Requires formal policies governing how legal documents and consent are managed within the system.\",\n          \"integration_tips\": \"Develop policy that defines retention, access, and usage of consent records and implement controls accordingly.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review policy documentation and evidence of policy enforcement in system practices.\"\n        }\n      ]\n    }\n  ],\n  \"cross_functional_controls\": [\n    {\n      \"control_name\": \"Logging and Audit Trails\",\n      \"description\": \"Centralized, tamper-resistant logging of security-relevant events including authentication, authorization changes, exports, consent events, solver interactions, and algorithmic outputs.\",\n      \"applies_to\": [\n        \"All requirements (global)\",\n        \"Audit logging features\",\n        \"Automated assignment and solver integration\",\n        \"Data export and profile changes\"\n      ],\n      \"implementation_guidance\": \"Implement an append-only or integrity-protected logging system (WORM or signed logs), centralize logs with access controls, and define retention and review processes. Ensure logs capture actor, timestamp, action, target resource and before/after states where applicable.\"\n    },\n    {\n      \"control_name\": \"Encryption in Transit and at Rest\",\n      \"description\": \"Protect sensitive data (credentials, PII, solver payloads, exported files) with strong encryption during transit and at rest.\",\n      \"applies_to\": [\n        \"Authentication flows\",\n        \"External API integrations\",\n        \"Asynchronous job payloads\",\n        \"Exported files and sensitive data stores\"\n      ],\n      \"implementation_guidance\": \"Use TLS with current best-practice cipher suites for all external and internal communication; encrypt data at rest with managed keys and apply field-level encryption for highly sensitive fields. Rotate keys and manage access to encryption keys via KMS with strict IAM controls.\"\n    },\n    {\n      \"control_name\": \"Input Validation and Output Encoding\",\n      \"description\": \"Canonicalize, validate and sanitize inputs; encode outputs according to their context to prevent injection (XSS, SQLi) and logic bypass.\",\n      \"applies_to\": [\n        \"UI components (tables, filters, calendar)\",\n        \"Shift/skill/leave creation and updates\",\n        \"API payloads and external solver responses\"\n      ],\n      \"implementation_guidance\": \"Implement server-side canonicalization and validation for all inputs, apply context-aware encoding on outputs, and use schema validation for APIs. Include locale-aware validation for internationalized inputs and test with Unicode edge-cases.\"\n    },\n    {\n      \"control_name\": \"Access Control and Authorization\",\n      \"description\": \"Centralized enforcement of role-based and attribute-based access controls, with least privilege and tenant scoping.\",\n      \"applies_to\": [\n        \"RBAC and user status\",\n        \"Company CRUD/multi-tenant scoping\",\n        \"Profile and assignment management\",\n        \"Export and administrative functions\"\n      ],\n      \"implementation_guidance\": \"Use a centralized authorization service or middleware enforcing RBAC/ABAC checks at every API entrypoint, include tenant_id in access decisions, and implement policy management and review processes to keep permissions up-to-date.\"\n    },\n    {\n      \"control_name\": \"Privacy and Data Minimization\",\n      \"description\": \"Assess and minimize personal data collection (preferences, leave reasons) and protect special categories of data with additional safeguards.\",\n      \"applies_to\": [\n        \"Preferences and leave management\",\n        \"Exports and reporting\",\n        \"Algorithmic scoring and solver inputs/outputs\"\n      ],\n      \"implementation_guidance\": \"Conduct PIAs for sensitive data, apply pseudonymization or redaction for exports, limit retention periods, and restrict access to need-to-know personnel. Record legal basis and user consent where required.\"\n    }\n  ],\n  \"recommended_asvs_level\": \"L2\"\n}",
  "pydantic": {
    "requirements_mapping": [
      {
        "high_level_requirement": "User registration with email verification and account lifecycle management",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V2.1",
            "chapter": "Authentication Verification",
            "section": "Account Creation and Verification",
            "level": "L1",
            "requirement": "Verify new user registrations via email or other out-of-band mechanisms to ensure account ownership.",
            "relevance": "Directly addresses the need to confirm user ownership of email accounts during registration and reduces fraudulent account creation. It maps to the verification and lifecycle control aspects of the requirement.",
            "integration_tips": "Implement email confirmation tokens that are single-use and time-limited; require confirmation before enabling privileged features. Tie the verification status to account state in the user lifecycle management flows.",
            "priority": "Critical",
            "verification_method": "Review implementation of email verification flow, inspect token properties (single-use, expiry), and test account behavior before and after verification."
          },
          {
            "standard": "NIST",
            "req_id": "AC-2",
            "chapter": "Account Management",
            "section": "Account Lifecycle",
            "level": null,
            "requirement": "The organization manages information system accounts, including account creation, enablement, modification, disabling, and removal.",
            "relevance": "Specifies lifecycle operations which map to registration, activation, suspension, and removal of user accounts required by the feature.",
            "integration_tips": "Establish automated workflows and approval steps for account creation and deactivation; maintain authoritative records of account states and reason codes.",
            "priority": "Critical",
            "verification_method": "Audit account management procedures, review logs of account create/disable/delete events, and verify policy enforcement through test cases."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.1",
            "chapter": "User Access Management",
            "section": "User registration and de-registration",
            "level": null,
            "requirement": "A formal user registration and de-registration process shall be implemented to enable assignment of access rights.",
            "relevance": "Mandates a formal process for onboarding/offboarding which ensures registration ties into access rights and lifecycle.",
            "integration_tips": "Document procedures for registration and de-registration, include steps for verification, approvals, and role assignment during onboarding/offboarding.",
            "priority": "High",
            "verification_method": "Inspect documented procedures and sample records for adherence; validate that de-registration revokes access promptly."
          },
          {
            "standard": "NIST",
            "req_id": "IA-5",
            "chapter": "Identification and Authentication",
            "section": "Authenticator Management",
            "level": null,
            "requirement": "Manage, distribute, and revoke credentials and authenticators throughout the account lifecycle.",
            "relevance": "Addresses credential issuance and revocation tied to account lifecycle which complements email verification and lifecycle management.",
            "integration_tips": "Implement credential issuance policies, track authenticator provenance, and ensure revocation paths (e.g., when email changes or accounts disabled).",
            "priority": "High",
            "verification_method": "Review credential lifecycle processes, test revocation and re-issuance flows, and inspect logs for authenticator events."
          }
        ]
      },
      {
        "high_level_requirement": "Authentication and single sign-on via credentials and Google OAuth",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V2.2",
            "chapter": "Authentication Verification",
            "section": "Credential & Third-party Authentication",
            "level": "L2",
            "requirement": "Support secure authentication including credential-based and federated authentication (OAuth2, OpenID Connect) with proper validation and token handling.",
            "relevance": "Directly covers secure handling of credential-based login and federated SSO (Google OAuth) required by the requirement.",
            "integration_tips": "Use well-vetted OAuth2/OpenID Connect libraries, validate ID tokens server-side, enforce scopes and claims, and handle token storage securely.",
            "priority": "Critical",
            "verification_method": "Review OAuth/OIDC implementation, verify token validation, scope restrictions, and perform token replay/forgery tests."
          },
          {
            "standard": "NIST",
            "req_id": "IA-2",
            "chapter": "Identification and Authentication",
            "section": "Identification and Authentication (Organizational Users)",
            "level": null,
            "requirement": "Identify and authenticate organizational users using authenticators and, where appropriate, federated identity mechanisms.",
            "relevance": "Provides organizational control guidance for authenticating users via both local credentials and federated providers like Google.",
            "integration_tips": "Define acceptable authenticators, document trust relationships with identity providers, and require secure channels for federation.",
            "priority": "Critical",
            "verification_method": "Examine policies for federated identity, test SSO flows for proper authentication, and verify credential handling meets organizational standards."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.4.2",
            "chapter": "System and Application Access Control",
            "section": "Secure log-on procedures",
            "level": null,
            "requirement": "Secure log-on procedures shall be implemented, where appropriate supporting single sign-on and federated identity.",
            "relevance": "Requires secure log-on procedures and supports SSO, aligning with the need for secure Google OAuth integration.",
            "integration_tips": "Implement SSO with secure session establishment, multi-factor option where required, and maintain centralized session policies.",
            "priority": "High",
            "verification_method": "Validate the log-on workflow, verify session creation after SSO, and review session timeout and logout behavior."
          },
          {
            "standard": "OWASP",
            "req_id": "V5.3",
            "chapter": "Session Management",
            "section": "OAuth and Token Handling",
            "level": "L2",
            "requirement": "Ensure tokens are validated, scoped, stored securely, and revoked when necessary for SSO and OAuth use-cases.",
            "relevance": "Covers secure token lifecycle for SSO, ensuring tokens from Google are handled safely and revocable.",
            "integration_tips": "Use secure token storage (HTTP-only cookies or secure token stores), implement token revocation and rotation, and minimize token scopes.",
            "priority": "Critical",
            "verification_method": "Inspect token storage methods, test revocation and refresh flows, and review scope requests during OAuth handshake."
          }
        ]
      },
      {
        "high_level_requirement": "Password reset and account recovery",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V2.3",
            "chapter": "Authentication Verification",
            "section": "Password Reset & Account Recovery",
            "level": "L1",
            "requirement": "Implement secure password reset flows using verified contact channels and protections against account takeover (OTP, expiring tokens, rate limiting).",
            "relevance": "Directly maps to the need for secure password reset flows and protections against abuse or account takeover.",
            "integration_tips": "Use single-use, short-lived reset tokens delivered via verified channels, add rate limiting and anomaly detection on reset attempts.",
            "priority": "Critical",
            "verification_method": "Test reset flows for token reuse, expiry, and ensure resets require verified contact; perform abuse-case testing."
          },
          {
            "standard": "NIST",
            "req_id": "IA-5 (5)",
            "chapter": "Identification and Authentication",
            "section": "Password and Recovery Credential Management",
            "level": null,
            "requirement": "Establish policies and mechanisms for managing password resets and recovery in a manner that resists credential compromise.",
            "relevance": "Provides organizational expectations for secure recovery procedures to reduce risk of credential compromise.",
            "integration_tips": "Document recovery procedures, require multi-step verification for high-risk account changes, and log recovery events for auditing.",
            "priority": "High",
            "verification_method": "Review recovery policies, validate multi-step verification for sensitive accounts, and inspect logs of recovery events."
          },
          {
            "standard": "OWASP",
            "req_id": "V5.1",
            "chapter": "Session Management",
            "section": "One-time tokens and recovery tokens",
            "level": "L2",
            "requirement": "Recovery tokens and one-time use links must be single-use, short-lived, and protected against replay attacks.",
            "relevance": "Specifies properties of recovery tokens which mitigate replay and abuse in password reset flows.",
            "integration_tips": "Implement cryptographically-random tokens, mark tokens used after redemption, and expire tokens quickly (e.g., 15 minutes).",
            "priority": "High",
            "verification_method": "Inspect token generation and storage, attempt token replay tests, and verify expiry enforcement."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.3",
            "chapter": "User Access Management",
            "section": "Management of privileged access rights",
            "level": null,
            "requirement": "Ensure controlled management of authentication data and password resets, including policies and procedures.",
            "relevance": "Supports governance over reset and recovery processes to prevent misuse, particularly for privileged accounts.",
            "integration_tips": "Apply stricter reset controls for privileged roles, require manual approvals where appropriate, and log privileged resets.",
            "priority": "Medium",
            "verification_method": "Review privileged reset controls, sampling of privileged account reset logs, and policy documentation."
          }
        ]
      },
      {
        "high_level_requirement": "Role-based access control (ADMIN, MANAGER, EMPLOYEE) and user status management",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.1",
            "chapter": "Access Control Verification",
            "section": "Role-based Access Control",
            "level": "L2",
            "requirement": "Enforce role-based access control with least privilege and separation of duties; implement role checks on both client and server sides.",
            "relevance": "Directly prescribes RBAC enforcement necessary for ADMIN/MANAGER/EMPLOYEE roles and ensures server-side enforcement to prevent privilege escalation.",
            "integration_tips": "Centralize role checks in authorization middleware, enforce least privilege for each role, and prevent client-side-only enforcement.",
            "priority": "Critical",
            "verification_method": "Review role definitions, test access control enforcement across endpoints for each role, and perform privilege escalation attempts."
          },
          {
            "standard": "NIST",
            "req_id": "AC-3",
            "chapter": "Access Enforcement",
            "section": "Access Control Policy and Enforcement",
            "level": null,
            "requirement": "Enforce access restrictions and ensure users are granted access only to authorized functions and data.",
            "relevance": "Mandates access enforcement which supports role-based controls and status-based access (active/disabled/suspended).",
            "integration_tips": "Implement centralized access control checks, map roles to permissions, and enforce account status checks before granting access.",
            "priority": "Critical",
            "verification_method": "Inspect policy-to-implementation mapping, run access matrix tests, and verify that disabled users cannot access resources."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.1.2",
            "chapter": "User Access Management",
            "section": "Access Control Policy",
            "level": null,
            "requirement": "An access control policy based on business and security requirements shall be established, documented, and reviewed.",
            "relevance": "Requires documented access control policies to define role responsibilities and status management.",
            "integration_tips": "Create and maintain an access control policy describing roles, permissions, and lifecycle procedures; align with HR onboarding/offboarding.",
            "priority": "High",
            "verification_method": "Review access control policy documentation and interview personnel to confirm implementation."
          },
          {
            "standard": "NIST",
            "req_id": "AC-2 (3)",
            "chapter": "Account Management",
            "section": "Account Status and Automation",
            "level": null,
            "requirement": "Automate account status changes (enable/disable) and maintain authoritative account state.",
            "relevance": "Supports user status management by prescribing automation and authoritative state control to prevent orphaned or active-but-disabled accounts.",
            "integration_tips": "Integrate with HR systems for status changes, implement automated disabling for inactivity or termination, and record change reasons.",
            "priority": "High",
            "verification_method": "Audit automation integrations, simulate HR-driven status changes, and verify system enforces new statuses immediately."
          }
        ]
      },
      {
        "high_level_requirement": "User profile management and company assignment",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.6",
            "chapter": "Access Control Verification",
            "section": "Authorization for Profile and Resource Assignment",
            "level": "L1",
            "requirement": "Verify that updates to user profiles and assignments (e.g., company membership) are protected by server-side authorization checks.",
            "relevance": "Directly addresses the need to protect profile updates and company assignments from unauthorized changes.",
            "integration_tips": "Enforce server-side permission checks tied to role and ownership; validate company assignment changes against authoritative sources.",
            "priority": "High",
            "verification_method": "Review code paths for profile update endpoints, perform unauthorized modification tests, and inspect audit logs."
          },
          {
            "standard": "NIST",
            "req_id": "AC-6",
            "chapter": "Least Privilege",
            "section": "Least Privilege and Separation of Duties",
            "level": null,
            "requirement": "Employ least privilege mechanisms for user profile updates and assignment of organizational attributes.",
            "relevance": "Ensures only authorized personnel or processes can assign users to companies or alter profile attributes, reducing risk of misuse.",
            "integration_tips": "Assign minimal privileges to services and operators that manage profile/company attributes and require approvals for sensitive changes.",
            "priority": "High",
            "verification_method": "Check privilege assignments for profile-management components and test unauthorized assignment attempts."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.2",
            "chapter": "User Access Management",
            "section": "User access provisioning",
            "level": null,
            "requirement": "A formal process for granting and revoking access rights and attributes should be followed, including assignment to organizational units.",
            "relevance": "Requires formal provisioning processes which should include company assignment and profile attribute handling.",
            "integration_tips": "Implement provisioning workflows with approvals and record keeping, and enforce verification of company membership during assignment.",
            "priority": "Medium",
            "verification_method": "Review provisioning records and test the end-to-end process for correctness and auditability."
          },
          {
            "standard": "OWASP",
            "req_id": "V1.1",
            "chapter": "Architecture and Design",
            "section": "Trust Boundaries and Multi-tenancy",
            "level": "L2",
            "requirement": "Design systems to maintain clear trust boundaries so profile attributes that determine access are authoritative and validated.",
            "relevance": "Ensures profile attributes like company assignment are authoritative and cannot be spoofed to gain access across boundaries.",
            "integration_tips": "Store canonical profile attributes in a trusted service or database, and validate tokens/claims used to assert company membership.",
            "priority": "High",
            "verification_method": "Inspect trust boundary design, review data flow diagrams, and test for attribute spoofing."
          }
        ]
      },
      {
        "high_level_requirement": "Company CRUD and multi-tenant scoping of data",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V14.1",
            "chapter": "Multi-Tenancy",
            "section": "Tenant Isolation and Data Separation",
            "level": "L2",
            "requirement": "Ensure logical separation of tenant data and enforce access controls to prevent cross-tenant data leakage.",
            "relevance": "Directly addresses multi-tenant scoping and the need to prevent cross-company data access when performing CRUD operations.",
            "integration_tips": "Enforce tenant checks at data access layer and include tenant_id in every query predicate; implement row-level security where possible.",
            "priority": "Critical",
            "verification_method": "Review data access code, run multi-tenant isolation tests (attempt cross-tenant reads/writes), and inspect database policies."
          },
          {
            "standard": "NIST",
            "req_id": "SC-7",
            "chapter": "System and Communications Protection",
            "section": "Boundary Protection",
            "level": null,
            "requirement": "Implement controls to separate and protect system components and data flows; apply isolation as necessary.",
            "relevance": "Supports the requirement to protect and isolate tenant data by prescribing boundary and isolation controls.",
            "integration_tips": "Segment logical components by tenant boundaries, apply network and access controls for management interfaces, and minimize shared state.",
            "priority": "High",
            "verification_method": "Assess architecture diagrams, test separation of management interfaces, and review network segmentation controls."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.13.2.1",
            "chapter": "Communications Security",
            "section": "Information transfer policies and procedures",
            "level": null,
            "requirement": "Information transfer and segregation mechanisms should be defined to protect the exchange and separation of information between entities.",
            "relevance": "Requires documented segregation mechanisms relevant to multi-tenant CRUD operations and data transfer between tenants.",
            "integration_tips": "Document transfer policies, implement enforcement controls for inter-tenant transfers, and require approvals for cross-tenant data export.",
            "priority": "Medium",
            "verification_method": "Review policy documents and sample transfer approvals; test that transfers are blocked or logged when not permitted."
          },
          {
            "standard": "NIST",
            "req_id": "AC-6 (10)",
            "chapter": "Least Privilege",
            "section": "Tenant-specific Access Controls",
            "level": null,
            "requirement": "Apply tenant-specific access restrictions and scoping to limit access to tenant resources.",
            "relevance": "Specifies tailoring of least-privilege controls to tenant-specific resources which is essential for company CRUD scoping.",
            "integration_tips": "Map permissions to tenant-scoped roles, implement enforcement in APIs and DB, and maintain per-tenant admin scopes.",
            "priority": "High",
            "verification_method": "Verify per-tenant role mappings, test scoped permissions, and run negative tests attempting cross-tenant CRUD."
          }
        ]
      },
      {
        "high_level_requirement": "Shift type management with time ranges and required skills",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V1.3",
            "chapter": "Architecture and Design",
            "section": "Data Validation and Business Logic Integrity",
            "level": "L1",
            "requirement": "Validate business input (e.g., time ranges, required skills) server-side to prevent logic abuse and ensure data integrity.",
            "relevance": "Protects shift-type definitions from malformed or malicious inputs that could break scheduling logic or grant unauthorized capabilities.",
            "integration_tips": "Implement strict server-side validation for time ranges, enforce constraints (no overlap, valid skill IDs), and canonicalize inputs.",
            "priority": "High",
            "verification_method": "Review validation code, perform fuzzing of time/skill inputs, and check DB for invalid persisted records."
          },
          {
            "standard": "NIST",
            "req_id": "SI-10",
            "chapter": "Information Integrity",
            "section": "Input Validation and Integrity Verification",
            "level": null,
            "requirement": "Employ integrity checks and input validation to ensure data consistency and correctness.",
            "relevance": "Ensures integrity of shift-type data and supports detection of tampering or corruption.",
            "integration_tips": "Apply schema validation, integrity checksums where necessary, and enforce business rule validation in services.",
            "priority": "Medium",
            "verification_method": "Inspect schema validations, run integrity checks in test harness, and verify constraints via unit tests."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.1.2",
            "chapter": "Operational Procedures and Responsibilities",
            "section": "Change Management and Data Integrity",
            "level": null,
            "requirement": "Changes to systems and data (including configuration of business objects like shift types) should be controlled to preserve integrity.",
            "relevance": "Requires controlled change processes for shift-type configurations to prevent unauthorized or erroneous changes.",
            "integration_tips": "Use controlled deployment/change processes for shift-type schema or rule changes, include review/approval steps for business-impacting changes.",
            "priority": "Medium",
            "verification_method": "Review change records for shift-type modifications and check that approvals were captured."
          },
          {
            "standard": "OWASP",
            "req_id": "V6.4",
            "chapter": "Business Logic",
            "section": "Enforce Business Rules",
            "level": "L2",
            "requirement": "Ensure business logic (e.g., required skills per shift type) is enforced server-side and cannot be bypassed by client manipulation.",
            "relevance": "Directly ensures shift-type business rules are enforced server-side to prevent client-side tampering.",
            "integration_tips": "Centralize business rules in service layer, implement tests for rule enforcement, and prevent direct DB writes that bypass logic.",
            "priority": "High",
            "verification_method": "Attempt to bypass rules via direct API/DB calls and validate server rejects inconsistent or unauthorized changes."
          }
        ]
      },
      {
        "high_level_requirement": "Manual shift creation, update, deletion, and calendar presentation",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V4.4",
            "chapter": "Access Control Verification",
            "section": "Authorization for Data Modification",
            "level": "L1",
            "requirement": "Authorize all modification endpoints and verify checks server-side to prevent unauthorized creation, update, or deletion.",
            "relevance": "Ensures only authorized users can create/update/delete shifts, which is central to manual shift management.",
            "integration_tips": "Protect endpoints via role checks and ownership checks; ensure calendar UI actions invoke server-side authorization.",
            "priority": "Critical",
            "verification_method": "Test role-based access to create/update/delete endpoints, and attempt unauthorized operations."
          },
          {
            "standard": "NIST",
            "req_id": "AU-2",
            "chapter": "Audit and Accountability",
            "section": "Audit Events",
            "level": null,
            "requirement": "Determine and log auditable events including create, modify, delete operations.",
            "relevance": "Records manual shift changes for accountability and incident investigation as required by the feature.",
            "integration_tips": "Log change events with user, timestamp, before/after state and reason; protect logs from tampering.",
            "priority": "High",
            "verification_method": "Review audit logs for shift CRUD events and validate completeness and integrity."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.1",
            "chapter": "Logging and Monitoring",
            "section": "Event Logging",
            "level": null,
            "requirement": "Event logs recording user activities, exceptions, and security events shall be produced and retained.",
            "relevance": "Mandates retaining logs for manual shift operations and UI interactions for compliance and troubleshooting.",
            "integration_tips": "Define retention periods, ensure secure storage, and include calendar-related events as auditable actions.",
            "priority": "Medium",
            "verification_method": "Inspect logs for the required events, retention configuration, and access controls around logs."
          },
          {
            "standard": "NIST",
            "req_id": "AC-6",
            "chapter": "Least Privilege",
            "section": "Enforce least privilege on modification endpoints",
            "level": null,
            "requirement": "Restrict modify/delete/create operations to roles with explicit permissions.",
            "relevance": "Supports limiting who may perform manual shift operations to defined roles, reducing misuse risk.",
            "integration_tips": "Map CRUD permissions to ADMIN/MANAGER roles and apply checks in API and UI layers.",
            "priority": "High",
            "verification_method": "Review permission mappings and test that lower-privileged roles cannot modify shifts."
          }
        ]
      },
      {
        "high_level_requirement": "Shift status tracking and filtering (SCHEDULED, CONFIRMED, COMPLETED, CANCELLED, NO_SHOW)",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AU-6",
            "chapter": "Audit and Accountability",
            "section": "Audit Review, Analysis, and Reporting",
            "level": null,
            "requirement": "Regularly review and analyze audit records for indications of unauthorized activity or changes.",
            "relevance": "Encourages review of status transitions to detect unauthorized or anomalous status changes such as NO_SHOW flags being manipulated.",
            "integration_tips": "Log status transitions with actor and context, implement periodic reviews and alerts for unusual patterns.",
            "priority": "High",
            "verification_method": "Review audit processes, sample status transition logs, and ensure alerts are configured for anomalies."
          },
          {
            "standard": "OWASP",
            "req_id": "V10.1",
            "chapter": "Logging and Monitoring",
            "section": "Tamper-resistant Logging",
            "level": "L2",
            "requirement": "Ensure logs and status transitions are recorded in tamper-resistant logs and integrity-protected storage.",
            "relevance": "Protects the integrity of status history to provide trustworthy records for scheduling outcomes.",
            "integration_tips": "Use append-only logs or secure log storage with integrity checks and restrict log modification privileges.",
            "priority": "High",
            "verification_method": "Inspect log storage protections and attempt to modify logs; verify detection of tamper attempts."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.4.3",
            "chapter": "Logging and Monitoring",
            "section": "Administrator and Operator Logs",
            "level": null,
            "requirement": "Administrator and operator activities, including status changes, should be logged and reviewed.",
            "relevance": "Mandates logging of operator actions affecting shift statuses to maintain accountability.",
            "integration_tips": "Capture operator ID and reason for manual status changes, and include review procedures for sensitive transitions.",
            "priority": "Medium",
            "verification_method": "Check logs for operator entries and review processes for manual status changes."
          },
          {
            "standard": "NIST",
            "req_id": "CM-3",
            "chapter": "Configuration Management",
            "section": "Configuration Change Control",
            "level": null,
            "requirement": "Control and document changes to system configuration and state transitions.",
            "relevance": "Ensures system state transitions for shift statuses are controlled and documented, preventing unauthorized state changes.",
            "integration_tips": "Treat status transition rules as configuration items, version them, and require approvals for rule changes.",
            "priority": "Medium",
            "verification_method": "Review change records for status transition rule updates and verify approvals were enforced."
          }
        ]
      },
      {
        "high_level_requirement": "Automated shift assignment (auto-assignment) via external solver with preview and accept/reject",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V13.1",
            "chapter": "API Security",
            "section": "Secure API Consumption and Third-party Integration",
            "level": "L2",
            "requirement": "Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.",
            "relevance": "Applies to integrating with external solver for auto-assignment and ensuring previews and accepts/rejects are securely transmitted and validated.",
            "integration_tips": "Use mutual TLS or OAuth for API calls, validate solver responses before applying changes, and implement signed payloads or record hashes for integrity.",
            "priority": "Critical",
            "verification_method": "Review API authentication configuration, test injection or malformed response handling, and verify server validates solver outputs."
          },
          {
            "standard": "NIST",
            "req_id": "SA-9",
            "chapter": "System and Services Acquisition",
            "section": "External System Interactions and API Security",
            "level": null,
            "requirement": "Ensure that external interfaces are secured and that integration with external systems follows organizational policies.",
            "relevance": "Mandates governance around external solver usage and how solver results are accepted into the system.",
            "integration_tips": "Define security requirements in supplier agreements, document expected APIs, and ensure change management for solver integration.",
            "priority": "High",
            "verification_method": "Review supplier contracts, interface security documentation, and test compliance with the defined integration policy."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.15.1.1",
            "chapter": "Supplier Relationships",
            "section": "Information Security in Supplier Relationships",
            "level": null,
            "requirement": "Establish controls for supplier relationships including security requirements for shared data and interfaces.",
            "relevance": "Supports contractual and security requirements for using an external solver service for assignments.",
            "integration_tips": "Include SLAs and security requirements in supplier agreements, require proof of secure handling, and define incident responsibilities.",
            "priority": "Medium",
            "verification_method": "Inspect supplier agreements and evidence of supplier security practices and audits."
          },
          {
            "standard": "NIST",
            "req_id": "SC-8",
            "chapter": "System and Communications Protection",
            "section": "Transmission Confidentiality and Integrity",
            "level": null,
            "requirement": "Protect the confidentiality and integrity of information during transmission to external services.",
            "relevance": "Ensures solver payloads and returned solutions are transmitted securely to prevent tampering or eavesdropping.",
            "integration_tips": "Use TLS with strong ciphers, enforce certificate validation, and consider payload signing for end-to-end integrity.",
            "priority": "High",
            "verification_method": "Inspect TLS configuration, perform MITM tests, and verify payload signatures if implemented."
          }
        ]
      },
      {
        "high_level_requirement": "Real-time asynchronous job processing, polling, and solution status tracking",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "SC-13",
            "chapter": "System and Communications Protection",
            "section": "Use of Cryptography",
            "level": null,
            "requirement": "Use cryptography to protect data in transit and at rest in asynchronous messaging systems.",
            "relevance": "Secures messages and job payloads in transit and at rest as they move through job queues and polling endpoints.",
            "integration_tips": "Encrypt messages in transit with TLS and at rest with appropriate encryption keys; protect queue access with authentication.",
            "priority": "High",
            "verification_method": "Review encryption configurations for queues and endpoints, and test interception attempts."
          },
          {
            "standard": "OWASP",
            "req_id": "V14.3",
            "chapter": "Backend and Infrastructure",
            "section": "Secure Asynchronous Processing",
            "level": "L2",
            "requirement": "Ensure job queues and background processing components enforce authentication, authorization, and message validation.",
            "relevance": "Specifies securing job processing elements to ensure only authorized jobs are enqueued/processed and status updates are validated.",
            "integration_tips": "Authenticate producers/consumers, validate job payloads schema, and authorize status-change operations based on role.",
            "priority": "Critical",
            "verification_method": "Inspect queue ACLs, test unauthorized enqueue/dequeue attempts, and validate payload schema checks."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.1.1",
            "chapter": "Operational Procedures",
            "section": "Documented operating procedures for operations including job processing",
            "level": null,
            "requirement": "Operational procedures should define and control background processing and message handling.",
            "relevance": "Mandates documented procedures around real-time job processing and polling operations.",
            "integration_tips": "Document job lifecycle, polling intervals, retry limits, and error handling; include operational runbooks for failures.",
            "priority": "Medium",
            "verification_method": "Review operational procedures and perform runbook drills to validate behavior."
          },
          {
            "standard": "NIST",
            "req_id": "SI-7",
            "chapter": "Software, Firmware, and Information Integrity",
            "section": "Integrity Check Mechanisms",
            "level": null,
            "requirement": "Implement integrity checks for data processed asynchronously to detect tampering or corruption.",
            "relevance": "Ensures the integrity of solutions and job payloads is verifiable during the asynchronous processing lifecycle.",
            "integration_tips": "Include checksums, signatures, or message authentication codes (MACs) on job payloads and verify them before processing.",
            "priority": "High",
            "verification_method": "Inspect integrity verification code paths and attempt to submit tampered payloads to confirm detection."
          }
        ]
      },
      {
        "high_level_requirement": "Solution scoring, constraint violation analysis, and reporting",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V11.2",
            "chapter": "Logging and Monitoring",
            "section": "Algorithmic Transparency and Audit Trails",
            "level": "L2",
            "requirement": "Log inputs, configuration, and outputs of automated decision algorithms to support auditing and explainability.",
            "relevance": "Directly applies to capturing evidence of scoring and constraint violations for review and dispute resolution.",
            "integration_tips": "Record solver inputs, scoring parameters, and output diffs; store logs securely with access controls for auditors.",
            "priority": "High",
            "verification_method": "Check that algorithmic inputs/outputs are logged and can be correlated to user-visible reports."
          },
          {
            "standard": "NIST",
            "req_id": "PM-22",
            "chapter": "Planning",
            "section": "Algorithmic Accountability",
            "level": null,
            "requirement": "Document and analyze how automated solutions are validated, scored, and how violations are reported.",
            "relevance": "Mandates documentation and governance around automated scoring which supports trustworthy reporting.",
            "integration_tips": "Maintain documentation of scoring methodology, test datasets, and validation results; define reporting formats and owners.",
            "priority": "Medium",
            "verification_method": "Review documentation and validation artifacts and confirm reporting pipelines produce expected outputs."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.4",
            "chapter": "Compliance",
            "section": "Privacy and Data Protection in Automated Processing",
            "level": null,
            "requirement": "Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.",
            "relevance": "Ensures scoring and reporting practices comply with privacy and regulatory requirements, especially if personal data influences scores.",
            "integration_tips": "Assess privacy impacts of scoring data, avoid unnecessary personal data in scoring logs, and provide explanations where decisions affect individuals.",
            "priority": "Medium",
            "verification_method": "Review privacy assessments and validate that logs/reporting exclude unnecessary personal data or are appropriately protected."
          },
          {
            "standard": "NIST",
            "req_id": "AU-12",
            "chapter": "Audit and Accountability",
            "section": "Audit Generation",
            "level": null,
            "requirement": "Generate audit records for security-relevant events including algorithm outputs and violations.",
            "relevance": "Ensures scoring and violation events are auditable and recorded for security/review purposes.",
            "integration_tips": "Define which scoring events are auditable, include identifiers correlating to inputs, and protect audit logs from tampering.",
            "priority": "High",
            "verification_method": "Inspect audit logs for scoring events and test correlation between algorithm runs and generated logs."
          }
        ]
      },
      {
        "high_level_requirement": "Shift preferences management (date-specific desired/undesired) and preference tracking",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.4",
            "chapter": "Compliance",
            "section": "Privacy and Data Protection in Automated Processing",
            "level": null,
            "requirement": "Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.",
            "relevance": "Preferences may be personal data; this control ensures processing complies with privacy requirements and is documented.",
            "integration_tips": "Limit retention of preference data, document how preferences are used in automated assignment, and expose preference reports for user review.",
            "priority": "High",
            "verification_method": "Review privacy documentation and confirm preference handling is aligned with policy and retention rules."
          },
          {
            "standard": "NIST",
            "req_id": "PL-4",
            "chapter": "Planning",
            "section": "Privacy Impact Assessment",
            "level": null,
            "requirement": "Conduct privacy impact assessments for systems processing personal preferences.",
            "relevance": "Requires assessing privacy risks around storing and using user shift preferences.",
            "integration_tips": "Perform PIA to identify sensitive preferences (e.g., religious holidays) and apply minimization or extra protections as needed.",
            "priority": "Medium",
            "verification_method": "Provide PIA documentation and evidence of mitigations implemented based on findings."
          },
          {
            "standard": "OWASP",
            "req_id": "V1.5",
            "chapter": "Architecture and Design",
            "section": "Privacy by Design",
            "level": "L1",
            "requirement": "Design systems to minimize collection of personal data and protect user preferences and privacy.",
            "relevance": "Encourages design choices that limit privacy exposure for preference tracking features.",
            "integration_tips": "Collect only necessary preference attributes, provide user controls to view/edit/delete preferences, and protect data at rest.",
            "priority": "High",
            "verification_method": "Inspect data schemas and UI controls for preference management and test deletion/exports to ensure removal."
          },
          {
            "standard": "NIST",
            "req_id": "AC-19",
            "chapter": "Access Control",
            "section": "Access Control for Mobile Devices and User Attributes",
            "level": null,
            "requirement": "Protect user attribute data including preferences with appropriate access controls.",
            "relevance": "Ensures preferences are only visible and editable by authorized entities to prevent privacy violations.",
            "integration_tips": "Apply attribute-level ACLs so preferences are scoped to the user or authorized managers; restrict export of sensitive preferences.",
            "priority": "Medium",
            "verification_method": "Test access to preference records from different roles and verify unauthorized reads are blocked."
          }
        ]
      },
      {
        "high_level_requirement": "Unavailable dates and leave management (multiple leave types, date ranges, reasons)",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.4",
            "chapter": "Compliance",
            "section": "Privacy and Data Protection in Automated Processing",
            "level": null,
            "requirement": "Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.",
            "relevance": "Leave reasons may contain sensitive personal data (e.g., medical reasons); this control ensures privacy compliance for processing and storage.",
            "integration_tips": "Classify leave data sensitivity, apply stricter access controls for medical leave, and document legal bases for processing.",
            "priority": "Critical",
            "verification_method": "Review data classification, access controls, and privacy handling for leave data."
          },
          {
            "standard": "NIST",
            "req_id": "PL-4",
            "chapter": "Planning",
            "section": "Privacy Impact Assessment",
            "level": null,
            "requirement": "Conduct privacy impact assessments when processing sensitive personal data such as health-related leave.",
            "relevance": "Requires evaluating privacy risks posed by collecting leave reasons and ranges and drives protective controls.",
            "integration_tips": "Conduct PIA focusing on special categories of data, implement minimization, and consider pseudonymization where possible.",
            "priority": "High",
            "verification_method": "Provide PIA output and evidence of mitigations (pseudonymization, restricted access)."
          },
          {
            "standard": "NIST",
            "req_id": "MP-6",
            "chapter": "Media Protection",
            "section": "Sanitization and Protection of Sensitive Data",
            "level": null,
            "requirement": "Protect sensitive personal data at rest and in transit, and sanitize when exporting or transferring.",
            "relevance": "Applies to exporting or transferring leave records and ensuring sensitive reasons are sanitized or redacted.",
            "integration_tips": "Encrypt leave records at rest, apply field-level redaction for exports, and limit who can download leave data.",
            "priority": "High",
            "verification_method": "Inspect encryption at rest, review export sanitization routines, and test role-based export restrictions."
          },
          {
            "standard": "OWASP",
            "req_id": "V1.5",
            "chapter": "Architecture and Design",
            "section": "Privacy by Design",
            "level": "L1",
            "requirement": "Implement privacy-by-design for sensitive employee data, minimizing collection and ensuring secure storage.",
            "relevance": "Reinforces data minimization and secure handling for leave management modules.",
            "integration_tips": "Collect only required fields for leave processing, provide limited retention, and notify users about purpose and retention periods.",
            "priority": "Medium",
            "verification_method": "Review UI/data collection forms and retention policies; verify secure storage controls in place."
          }
        ]
      },
      {
        "high_level_requirement": "Skills management and skill-based matching for assignments",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AC-3 (5)",
            "chapter": "Access Enforcement",
            "section": "Attribute-Based Access Control (ABAC)",
            "level": null,
            "requirement": "Support attribute-based access control when access decisions depend on attributes such as skills.",
            "relevance": "Directly enables using skills as attributes for matching and access decisions in assignment processes.",
            "integration_tips": "Model skills as authoritative attributes, implement ABAC policies for matching, and ensure attribute sources are validated.",
            "priority": "High",
            "verification_method": "Review ABAC policies and test that assignments respect skill attribute constraints."
          },
          {
            "standard": "OWASP",
            "req_id": "V4.2",
            "chapter": "Access Control Verification",
            "section": "Attribute-based Authorization",
            "level": "L2",
            "requirement": "Implement and verify attribute-based authorization where access and matching logic relies on user attributes (skills).",
            "relevance": "Ensures matching logic based on skills is enforced and protected from manipulation.",
            "integration_tips": "Centralize attribute evaluation, prevent client-side overrides of attributes, and audit attribute changes.",
            "priority": "High",
            "verification_method": "Attempt to alter skill attributes via API/UI and confirm authorization prevents incorrect matching."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.9.2.2",
            "chapter": "User Access Management",
            "section": "User Access Provisioning",
            "level": null,
            "requirement": "Provision access and attributes carefully to ensure accurate assignment of skills and privileges.",
            "relevance": "Requires controlled provisioning of skill attributes so matching is based on trusted data.",
            "integration_tips": "Use administrative workflows for adding/removing skills, record provenance, and require approvals for critical attributes.",
            "priority": "Medium",
            "verification_method": "Review provisioning logs and sample attribute provenance to ensure correct assignment."
          },
          {
            "standard": "NIST",
            "req_id": "PM-11",
            "chapter": "Program Management",
            "section": "Data Quality and Integrity",
            "level": null,
            "requirement": "Ensure data used for decision making (e.g., skills) is accurate and maintained.",
            "relevance": "Ensures matching results are reliable by mandating data quality controls around skills datasets.",
            "integration_tips": "Implement periodic reviews and validation of skill records and provide user workflows to correct inaccuracies.",
            "priority": "Medium",
            "verification_method": "Check data quality reports and validation procedures for skill records."
          }
        ]
      },
      {
        "high_level_requirement": "Export of data (shifts, users, companies, skills, shift types, preferences, unavailable dates) in CSV/XLSX",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "MP-6",
            "chapter": "Media Protection",
            "section": "Sanitization and Protection of Sensitive Data",
            "level": null,
            "requirement": "Protect sensitive data when exporting; sanitize or redact as required before transfer or export.",
            "relevance": "Directly applicable to preventing leakage of sensitive fields during data exports.",
            "integration_tips": "Implement export templates that redact PII or sensitive fields by role, and require explicit authorization for exports containing sensitive data.",
            "priority": "Critical",
            "verification_method": "Test exports for redaction correctness across roles and ensure sanitized outputs do not expose sensitive data."
          },
          {
            "standard": "OWASP",
            "req_id": "V3.9",
            "chapter": "Data Protection",
            "section": "Export Controls and Data Leakage Prevention",
            "level": "L2",
            "requirement": "Implement controls and authorization checks on data export features and ensure exported files do not leak sensitive data.",
            "relevance": "Specifies authorization and DLP measures for export functionality requested.",
            "integration_tips": "Require role-based export permissions, log all export operations, and throttle/alert on large exports to prevent exfiltration.",
            "priority": "High",
            "verification_method": "Review export permission mappings, audit logs of exports, and perform attempts to export restricted datasets."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.8.2.3",
            "chapter": "Asset Management",
            "section": "Handling of Assets and Sensitive Information",
            "level": null,
            "requirement": "Procedures for handling and transferring information assets including exports should be implemented.",
            "relevance": "Requires formal handling procedures for exported data assets to ensure protection and accountability.",
            "integration_tips": "Document export procedures, include approval steps for sensitive exports, and archive export copies securely if retained.",
            "priority": "Medium",
            "verification_method": "Inspect documented procedures and sample approvals for export actions."
          },
          {
            "standard": "NIST",
            "req_id": "AC-17",
            "chapter": "Remote Access",
            "section": "Controls for Remote Connection and Transfer",
            "level": null,
            "requirement": "Control remote access and transfers including file exports to prevent data exfiltration.",
            "relevance": "Applies to how exported files are transferred or downloaded to user endpoints and helps prevent exfiltration.",
            "integration_tips": "Restrict export downloads to secure channels, enforce endpoint device checks or warn about saving sensitive files, and record provenance.",
            "priority": "Medium",
            "verification_method": "Test downloads over remote sessions and verify transfer controls are enforced."
          }
        ]
      },
      {
        "high_level_requirement": "External API integration with Timefold solver including payload generation and solution parsing",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V13.1",
            "chapter": "API Security",
            "section": "Secure API Consumption and Third-party Integration",
            "level": "L2",
            "requirement": "Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.",
            "relevance": "Directly addresses securing the Timefold solver integration, verifying payloads, and safely parsing responses.",
            "integration_tips": "Apply strong authentication to the Timefold API, validate all solver responses against schema, and handle errors without exposing internal details.",
            "priority": "Critical",
            "verification_method": "Inspect API authentication setup, review parsing code for schema validation, and execute malformed response tests."
          },
          {
            "standard": "NIST",
            "req_id": "SA-9",
            "chapter": "System and Services Acquisition",
            "section": "External System Interactions and API Security",
            "level": null,
            "requirement": "Ensure that external interfaces are secured and that integration with external systems follows organizational policies.",
            "relevance": "Mandates governance for integrating external solvers and ensuring compliance with internal policies.",
            "integration_tips": "Document integration requirements, include security controls in the acquisition process, and require supplier security attestations.",
            "priority": "High",
            "verification_method": "Review acquisition/integration documentation and evidence of supplier security posture checks."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.5",
            "chapter": "System Acquisition, Development and Maintenance",
            "section": "Secure development practices for interfaces",
            "level": null,
            "requirement": "Security requirements for development and integration of interfaces should be defined and implemented.",
            "relevance": "Ensures development practices for payload generation and parsing include security requirements to avoid vulnerabilities.",
            "integration_tips": "Define interface contracts, include input/output validation, and perform secure code reviews and testing for parsing logic.",
            "priority": "Medium",
            "verification_method": "Inspect interface contracts and review secure development artifacts and test results."
          },
          {
            "standard": "NIST",
            "req_id": "SC-8",
            "chapter": "System and Communications Protection",
            "section": "Transmission Confidentiality and Integrity",
            "level": null,
            "requirement": "Protect the confidentiality and integrity of information during transmission to external services.",
            "relevance": "Ensures payloads and solutions exchanged with Timefold are protected from interception or tampering.",
            "integration_tips": "Use TLS, validate certificates, and consider message signing to ensure end-to-end integrity.",
            "priority": "High",
            "verification_method": "Verify TLS config, perform MITM tests, and validate signature verification if implemented."
          }
        ]
      },
      {
        "high_level_requirement": "Internationalization (multi-language UI and localized date/time formatting)",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V9.7",
            "chapter": "Internationalization and Encoding",
            "section": "Unicode and Encoding Handling",
            "level": "L2",
            "requirement": "Properly handle Unicode, normalization, and encoding to prevent injection and XSS vulnerabilities across locales.",
            "relevance": "Directly relevant for multi-language UI and localized date/time handling to avoid injection vectors introduced by locale-specific encodings.",
            "integration_tips": "Normalize and canonicalize text inputs/outputs, apply proper encoding/escaping per output context, and validate locale-specific formats.",
            "priority": "High",
            "verification_method": "Test inputs with various Unicode characters and locale-specific formats to detect XSS or parsing issues."
          },
          {
            "standard": "NIST",
            "req_id": "SC-17",
            "chapter": "System and Communications Protection",
            "section": "Public Key Infrastructure and Localisation considerations",
            "level": null,
            "requirement": "Ensure localized data formats and time/date handling do not weaken security mechanisms and are consistently handled.",
            "relevance": "Ensures localized formatting does not break security checks like signature verification or token expiry calculations.",
            "integration_tips": "Use locale-aware libraries for date/time parsing, store timestamps in canonical format (UTC) internally, and format only at presentation layer.",
            "priority": "Medium",
            "verification_method": "Review date/time handling code and test across locales for consistent behavior of security-sensitive features."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.14.2.5",
            "chapter": "System Acquisition, Development and Maintenance",
            "section": "Secure development practices for localization",
            "level": null,
            "requirement": "Include security requirements for localized applications and data handling in development.",
            "relevance": "Mandates inclusion of localization security needs in development practices for internationalized UI.",
            "integration_tips": "Include localization security checks in SDLC, perform code reviews focused on encoding/formatting, and update test suites for locales.",
            "priority": "Low",
            "verification_method": "Inspect development checklists and localized test cases for security considerations."
          },
          {
            "standard": "OWASP",
            "req_id": "V9.1",
            "chapter": "Input Validation",
            "section": "Locale-aware Input Validation",
            "level": "L1",
            "requirement": "Validate and canonicalize input considering locale-specific encodings and formats.",
            "relevance": "Supports safe handling of user inputs in various languages and formats to prevent logic or parsing errors.",
            "integration_tips": "Implement validators that accept locale-specific formats but convert to canonical representations for processing and storage.",
            "priority": "Medium",
            "verification_method": "Run locale-specific input validation tests and check canonicalization outputs."
          }
        ]
      },
      {
        "high_level_requirement": "User interface features: responsive navigation, tables with pagination/sorting/filtering, calendar views, alerts/notifications, breadcrumbs",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "OWASP",
            "req_id": "V9.2",
            "chapter": "Injection Prevention and XSS",
            "section": "Cross-Site Scripting and Output Encoding",
            "level": "L1",
            "requirement": "Encode output and validate input to prevent XSS, especially in tables, filters, and dynamic navigation elements.",
            "relevance": "Directly applies to UI elements which render user-controlled content and are susceptible to XSS and injection attacks.",
            "integration_tips": "Escape/encode user data in the proper HTML/JS context, apply CSP headers, and avoid dangerous innerHTML patterns.",
            "priority": "Critical",
            "verification_method": "Perform XSS testing across UI components including pagination and dynamic filters."
          },
          {
            "standard": "NIST",
            "req_id": "SI-10",
            "chapter": "Software Integrity",
            "section": "Input Validation and Error Handling",
            "level": null,
            "requirement": "Validate input and handle errors gracefully to avoid exposing sensitive information in UI components.",
            "relevance": "Encourages sanitizing/filtering user inputs used for sorting/pagination and ensuring error messages do not leak internals.",
            "integration_tips": "Validate query parameters for pagination/sorting on server-side and sanitize user-visible error messages.",
            "priority": "High",
            "verification_method": "Review server-side validation for UI query parameters and inspect error messages for sensitive info."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.12.2.1",
            "chapter": "Protection from Malware",
            "section": "Controls for application security",
            "level": null,
            "requirement": "Apply secure development and application-level controls to mitigate common application threats.",
            "relevance": "Provides general secure development guidance for UI features to reduce vulnerabilities like XSS and CSRF.",
            "integration_tips": "Adopt secure UI development practices, include security tests in CI, and ensure third-party UI libs are vetted.",
            "priority": "Medium",
            "verification_method": "Check secure development artifacts, dependency scans, and UI security test results."
          },
          {
            "standard": "OWASP",
            "req_id": "V5.4",
            "chapter": "Session Management",
            "section": "CSRF Protections",
            "level": "L1",
            "requirement": "Implement CSRF protections for state-changing UI actions like shift creation or accept/reject.",
            "relevance": "Protects UI actions (calendar interactions, form submissions) from CSRF attacks that could create/change shifts.",
            "integration_tips": "Use anti-CSRF tokens for state-modifying requests and validate origin/referrer where appropriate.",
            "priority": "High",
            "verification_method": "Perform CSRF attack simulations against state-changing endpoints and verify tokens are required and validated."
          }
        ]
      },
      {
        "high_level_requirement": "Audit logging, legal documents availability (Privacy Policy, Terms of Service), and consent tracking",
        "requirement_id": null,
        "security_controls": [
          {
            "standard": "NIST",
            "req_id": "AU-2",
            "chapter": "Audit and Accountability",
            "section": "Audit Events",
            "level": null,
            "requirement": "Determine and log auditable events including user consent and policy acceptance.",
            "relevance": "Directly maps to logging consent events and availability of legal document acceptance records.",
            "integration_tips": "Log consent events with timestamp, user ID, document version, and store immutably; ensure logs are searchable for audit.",
            "priority": "Critical",
            "verification_method": "Review consent logs, verify they contain required fields, and test retrieval for audit scenarios."
          },
          {
            "standard": "ISO27001",
            "req_id": "A.18.1.4",
            "chapter": "Compliance",
            "section": "Privacy and Data Protection in Automated Processing",
            "level": null,
            "requirement": "Ensure compliance with privacy requirements and record legal consents and policy acknowledgments.",
            "relevance": "Establishes requirement to track legal consents and ensure privacy compliance for policy-driven behaviors.",
            "integration_tips": "Retain versions of legal documents, capture consent metadata, and provide user-facing access to documents and consent history.",
            "priority": "High",
            "verification_method": "Verify retention of document versions and sample consent records match user acknowledgments."
          },
          {
            "standard": "OWASP",
            "req_id": "V10.3",
            "chapter": "Logging and Monitoring",
            "section": "Consent and Legal Events Logging",
            "level": "L1",
            "requirement": "Log legal acknowledgements and consent events and ensure integrity of such records.",
            "relevance": "Specifies logging of legal events and integrity protections which are key to proving consent.",
            "integration_tips": "Use tamper-evident storage for consent records or append-only logs and ensure access controls over consent records.",
            "priority": "High",
            "verification_method": "Attempt to alter consent records in test environment and verify tamper detection and access controls."
          },
          {
            "standard": "NIST",
            "req_id": "PL-2",
            "chapter": "Planning",
            "section": "System and Communications Protection Policy",
            "level": null,
            "requirement": "Establish policies for handling legal documents and consent records.",
            "relevance": "Requires formal policies governing how legal documents and consent are managed within the system.",
            "integration_tips": "Develop policy that defines retention, access, and usage of consent records and implement controls accordingly.",
            "priority": "Medium",
            "verification_method": "Review policy documentation and evidence of policy enforcement in system practices."
          }
        ]
      }
    ],
    "cross_functional_controls": [
      {
        "control_name": "Logging and Audit Trails",
        "description": "Centralized, tamper-resistant logging of security-relevant events including authentication, authorization changes, exports, consent events, solver interactions, and algorithmic outputs.",
        "applies_to": [
          "All requirements (global)",
          "Audit logging features",
          "Automated assignment and solver integration",
          "Data export and profile changes"
        ],
        "implementation_guidance": "Implement an append-only or integrity-protected logging system (WORM or signed logs), centralize logs with access controls, and define retention and review processes. Ensure logs capture actor, timestamp, action, target resource and before/after states where applicable."
      },
      {
        "control_name": "Encryption in Transit and at Rest",
        "description": "Protect sensitive data (credentials, PII, solver payloads, exported files) with strong encryption during transit and at rest.",
        "applies_to": [
          "Authentication flows",
          "External API integrations",
          "Asynchronous job payloads",
          "Exported files and sensitive data stores"
        ],
        "implementation_guidance": "Use TLS with current best-practice cipher suites for all external and internal communication; encrypt data at rest with managed keys and apply field-level encryption for highly sensitive fields. Rotate keys and manage access to encryption keys via KMS with strict IAM controls."
      },
      {
        "control_name": "Input Validation and Output Encoding",
        "description": "Canonicalize, validate and sanitize inputs; encode outputs according to their context to prevent injection (XSS, SQLi) and logic bypass.",
        "applies_to": [
          "UI components (tables, filters, calendar)",
          "Shift/skill/leave creation and updates",
          "API payloads and external solver responses"
        ],
        "implementation_guidance": "Implement server-side canonicalization and validation for all inputs, apply context-aware encoding on outputs, and use schema validation for APIs. Include locale-aware validation for internationalized inputs and test with Unicode edge-cases."
      },
      {
        "control_name": "Access Control and Authorization",
        "description": "Centralized enforcement of role-based and attribute-based access controls, with least privilege and tenant scoping.",
        "applies_to": [
          "RBAC and user status",
          "Company CRUD/multi-tenant scoping",
          "Profile and assignment management",
          "Export and administrative functions"
        ],
        "implementation_guidance": "Use a centralized authorization service or middleware enforcing RBAC/ABAC checks at every API entrypoint, include tenant_id in access decisions, and implement policy management and review processes to keep permissions up-to-date."
      },
      {
        "control_name": "Privacy and Data Minimization",
        "description": "Assess and minimize personal data collection (preferences, leave reasons) and protect special categories of data with additional safeguards.",
        "applies_to": [
          "Preferences and leave management",
          "Exports and reporting",
          "Algorithmic scoring and solver inputs/outputs"
        ],
        "implementation_guidance": "Conduct PIAs for sensitive data, apply pseudonymization or redaction for exports, limit retention periods, and restrict access to need-to-know personnel. Record legal basis and user consent where required."
      }
    ],
    "recommended_asvs_level": "L2"
  },
  "tasks": [
    {
      "name": "map_security_controls",
      "raw": "{\n  \"requirements_mapping\": [\n    {\n      \"high_level_requirement\": \"User registration with email verification and account lifecycle management\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.1\",\n          \"chapter\": \"Authentication Verification\",\n          \"section\": \"Account Creation and Verification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify new user registrations via email or other out-of-band mechanisms to ensure account ownership.\",\n          \"relevance\": \"Directly addresses the need to confirm user ownership of email accounts during registration and reduces fraudulent account creation. It maps to the verification and lifecycle control aspects of the requirement.\",\n          \"integration_tips\": \"Implement email confirmation tokens that are single-use and time-limited; require confirmation before enabling privileged features. Tie the verification status to account state in the user lifecycle management flows.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review implementation of email verification flow, inspect token properties (single-use, expiry), and test account behavior before and after verification.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-2\",\n          \"chapter\": \"Account Management\",\n          \"section\": \"Account Lifecycle\",\n          \"level\": null,\n          \"requirement\": \"The organization manages information system accounts, including account creation, enablement, modification, disabling, and removal.\",\n          \"relevance\": \"Specifies lifecycle operations which map to registration, activation, suspension, and removal of user accounts required by the feature.\",\n          \"integration_tips\": \"Establish automated workflows and approval steps for account creation and deactivation; maintain authoritative records of account states and reason codes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Audit account management procedures, review logs of account create/disable/delete events, and verify policy enforcement through test cases.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.1\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"User registration and de-registration\",\n          \"level\": null,\n          \"requirement\": \"A formal user registration and de-registration process shall be implemented to enable assignment of access rights.\",\n          \"relevance\": \"Mandates a formal process for onboarding/offboarding which ensures registration ties into access rights and lifecycle.\",\n          \"integration_tips\": \"Document procedures for registration and de-registration, include steps for verification, approvals, and role assignment during onboarding/offboarding.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect documented procedures and sample records for adherence; validate that de-registration revokes access promptly.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-5\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Authenticator Management\",\n          \"level\": null,\n          \"requirement\": \"Manage, distribute, and revoke credentials and authenticators throughout the account lifecycle.\",\n          \"relevance\": \"Addresses credential issuance and revocation tied to account lifecycle which complements email verification and lifecycle management.\",\n          \"integration_tips\": \"Implement credential issuance policies, track authenticator provenance, and ensure revocation paths (e.g., when email changes or accounts disabled).\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review credential lifecycle processes, test revocation and re-issuance flows, and inspect logs for authenticator events.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Authentication and single sign-on via credentials and Google OAuth\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.2\",\n          \"chapter\": \"Authentication Verification\",\n          \"section\": \"Credential & Third-party Authentication\",\n          \"level\": \"L2\",\n          \"requirement\": \"Support secure authentication including credential-based and federated authentication (OAuth2, OpenID Connect) with proper validation and token handling.\",\n          \"relevance\": \"Directly covers secure handling of credential-based login and federated SSO (Google OAuth) required by the requirement.\",\n          \"integration_tips\": \"Use well-vetted OAuth2/OpenID Connect libraries, validate ID tokens server-side, enforce scopes and claims, and handle token storage securely.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review OAuth/OIDC implementation, verify token validation, scope restrictions, and perform token replay/forgery tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-2\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Identification and Authentication (Organizational Users)\",\n          \"level\": null,\n          \"requirement\": \"Identify and authenticate organizational users using authenticators and, where appropriate, federated identity mechanisms.\",\n          \"relevance\": \"Provides organizational control guidance for authenticating users via both local credentials and federated providers like Google.\",\n          \"integration_tips\": \"Define acceptable authenticators, document trust relationships with identity providers, and require secure channels for federation.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Examine policies for federated identity, test SSO flows for proper authentication, and verify credential handling meets organizational standards.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.4.2\",\n          \"chapter\": \"System and Application Access Control\",\n          \"section\": \"Secure log-on procedures\",\n          \"level\": null,\n          \"requirement\": \"Secure log-on procedures shall be implemented, where appropriate supporting single sign-on and federated identity.\",\n          \"relevance\": \"Requires secure log-on procedures and supports SSO, aligning with the need for secure Google OAuth integration.\",\n          \"integration_tips\": \"Implement SSO with secure session establishment, multi-factor option where required, and maintain centralized session policies.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Validate the log-on workflow, verify session creation after SSO, and review session timeout and logout behavior.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.3\",\n          \"chapter\": \"Session Management\",\n          \"section\": \"OAuth and Token Handling\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure tokens are validated, scoped, stored securely, and revoked when necessary for SSO and OAuth use-cases.\",\n          \"relevance\": \"Covers secure token lifecycle for SSO, ensuring tokens from Google are handled safely and revocable.\",\n          \"integration_tips\": \"Use secure token storage (HTTP-only cookies or secure token stores), implement token revocation and rotation, and minimize token scopes.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect token storage methods, test revocation and refresh flows, and review scope requests during OAuth handshake.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Password reset and account recovery\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V2.3\",\n          \"chapter\": \"Authentication Verification\",\n          \"section\": \"Password Reset & Account Recovery\",\n          \"level\": \"L1\",\n          \"requirement\": \"Implement secure password reset flows using verified contact channels and protections against account takeover (OTP, expiring tokens, rate limiting).\",\n          \"relevance\": \"Directly maps to the need for secure password reset flows and protections against abuse or account takeover.\",\n          \"integration_tips\": \"Use single-use, short-lived reset tokens delivered via verified channels, add rate limiting and anomaly detection on reset attempts.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test reset flows for token reuse, expiry, and ensure resets require verified contact; perform abuse-case testing.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"IA-5 (5)\",\n          \"chapter\": \"Identification and Authentication\",\n          \"section\": \"Password and Recovery Credential Management\",\n          \"level\": null,\n          \"requirement\": \"Establish policies and mechanisms for managing password resets and recovery in a manner that resists credential compromise.\",\n          \"relevance\": \"Provides organizational expectations for secure recovery procedures to reduce risk of credential compromise.\",\n          \"integration_tips\": \"Document recovery procedures, require multi-step verification for high-risk account changes, and log recovery events for auditing.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review recovery policies, validate multi-step verification for sensitive accounts, and inspect logs of recovery events.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.1\",\n          \"chapter\": \"Session Management\",\n          \"section\": \"One-time tokens and recovery tokens\",\n          \"level\": \"L2\",\n          \"requirement\": \"Recovery tokens and one-time use links must be single-use, short-lived, and protected against replay attacks.\",\n          \"relevance\": \"Specifies properties of recovery tokens which mitigate replay and abuse in password reset flows.\",\n          \"integration_tips\": \"Implement cryptographically-random tokens, mark tokens used after redemption, and expire tokens quickly (e.g., 15 minutes).\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect token generation and storage, attempt token replay tests, and verify expiry enforcement.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.3\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"Management of privileged access rights\",\n          \"level\": null,\n          \"requirement\": \"Ensure controlled management of authentication data and password resets, including policies and procedures.\",\n          \"relevance\": \"Supports governance over reset and recovery processes to prevent misuse, particularly for privileged accounts.\",\n          \"integration_tips\": \"Apply stricter reset controls for privileged roles, require manual approvals where appropriate, and log privileged resets.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review privileged reset controls, sampling of privileged account reset logs, and policy documentation.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Role-based access control (ADMIN, MANAGER, EMPLOYEE) and user status management\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.1\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Role-based Access Control\",\n          \"level\": \"L2\",\n          \"requirement\": \"Enforce role-based access control with least privilege and separation of duties; implement role checks on both client and server sides.\",\n          \"relevance\": \"Directly prescribes RBAC enforcement necessary for ADMIN/MANAGER/EMPLOYEE roles and ensures server-side enforcement to prevent privilege escalation.\",\n          \"integration_tips\": \"Centralize role checks in authorization middleware, enforce least privilege for each role, and prevent client-side-only enforcement.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review role definitions, test access control enforcement across endpoints for each role, and perform privilege escalation attempts.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-3\",\n          \"chapter\": \"Access Enforcement\",\n          \"section\": \"Access Control Policy and Enforcement\",\n          \"level\": null,\n          \"requirement\": \"Enforce access restrictions and ensure users are granted access only to authorized functions and data.\",\n          \"relevance\": \"Mandates access enforcement which supports role-based controls and status-based access (active/disabled/suspended).\",\n          \"integration_tips\": \"Implement centralized access control checks, map roles to permissions, and enforce account status checks before granting access.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect policy-to-implementation mapping, run access matrix tests, and verify that disabled users cannot access resources.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.1.2\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"Access Control Policy\",\n          \"level\": null,\n          \"requirement\": \"An access control policy based on business and security requirements shall be established, documented, and reviewed.\",\n          \"relevance\": \"Requires documented access control policies to define role responsibilities and status management.\",\n          \"integration_tips\": \"Create and maintain an access control policy describing roles, permissions, and lifecycle procedures; align with HR onboarding/offboarding.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review access control policy documentation and interview personnel to confirm implementation.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-2 (3)\",\n          \"chapter\": \"Account Management\",\n          \"section\": \"Account Status and Automation\",\n          \"level\": null,\n          \"requirement\": \"Automate account status changes (enable/disable) and maintain authoritative account state.\",\n          \"relevance\": \"Supports user status management by prescribing automation and authoritative state control to prevent orphaned or active-but-disabled accounts.\",\n          \"integration_tips\": \"Integrate with HR systems for status changes, implement automated disabling for inactivity or termination, and record change reasons.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Audit automation integrations, simulate HR-driven status changes, and verify system enforces new statuses immediately.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User profile management and company assignment\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.6\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Authorization for Profile and Resource Assignment\",\n          \"level\": \"L1\",\n          \"requirement\": \"Verify that updates to user profiles and assignments (e.g., company membership) are protected by server-side authorization checks.\",\n          \"relevance\": \"Directly addresses the need to protect profile updates and company assignments from unauthorized changes.\",\n          \"integration_tips\": \"Enforce server-side permission checks tied to role and ownership; validate company assignment changes against authoritative sources.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review code paths for profile update endpoints, perform unauthorized modification tests, and inspect audit logs.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6\",\n          \"chapter\": \"Least Privilege\",\n          \"section\": \"Least Privilege and Separation of Duties\",\n          \"level\": null,\n          \"requirement\": \"Employ least privilege mechanisms for user profile updates and assignment of organizational attributes.\",\n          \"relevance\": \"Ensures only authorized personnel or processes can assign users to companies or alter profile attributes, reducing risk of misuse.\",\n          \"integration_tips\": \"Assign minimal privileges to services and operators that manage profile/company attributes and require approvals for sensitive changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check privilege assignments for profile-management components and test unauthorized assignment attempts.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.2\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"User access provisioning\",\n          \"level\": null,\n          \"requirement\": \"A formal process for granting and revoking access rights and attributes should be followed, including assignment to organizational units.\",\n          \"relevance\": \"Requires formal provisioning processes which should include company assignment and profile attribute handling.\",\n          \"integration_tips\": \"Implement provisioning workflows with approvals and record keeping, and enforce verification of company membership during assignment.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review provisioning records and test the end-to-end process for correctness and auditability.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.1\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Trust Boundaries and Multi-tenancy\",\n          \"level\": \"L2\",\n          \"requirement\": \"Design systems to maintain clear trust boundaries so profile attributes that determine access are authoritative and validated.\",\n          \"relevance\": \"Ensures profile attributes like company assignment are authoritative and cannot be spoofed to gain access across boundaries.\",\n          \"integration_tips\": \"Store canonical profile attributes in a trusted service or database, and validate tokens/claims used to assert company membership.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect trust boundary design, review data flow diagrams, and test for attribute spoofing.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Company CRUD and multi-tenant scoping of data\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V14.1\",\n          \"chapter\": \"Multi-Tenancy\",\n          \"section\": \"Tenant Isolation and Data Separation\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure logical separation of tenant data and enforce access controls to prevent cross-tenant data leakage.\",\n          \"relevance\": \"Directly addresses multi-tenant scoping and the need to prevent cross-company data access when performing CRUD operations.\",\n          \"integration_tips\": \"Enforce tenant checks at data access layer and include tenant_id in every query predicate; implement row-level security where possible.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review data access code, run multi-tenant isolation tests (attempt cross-tenant reads/writes), and inspect database policies.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-7\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Boundary Protection\",\n          \"level\": null,\n          \"requirement\": \"Implement controls to separate and protect system components and data flows; apply isolation as necessary.\",\n          \"relevance\": \"Supports the requirement to protect and isolate tenant data by prescribing boundary and isolation controls.\",\n          \"integration_tips\": \"Segment logical components by tenant boundaries, apply network and access controls for management interfaces, and minimize shared state.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Assess architecture diagrams, test separation of management interfaces, and review network segmentation controls.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.13.2.1\",\n          \"chapter\": \"Communications Security\",\n          \"section\": \"Information transfer policies and procedures\",\n          \"level\": null,\n          \"requirement\": \"Information transfer and segregation mechanisms should be defined to protect the exchange and separation of information between entities.\",\n          \"relevance\": \"Requires documented segregation mechanisms relevant to multi-tenant CRUD operations and data transfer between tenants.\",\n          \"integration_tips\": \"Document transfer policies, implement enforcement controls for inter-tenant transfers, and require approvals for cross-tenant data export.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review policy documents and sample transfer approvals; test that transfers are blocked or logged when not permitted.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6 (10)\",\n          \"chapter\": \"Least Privilege\",\n          \"section\": \"Tenant-specific Access Controls\",\n          \"level\": null,\n          \"requirement\": \"Apply tenant-specific access restrictions and scoping to limit access to tenant resources.\",\n          \"relevance\": \"Specifies tailoring of least-privilege controls to tenant-specific resources which is essential for company CRUD scoping.\",\n          \"integration_tips\": \"Map permissions to tenant-scoped roles, implement enforcement in APIs and DB, and maintain per-tenant admin scopes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Verify per-tenant role mappings, test scoped permissions, and run negative tests attempting cross-tenant CRUD.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Shift type management with time ranges and required skills\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.3\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Data Validation and Business Logic Integrity\",\n          \"level\": \"L1\",\n          \"requirement\": \"Validate business input (e.g., time ranges, required skills) server-side to prevent logic abuse and ensure data integrity.\",\n          \"relevance\": \"Protects shift-type definitions from malformed or malicious inputs that could break scheduling logic or grant unauthorized capabilities.\",\n          \"integration_tips\": \"Implement strict server-side validation for time ranges, enforce constraints (no overlap, valid skill IDs), and canonicalize inputs.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review validation code, perform fuzzing of time/skill inputs, and check DB for invalid persisted records.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"Information Integrity\",\n          \"section\": \"Input Validation and Integrity Verification\",\n          \"level\": null,\n          \"requirement\": \"Employ integrity checks and input validation to ensure data consistency and correctness.\",\n          \"relevance\": \"Ensures integrity of shift-type data and supports detection of tampering or corruption.\",\n          \"integration_tips\": \"Apply schema validation, integrity checksums where necessary, and enforce business rule validation in services.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect schema validations, run integrity checks in test harness, and verify constraints via unit tests.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.2\",\n          \"chapter\": \"Operational Procedures and Responsibilities\",\n          \"section\": \"Change Management and Data Integrity\",\n          \"level\": null,\n          \"requirement\": \"Changes to systems and data (including configuration of business objects like shift types) should be controlled to preserve integrity.\",\n          \"relevance\": \"Requires controlled change processes for shift-type configurations to prevent unauthorized or erroneous changes.\",\n          \"integration_tips\": \"Use controlled deployment/change processes for shift-type schema or rule changes, include review/approval steps for business-impacting changes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review change records for shift-type modifications and check that approvals were captured.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V6.4\",\n          \"chapter\": \"Business Logic\",\n          \"section\": \"Enforce Business Rules\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure business logic (e.g., required skills per shift type) is enforced server-side and cannot be bypassed by client manipulation.\",\n          \"relevance\": \"Directly ensures shift-type business rules are enforced server-side to prevent client-side tampering.\",\n          \"integration_tips\": \"Centralize business rules in service layer, implement tests for rule enforcement, and prevent direct DB writes that bypass logic.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt to bypass rules via direct API/DB calls and validate server rejects inconsistent or unauthorized changes.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Manual shift creation, update, deletion, and calendar presentation\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.4\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Authorization for Data Modification\",\n          \"level\": \"L1\",\n          \"requirement\": \"Authorize all modification endpoints and verify checks server-side to prevent unauthorized creation, update, or deletion.\",\n          \"relevance\": \"Ensures only authorized users can create/update/delete shifts, which is central to manual shift management.\",\n          \"integration_tips\": \"Protect endpoints via role checks and ownership checks; ensure calendar UI actions invoke server-side authorization.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test role-based access to create/update/delete endpoints, and attempt unauthorized operations.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"Determine and log auditable events including create, modify, delete operations.\",\n          \"relevance\": \"Records manual shift changes for accountability and incident investigation as required by the feature.\",\n          \"integration_tips\": \"Log change events with user, timestamp, before/after state and reason; protect logs from tampering.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review audit logs for shift CRUD events and validate completeness and integrity.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.1\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Event Logging\",\n          \"level\": null,\n          \"requirement\": \"Event logs recording user activities, exceptions, and security events shall be produced and retained.\",\n          \"relevance\": \"Mandates retaining logs for manual shift operations and UI interactions for compliance and troubleshooting.\",\n          \"integration_tips\": \"Define retention periods, ensure secure storage, and include calendar-related events as auditable actions.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect logs for the required events, retention configuration, and access controls around logs.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-6\",\n          \"chapter\": \"Least Privilege\",\n          \"section\": \"Enforce least privilege on modification endpoints\",\n          \"level\": null,\n          \"requirement\": \"Restrict modify/delete/create operations to roles with explicit permissions.\",\n          \"relevance\": \"Supports limiting who may perform manual shift operations to defined roles, reducing misuse risk.\",\n          \"integration_tips\": \"Map CRUD permissions to ADMIN/MANAGER roles and apply checks in API and UI layers.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review permission mappings and test that lower-privileged roles cannot modify shifts.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Shift status tracking and filtering (SCHEDULED, CONFIRMED, COMPLETED, CANCELLED, NO_SHOW)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-6\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Review, Analysis, and Reporting\",\n          \"level\": null,\n          \"requirement\": \"Regularly review and analyze audit records for indications of unauthorized activity or changes.\",\n          \"relevance\": \"Encourages review of status transitions to detect unauthorized or anomalous status changes such as NO_SHOW flags being manipulated.\",\n          \"integration_tips\": \"Log status transitions with actor and context, implement periodic reviews and alerts for unusual patterns.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review audit processes, sample status transition logs, and ensure alerts are configured for anomalies.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.1\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Tamper-resistant Logging\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure logs and status transitions are recorded in tamper-resistant logs and integrity-protected storage.\",\n          \"relevance\": \"Protects the integrity of status history to provide trustworthy records for scheduling outcomes.\",\n          \"integration_tips\": \"Use append-only logs or secure log storage with integrity checks and restrict log modification privileges.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect log storage protections and attempt to modify logs; verify detection of tamper attempts.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.4.3\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Administrator and Operator Logs\",\n          \"level\": null,\n          \"requirement\": \"Administrator and operator activities, including status changes, should be logged and reviewed.\",\n          \"relevance\": \"Mandates logging of operator actions affecting shift statuses to maintain accountability.\",\n          \"integration_tips\": \"Capture operator ID and reason for manual status changes, and include review procedures for sensitive transitions.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check logs for operator entries and review processes for manual status changes.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"CM-3\",\n          \"chapter\": \"Configuration Management\",\n          \"section\": \"Configuration Change Control\",\n          \"level\": null,\n          \"requirement\": \"Control and document changes to system configuration and state transitions.\",\n          \"relevance\": \"Ensures system state transitions for shift statuses are controlled and documented, preventing unauthorized state changes.\",\n          \"integration_tips\": \"Treat status transition rules as configuration items, version them, and require approvals for rule changes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review change records for status transition rule updates and verify approvals were enforced.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Automated shift assignment (auto-assignment) via external solver with preview and accept/reject\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V13.1\",\n          \"chapter\": \"API Security\",\n          \"section\": \"Secure API Consumption and Third-party Integration\",\n          \"level\": \"L2\",\n          \"requirement\": \"Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.\",\n          \"relevance\": \"Applies to integrating with external solver for auto-assignment and ensuring previews and accepts/rejects are securely transmitted and validated.\",\n          \"integration_tips\": \"Use mutual TLS or OAuth for API calls, validate solver responses before applying changes, and implement signed payloads or record hashes for integrity.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review API authentication configuration, test injection or malformed response handling, and verify server validates solver outputs.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SA-9\",\n          \"chapter\": \"System and Services Acquisition\",\n          \"section\": \"External System Interactions and API Security\",\n          \"level\": null,\n          \"requirement\": \"Ensure that external interfaces are secured and that integration with external systems follows organizational policies.\",\n          \"relevance\": \"Mandates governance around external solver usage and how solver results are accepted into the system.\",\n          \"integration_tips\": \"Define security requirements in supplier agreements, document expected APIs, and ensure change management for solver integration.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review supplier contracts, interface security documentation, and test compliance with the defined integration policy.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.15.1.1\",\n          \"chapter\": \"Supplier Relationships\",\n          \"section\": \"Information Security in Supplier Relationships\",\n          \"level\": null,\n          \"requirement\": \"Establish controls for supplier relationships including security requirements for shared data and interfaces.\",\n          \"relevance\": \"Supports contractual and security requirements for using an external solver service for assignments.\",\n          \"integration_tips\": \"Include SLAs and security requirements in supplier agreements, require proof of secure handling, and define incident responsibilities.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect supplier agreements and evidence of supplier security practices and audits.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-8\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Transmission Confidentiality and Integrity\",\n          \"level\": null,\n          \"requirement\": \"Protect the confidentiality and integrity of information during transmission to external services.\",\n          \"relevance\": \"Ensures solver payloads and returned solutions are transmitted securely to prevent tampering or eavesdropping.\",\n          \"integration_tips\": \"Use TLS with strong ciphers, enforce certificate validation, and consider payload signing for end-to-end integrity.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect TLS configuration, perform MITM tests, and verify payload signatures if implemented.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Real-time asynchronous job processing, polling, and solution status tracking\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-13\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Use of Cryptography\",\n          \"level\": null,\n          \"requirement\": \"Use cryptography to protect data in transit and at rest in asynchronous messaging systems.\",\n          \"relevance\": \"Secures messages and job payloads in transit and at rest as they move through job queues and polling endpoints.\",\n          \"integration_tips\": \"Encrypt messages in transit with TLS and at rest with appropriate encryption keys; protect queue access with authentication.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review encryption configurations for queues and endpoints, and test interception attempts.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V14.3\",\n          \"chapter\": \"Backend and Infrastructure\",\n          \"section\": \"Secure Asynchronous Processing\",\n          \"level\": \"L2\",\n          \"requirement\": \"Ensure job queues and background processing components enforce authentication, authorization, and message validation.\",\n          \"relevance\": \"Specifies securing job processing elements to ensure only authorized jobs are enqueued/processed and status updates are validated.\",\n          \"integration_tips\": \"Authenticate producers/consumers, validate job payloads schema, and authorize status-change operations based on role.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect queue ACLs, test unauthorized enqueue/dequeue attempts, and validate payload schema checks.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.1.1\",\n          \"chapter\": \"Operational Procedures\",\n          \"section\": \"Documented operating procedures for operations including job processing\",\n          \"level\": null,\n          \"requirement\": \"Operational procedures should define and control background processing and message handling.\",\n          \"relevance\": \"Mandates documented procedures around real-time job processing and polling operations.\",\n          \"integration_tips\": \"Document job lifecycle, polling intervals, retry limits, and error handling; include operational runbooks for failures.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review operational procedures and perform runbook drills to validate behavior.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-7\",\n          \"chapter\": \"Software, Firmware, and Information Integrity\",\n          \"section\": \"Integrity Check Mechanisms\",\n          \"level\": null,\n          \"requirement\": \"Implement integrity checks for data processed asynchronously to detect tampering or corruption.\",\n          \"relevance\": \"Ensures the integrity of solutions and job payloads is verifiable during the asynchronous processing lifecycle.\",\n          \"integration_tips\": \"Include checksums, signatures, or message authentication codes (MACs) on job payloads and verify them before processing.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect integrity verification code paths and attempt to submit tampered payloads to confirm detection.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Solution scoring, constraint violation analysis, and reporting\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V11.2\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Algorithmic Transparency and Audit Trails\",\n          \"level\": \"L2\",\n          \"requirement\": \"Log inputs, configuration, and outputs of automated decision algorithms to support auditing and explainability.\",\n          \"relevance\": \"Directly applies to capturing evidence of scoring and constraint violations for review and dispute resolution.\",\n          \"integration_tips\": \"Record solver inputs, scoring parameters, and output diffs; store logs securely with access controls for auditors.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Check that algorithmic inputs/outputs are logged and can be correlated to user-visible reports.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PM-22\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Algorithmic Accountability\",\n          \"level\": null,\n          \"requirement\": \"Document and analyze how automated solutions are validated, scored, and how violations are reported.\",\n          \"relevance\": \"Mandates documentation and governance around automated scoring which supports trustworthy reporting.\",\n          \"integration_tips\": \"Maintain documentation of scoring methodology, test datasets, and validation results; define reporting formats and owners.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review documentation and validation artifacts and confirm reporting pipelines produce expected outputs.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.\",\n          \"relevance\": \"Ensures scoring and reporting practices comply with privacy and regulatory requirements, especially if personal data influences scores.\",\n          \"integration_tips\": \"Assess privacy impacts of scoring data, avoid unnecessary personal data in scoring logs, and provide explanations where decisions affect individuals.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review privacy assessments and validate that logs/reporting exclude unnecessary personal data or are appropriately protected.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-12\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Generation\",\n          \"level\": null,\n          \"requirement\": \"Generate audit records for security-relevant events including algorithm outputs and violations.\",\n          \"relevance\": \"Ensures scoring and violation events are auditable and recorded for security/review purposes.\",\n          \"integration_tips\": \"Define which scoring events are auditable, include identifiers correlating to inputs, and protect audit logs from tampering.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect audit logs for scoring events and test correlation between algorithm runs and generated logs.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Shift preferences management (date-specific desired/undesired) and preference tracking\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.\",\n          \"relevance\": \"Preferences may be personal data; this control ensures processing complies with privacy requirements and is documented.\",\n          \"integration_tips\": \"Limit retention of preference data, document how preferences are used in automated assignment, and expose preference reports for user review.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review privacy documentation and confirm preference handling is aligned with policy and retention rules.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-4\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Privacy Impact Assessment\",\n          \"level\": null,\n          \"requirement\": \"Conduct privacy impact assessments for systems processing personal preferences.\",\n          \"relevance\": \"Requires assessing privacy risks around storing and using user shift preferences.\",\n          \"integration_tips\": \"Perform PIA to identify sensitive preferences (e.g., religious holidays) and apply minimization or extra protections as needed.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Provide PIA documentation and evidence of mitigations implemented based on findings.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.5\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Privacy by Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Design systems to minimize collection of personal data and protect user preferences and privacy.\",\n          \"relevance\": \"Encourages design choices that limit privacy exposure for preference tracking features.\",\n          \"integration_tips\": \"Collect only necessary preference attributes, provide user controls to view/edit/delete preferences, and protect data at rest.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect data schemas and UI controls for preference management and test deletion/exports to ensure removal.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-19\",\n          \"chapter\": \"Access Control\",\n          \"section\": \"Access Control for Mobile Devices and User Attributes\",\n          \"level\": null,\n          \"requirement\": \"Protect user attribute data including preferences with appropriate access controls.\",\n          \"relevance\": \"Ensures preferences are only visible and editable by authorized entities to prevent privacy violations.\",\n          \"integration_tips\": \"Apply attribute-level ACLs so preferences are scoped to the user or authorized managers; restrict export of sensitive preferences.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Test access to preference records from different roles and verify unauthorized reads are blocked.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Unavailable dates and leave management (multiple leave types, date ranges, reasons)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.\",\n          \"relevance\": \"Leave reasons may contain sensitive personal data (e.g., medical reasons); this control ensures privacy compliance for processing and storage.\",\n          \"integration_tips\": \"Classify leave data sensitivity, apply stricter access controls for medical leave, and document legal bases for processing.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review data classification, access controls, and privacy handling for leave data.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-4\",\n          \"chapter\": \"Planning\",\n          \"section\": \"Privacy Impact Assessment\",\n          \"level\": null,\n          \"requirement\": \"Conduct privacy impact assessments when processing sensitive personal data such as health-related leave.\",\n          \"relevance\": \"Requires evaluating privacy risks posed by collecting leave reasons and ranges and drives protective controls.\",\n          \"integration_tips\": \"Conduct PIA focusing on special categories of data, implement minimization, and consider pseudonymization where possible.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Provide PIA output and evidence of mitigations (pseudonymization, restricted access).\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"MP-6\",\n          \"chapter\": \"Media Protection\",\n          \"section\": \"Sanitization and Protection of Sensitive Data\",\n          \"level\": null,\n          \"requirement\": \"Protect sensitive personal data at rest and in transit, and sanitize when exporting or transferring.\",\n          \"relevance\": \"Applies to exporting or transferring leave records and ensuring sensitive reasons are sanitized or redacted.\",\n          \"integration_tips\": \"Encrypt leave records at rest, apply field-level redaction for exports, and limit who can download leave data.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Inspect encryption at rest, review export sanitization routines, and test role-based export restrictions.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V1.5\",\n          \"chapter\": \"Architecture and Design\",\n          \"section\": \"Privacy by Design\",\n          \"level\": \"L1\",\n          \"requirement\": \"Implement privacy-by-design for sensitive employee data, minimizing collection and ensuring secure storage.\",\n          \"relevance\": \"Reinforces data minimization and secure handling for leave management modules.\",\n          \"integration_tips\": \"Collect only required fields for leave processing, provide limited retention, and notify users about purpose and retention periods.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review UI/data collection forms and retention policies; verify secure storage controls in place.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Skills management and skill-based matching for assignments\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-3 (5)\",\n          \"chapter\": \"Access Enforcement\",\n          \"section\": \"Attribute-Based Access Control (ABAC)\",\n          \"level\": null,\n          \"requirement\": \"Support attribute-based access control when access decisions depend on attributes such as skills.\",\n          \"relevance\": \"Directly enables using skills as attributes for matching and access decisions in assignment processes.\",\n          \"integration_tips\": \"Model skills as authoritative attributes, implement ABAC policies for matching, and ensure attribute sources are validated.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review ABAC policies and test that assignments respect skill attribute constraints.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V4.2\",\n          \"chapter\": \"Access Control Verification\",\n          \"section\": \"Attribute-based Authorization\",\n          \"level\": \"L2\",\n          \"requirement\": \"Implement and verify attribute-based authorization where access and matching logic relies on user attributes (skills).\",\n          \"relevance\": \"Ensures matching logic based on skills is enforced and protected from manipulation.\",\n          \"integration_tips\": \"Centralize attribute evaluation, prevent client-side overrides of attributes, and audit attribute changes.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt to alter skill attributes via API/UI and confirm authorization prevents incorrect matching.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.9.2.2\",\n          \"chapter\": \"User Access Management\",\n          \"section\": \"User Access Provisioning\",\n          \"level\": null,\n          \"requirement\": \"Provision access and attributes carefully to ensure accurate assignment of skills and privileges.\",\n          \"relevance\": \"Requires controlled provisioning of skill attributes so matching is based on trusted data.\",\n          \"integration_tips\": \"Use administrative workflows for adding/removing skills, record provenance, and require approvals for critical attributes.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review provisioning logs and sample attribute provenance to ensure correct assignment.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PM-11\",\n          \"chapter\": \"Program Management\",\n          \"section\": \"Data Quality and Integrity\",\n          \"level\": null,\n          \"requirement\": \"Ensure data used for decision making (e.g., skills) is accurate and maintained.\",\n          \"relevance\": \"Ensures matching results are reliable by mandating data quality controls around skills datasets.\",\n          \"integration_tips\": \"Implement periodic reviews and validation of skill records and provide user workflows to correct inaccuracies.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check data quality reports and validation procedures for skill records.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Export of data (shifts, users, companies, skills, shift types, preferences, unavailable dates) in CSV/XLSX\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"MP-6\",\n          \"chapter\": \"Media Protection\",\n          \"section\": \"Sanitization and Protection of Sensitive Data\",\n          \"level\": null,\n          \"requirement\": \"Protect sensitive data when exporting; sanitize or redact as required before transfer or export.\",\n          \"relevance\": \"Directly applicable to preventing leakage of sensitive fields during data exports.\",\n          \"integration_tips\": \"Implement export templates that redact PII or sensitive fields by role, and require explicit authorization for exports containing sensitive data.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Test exports for redaction correctness across roles and ensure sanitized outputs do not expose sensitive data.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V3.9\",\n          \"chapter\": \"Data Protection\",\n          \"section\": \"Export Controls and Data Leakage Prevention\",\n          \"level\": \"L2\",\n          \"requirement\": \"Implement controls and authorization checks on data export features and ensure exported files do not leak sensitive data.\",\n          \"relevance\": \"Specifies authorization and DLP measures for export functionality requested.\",\n          \"integration_tips\": \"Require role-based export permissions, log all export operations, and throttle/alert on large exports to prevent exfiltration.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review export permission mappings, audit logs of exports, and perform attempts to export restricted datasets.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.8.2.3\",\n          \"chapter\": \"Asset Management\",\n          \"section\": \"Handling of Assets and Sensitive Information\",\n          \"level\": null,\n          \"requirement\": \"Procedures for handling and transferring information assets including exports should be implemented.\",\n          \"relevance\": \"Requires formal handling procedures for exported data assets to ensure protection and accountability.\",\n          \"integration_tips\": \"Document export procedures, include approval steps for sensitive exports, and archive export copies securely if retained.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect documented procedures and sample approvals for export actions.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AC-17\",\n          \"chapter\": \"Remote Access\",\n          \"section\": \"Controls for Remote Connection and Transfer\",\n          \"level\": null,\n          \"requirement\": \"Control remote access and transfers including file exports to prevent data exfiltration.\",\n          \"relevance\": \"Applies to how exported files are transferred or downloaded to user endpoints and helps prevent exfiltration.\",\n          \"integration_tips\": \"Restrict export downloads to secure channels, enforce endpoint device checks or warn about saving sensitive files, and record provenance.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Test downloads over remote sessions and verify transfer controls are enforced.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"External API integration with Timefold solver including payload generation and solution parsing\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V13.1\",\n          \"chapter\": \"API Security\",\n          \"section\": \"Secure API Consumption and Third-party Integration\",\n          \"level\": \"L2\",\n          \"requirement\": \"Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.\",\n          \"relevance\": \"Directly addresses securing the Timefold solver integration, verifying payloads, and safely parsing responses.\",\n          \"integration_tips\": \"Apply strong authentication to the Timefold API, validate all solver responses against schema, and handle errors without exposing internal details.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Inspect API authentication setup, review parsing code for schema validation, and execute malformed response tests.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SA-9\",\n          \"chapter\": \"System and Services Acquisition\",\n          \"section\": \"External System Interactions and API Security\",\n          \"level\": null,\n          \"requirement\": \"Ensure that external interfaces are secured and that integration with external systems follows organizational policies.\",\n          \"relevance\": \"Mandates governance for integrating external solvers and ensuring compliance with internal policies.\",\n          \"integration_tips\": \"Document integration requirements, include security controls in the acquisition process, and require supplier security attestations.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review acquisition/integration documentation and evidence of supplier security posture checks.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System Acquisition, Development and Maintenance\",\n          \"section\": \"Secure development practices for interfaces\",\n          \"level\": null,\n          \"requirement\": \"Security requirements for development and integration of interfaces should be defined and implemented.\",\n          \"relevance\": \"Ensures development practices for payload generation and parsing include security requirements to avoid vulnerabilities.\",\n          \"integration_tips\": \"Define interface contracts, include input/output validation, and perform secure code reviews and testing for parsing logic.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Inspect interface contracts and review secure development artifacts and test results.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-8\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Transmission Confidentiality and Integrity\",\n          \"level\": null,\n          \"requirement\": \"Protect the confidentiality and integrity of information during transmission to external services.\",\n          \"relevance\": \"Ensures payloads and solutions exchanged with Timefold are protected from interception or tampering.\",\n          \"integration_tips\": \"Use TLS, validate certificates, and consider message signing to ensure end-to-end integrity.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Verify TLS config, perform MITM tests, and validate signature verification if implemented.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Internationalization (multi-language UI and localized date/time formatting)\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.7\",\n          \"chapter\": \"Internationalization and Encoding\",\n          \"section\": \"Unicode and Encoding Handling\",\n          \"level\": \"L2\",\n          \"requirement\": \"Properly handle Unicode, normalization, and encoding to prevent injection and XSS vulnerabilities across locales.\",\n          \"relevance\": \"Directly relevant for multi-language UI and localized date/time handling to avoid injection vectors introduced by locale-specific encodings.\",\n          \"integration_tips\": \"Normalize and canonicalize text inputs/outputs, apply proper encoding/escaping per output context, and validate locale-specific formats.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Test inputs with various Unicode characters and locale-specific formats to detect XSS or parsing issues.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SC-17\",\n          \"chapter\": \"System and Communications Protection\",\n          \"section\": \"Public Key Infrastructure and Localisation considerations\",\n          \"level\": null,\n          \"requirement\": \"Ensure localized data formats and time/date handling do not weaken security mechanisms and are consistently handled.\",\n          \"relevance\": \"Ensures localized formatting does not break security checks like signature verification or token expiry calculations.\",\n          \"integration_tips\": \"Use locale-aware libraries for date/time parsing, store timestamps in canonical format (UTC) internally, and format only at presentation layer.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review date/time handling code and test across locales for consistent behavior of security-sensitive features.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.14.2.5\",\n          \"chapter\": \"System Acquisition, Development and Maintenance\",\n          \"section\": \"Secure development practices for localization\",\n          \"level\": null,\n          \"requirement\": \"Include security requirements for localized applications and data handling in development.\",\n          \"relevance\": \"Mandates inclusion of localization security needs in development practices for internationalized UI.\",\n          \"integration_tips\": \"Include localization security checks in SDLC, perform code reviews focused on encoding/formatting, and update test suites for locales.\",\n          \"priority\": \"Low\",\n          \"verification_method\": \"Inspect development checklists and localized test cases for security considerations.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.1\",\n          \"chapter\": \"Input Validation\",\n          \"section\": \"Locale-aware Input Validation\",\n          \"level\": \"L1\",\n          \"requirement\": \"Validate and canonicalize input considering locale-specific encodings and formats.\",\n          \"relevance\": \"Supports safe handling of user inputs in various languages and formats to prevent logic or parsing errors.\",\n          \"integration_tips\": \"Implement validators that accept locale-specific formats but convert to canonical representations for processing and storage.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Run locale-specific input validation tests and check canonicalization outputs.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"User interface features: responsive navigation, tables with pagination/sorting/filtering, calendar views, alerts/notifications, breadcrumbs\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V9.2\",\n          \"chapter\": \"Injection Prevention and XSS\",\n          \"section\": \"Cross-Site Scripting and Output Encoding\",\n          \"level\": \"L1\",\n          \"requirement\": \"Encode output and validate input to prevent XSS, especially in tables, filters, and dynamic navigation elements.\",\n          \"relevance\": \"Directly applies to UI elements which render user-controlled content and are susceptible to XSS and injection attacks.\",\n          \"integration_tips\": \"Escape/encode user data in the proper HTML/JS context, apply CSP headers, and avoid dangerous innerHTML patterns.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Perform XSS testing across UI components including pagination and dynamic filters.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"SI-10\",\n          \"chapter\": \"Software Integrity\",\n          \"section\": \"Input Validation and Error Handling\",\n          \"level\": null,\n          \"requirement\": \"Validate input and handle errors gracefully to avoid exposing sensitive information in UI components.\",\n          \"relevance\": \"Encourages sanitizing/filtering user inputs used for sorting/pagination and ensuring error messages do not leak internals.\",\n          \"integration_tips\": \"Validate query parameters for pagination/sorting on server-side and sanitize user-visible error messages.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Review server-side validation for UI query parameters and inspect error messages for sensitive info.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.12.2.1\",\n          \"chapter\": \"Protection from Malware\",\n          \"section\": \"Controls for application security\",\n          \"level\": null,\n          \"requirement\": \"Apply secure development and application-level controls to mitigate common application threats.\",\n          \"relevance\": \"Provides general secure development guidance for UI features to reduce vulnerabilities like XSS and CSRF.\",\n          \"integration_tips\": \"Adopt secure UI development practices, include security tests in CI, and ensure third-party UI libs are vetted.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Check secure development artifacts, dependency scans, and UI security test results.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V5.4\",\n          \"chapter\": \"Session Management\",\n          \"section\": \"CSRF Protections\",\n          \"level\": \"L1\",\n          \"requirement\": \"Implement CSRF protections for state-changing UI actions like shift creation or accept/reject.\",\n          \"relevance\": \"Protects UI actions (calendar interactions, form submissions) from CSRF attacks that could create/change shifts.\",\n          \"integration_tips\": \"Use anti-CSRF tokens for state-modifying requests and validate origin/referrer where appropriate.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Perform CSRF attack simulations against state-changing endpoints and verify tokens are required and validated.\"\n        }\n      ]\n    },\n    {\n      \"high_level_requirement\": \"Audit logging, legal documents availability (Privacy Policy, Terms of Service), and consent tracking\",\n      \"requirement_id\": null,\n      \"security_controls\": [\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"AU-2\",\n          \"chapter\": \"Audit and Accountability\",\n          \"section\": \"Audit Events\",\n          \"level\": null,\n          \"requirement\": \"Determine and log auditable events including user consent and policy acceptance.\",\n          \"relevance\": \"Directly maps to logging consent events and availability of legal document acceptance records.\",\n          \"integration_tips\": \"Log consent events with timestamp, user ID, document version, and store immutably; ensure logs are searchable for audit.\",\n          \"priority\": \"Critical\",\n          \"verification_method\": \"Review consent logs, verify they contain required fields, and test retrieval for audit scenarios.\"\n        },\n        {\n          \"standard\": \"ISO27001\",\n          \"req_id\": \"A.18.1.4\",\n          \"chapter\": \"Compliance\",\n          \"section\": \"Privacy and Data Protection in Automated Processing\",\n          \"level\": null,\n          \"requirement\": \"Ensure compliance with privacy requirements and record legal consents and policy acknowledgments.\",\n          \"relevance\": \"Establishes requirement to track legal consents and ensure privacy compliance for policy-driven behaviors.\",\n          \"integration_tips\": \"Retain versions of legal documents, capture consent metadata, and provide user-facing access to documents and consent history.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Verify retention of document versions and sample consent records match user acknowledgments.\"\n        },\n        {\n          \"standard\": \"OWASP\",\n          \"req_id\": \"V10.3\",\n          \"chapter\": \"Logging and Monitoring\",\n          \"section\": \"Consent and Legal Events Logging\",\n          \"level\": \"L1\",\n          \"requirement\": \"Log legal acknowledgements and consent events and ensure integrity of such records.\",\n          \"relevance\": \"Specifies logging of legal events and integrity protections which are key to proving consent.\",\n          \"integration_tips\": \"Use tamper-evident storage for consent records or append-only logs and ensure access controls over consent records.\",\n          \"priority\": \"High\",\n          \"verification_method\": \"Attempt to alter consent records in test environment and verify tamper detection and access controls.\"\n        },\n        {\n          \"standard\": \"NIST\",\n          \"req_id\": \"PL-2\",\n          \"chapter\": \"Planning\",\n          \"section\": \"System and Communications Protection Policy\",\n          \"level\": null,\n          \"requirement\": \"Establish policies for handling legal documents and consent records.\",\n          \"relevance\": \"Requires formal policies governing how legal documents and consent are managed within the system.\",\n          \"integration_tips\": \"Develop policy that defines retention, access, and usage of consent records and implement controls accordingly.\",\n          \"priority\": \"Medium\",\n          \"verification_method\": \"Review policy documentation and evidence of policy enforcement in system practices.\"\n        }\n      ]\n    }\n  ],\n  \"cross_functional_controls\": [\n    {\n      \"control_name\": \"Logging and Audit Trails\",\n      \"description\": \"Centralized, tamper-resistant logging of security-relevant events including authentication, authorization changes, exports, consent events, solver interactions, and algorithmic outputs.\",\n      \"applies_to\": [\n        \"All requirements (global)\",\n        \"Audit logging features\",\n        \"Automated assignment and solver integration\",\n        \"Data export and profile changes\"\n      ],\n      \"implementation_guidance\": \"Implement an append-only or integrity-protected logging system (WORM or signed logs), centralize logs with access controls, and define retention and review processes. Ensure logs capture actor, timestamp, action, target resource and before/after states where applicable.\"\n    },\n    {\n      \"control_name\": \"Encryption in Transit and at Rest\",\n      \"description\": \"Protect sensitive data (credentials, PII, solver payloads, exported files) with strong encryption during transit and at rest.\",\n      \"applies_to\": [\n        \"Authentication flows\",\n        \"External API integrations\",\n        \"Asynchronous job payloads\",\n        \"Exported files and sensitive data stores\"\n      ],\n      \"implementation_guidance\": \"Use TLS with current best-practice cipher suites for all external and internal communication; encrypt data at rest with managed keys and apply field-level encryption for highly sensitive fields. Rotate keys and manage access to encryption keys via KMS with strict IAM controls.\"\n    },\n    {\n      \"control_name\": \"Input Validation and Output Encoding\",\n      \"description\": \"Canonicalize, validate and sanitize inputs; encode outputs according to their context to prevent injection (XSS, SQLi) and logic bypass.\",\n      \"applies_to\": [\n        \"UI components (tables, filters, calendar)\",\n        \"Shift/skill/leave creation and updates\",\n        \"API payloads and external solver responses\"\n      ],\n      \"implementation_guidance\": \"Implement server-side canonicalization and validation for all inputs, apply context-aware encoding on outputs, and use schema validation for APIs. Include locale-aware validation for internationalized inputs and test with Unicode edge-cases.\"\n    },\n    {\n      \"control_name\": \"Access Control and Authorization\",\n      \"description\": \"Centralized enforcement of role-based and attribute-based access controls, with least privilege and tenant scoping.\",\n      \"applies_to\": [\n        \"RBAC and user status\",\n        \"Company CRUD/multi-tenant scoping\",\n        \"Profile and assignment management\",\n        \"Export and administrative functions\"\n      ],\n      \"implementation_guidance\": \"Use a centralized authorization service or middleware enforcing RBAC/ABAC checks at every API entrypoint, include tenant_id in access decisions, and implement policy management and review processes to keep permissions up-to-date.\"\n    },\n    {\n      \"control_name\": \"Privacy and Data Minimization\",\n      \"description\": \"Assess and minimize personal data collection (preferences, leave reasons) and protect special categories of data with additional safeguards.\",\n      \"applies_to\": [\n        \"Preferences and leave management\",\n        \"Exports and reporting\",\n        \"Algorithmic scoring and solver inputs/outputs\"\n      ],\n      \"implementation_guidance\": \"Conduct PIAs for sensitive data, apply pseudonymization or redaction for exports, limit retention periods, and restrict access to need-to-know personnel. Record legal basis and user consent where required.\"\n    }\n  ],\n  \"recommended_asvs_level\": \"L2\"\n}",
      "pydantic": {
        "requirements_mapping": [
          {
            "high_level_requirement": "User registration with email verification and account lifecycle management",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V2.1",
                "chapter": "Authentication Verification",
                "section": "Account Creation and Verification",
                "level": "L1",
                "requirement": "Verify new user registrations via email or other out-of-band mechanisms to ensure account ownership.",
                "relevance": "Directly addresses the need to confirm user ownership of email accounts during registration and reduces fraudulent account creation. It maps to the verification and lifecycle control aspects of the requirement.",
                "integration_tips": "Implement email confirmation tokens that are single-use and time-limited; require confirmation before enabling privileged features. Tie the verification status to account state in the user lifecycle management flows.",
                "priority": "Critical",
                "verification_method": "Review implementation of email verification flow, inspect token properties (single-use, expiry), and test account behavior before and after verification."
              },
              {
                "standard": "NIST",
                "req_id": "AC-2",
                "chapter": "Account Management",
                "section": "Account Lifecycle",
                "level": null,
                "requirement": "The organization manages information system accounts, including account creation, enablement, modification, disabling, and removal.",
                "relevance": "Specifies lifecycle operations which map to registration, activation, suspension, and removal of user accounts required by the feature.",
                "integration_tips": "Establish automated workflows and approval steps for account creation and deactivation; maintain authoritative records of account states and reason codes.",
                "priority": "Critical",
                "verification_method": "Audit account management procedures, review logs of account create/disable/delete events, and verify policy enforcement through test cases."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.1",
                "chapter": "User Access Management",
                "section": "User registration and de-registration",
                "level": null,
                "requirement": "A formal user registration and de-registration process shall be implemented to enable assignment of access rights.",
                "relevance": "Mandates a formal process for onboarding/offboarding which ensures registration ties into access rights and lifecycle.",
                "integration_tips": "Document procedures for registration and de-registration, include steps for verification, approvals, and role assignment during onboarding/offboarding.",
                "priority": "High",
                "verification_method": "Inspect documented procedures and sample records for adherence; validate that de-registration revokes access promptly."
              },
              {
                "standard": "NIST",
                "req_id": "IA-5",
                "chapter": "Identification and Authentication",
                "section": "Authenticator Management",
                "level": null,
                "requirement": "Manage, distribute, and revoke credentials and authenticators throughout the account lifecycle.",
                "relevance": "Addresses credential issuance and revocation tied to account lifecycle which complements email verification and lifecycle management.",
                "integration_tips": "Implement credential issuance policies, track authenticator provenance, and ensure revocation paths (e.g., when email changes or accounts disabled).",
                "priority": "High",
                "verification_method": "Review credential lifecycle processes, test revocation and re-issuance flows, and inspect logs for authenticator events."
              }
            ]
          },
          {
            "high_level_requirement": "Authentication and single sign-on via credentials and Google OAuth",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V2.2",
                "chapter": "Authentication Verification",
                "section": "Credential & Third-party Authentication",
                "level": "L2",
                "requirement": "Support secure authentication including credential-based and federated authentication (OAuth2, OpenID Connect) with proper validation and token handling.",
                "relevance": "Directly covers secure handling of credential-based login and federated SSO (Google OAuth) required by the requirement.",
                "integration_tips": "Use well-vetted OAuth2/OpenID Connect libraries, validate ID tokens server-side, enforce scopes and claims, and handle token storage securely.",
                "priority": "Critical",
                "verification_method": "Review OAuth/OIDC implementation, verify token validation, scope restrictions, and perform token replay/forgery tests."
              },
              {
                "standard": "NIST",
                "req_id": "IA-2",
                "chapter": "Identification and Authentication",
                "section": "Identification and Authentication (Organizational Users)",
                "level": null,
                "requirement": "Identify and authenticate organizational users using authenticators and, where appropriate, federated identity mechanisms.",
                "relevance": "Provides organizational control guidance for authenticating users via both local credentials and federated providers like Google.",
                "integration_tips": "Define acceptable authenticators, document trust relationships with identity providers, and require secure channels for federation.",
                "priority": "Critical",
                "verification_method": "Examine policies for federated identity, test SSO flows for proper authentication, and verify credential handling meets organizational standards."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.4.2",
                "chapter": "System and Application Access Control",
                "section": "Secure log-on procedures",
                "level": null,
                "requirement": "Secure log-on procedures shall be implemented, where appropriate supporting single sign-on and federated identity.",
                "relevance": "Requires secure log-on procedures and supports SSO, aligning with the need for secure Google OAuth integration.",
                "integration_tips": "Implement SSO with secure session establishment, multi-factor option where required, and maintain centralized session policies.",
                "priority": "High",
                "verification_method": "Validate the log-on workflow, verify session creation after SSO, and review session timeout and logout behavior."
              },
              {
                "standard": "OWASP",
                "req_id": "V5.3",
                "chapter": "Session Management",
                "section": "OAuth and Token Handling",
                "level": "L2",
                "requirement": "Ensure tokens are validated, scoped, stored securely, and revoked when necessary for SSO and OAuth use-cases.",
                "relevance": "Covers secure token lifecycle for SSO, ensuring tokens from Google are handled safely and revocable.",
                "integration_tips": "Use secure token storage (HTTP-only cookies or secure token stores), implement token revocation and rotation, and minimize token scopes.",
                "priority": "Critical",
                "verification_method": "Inspect token storage methods, test revocation and refresh flows, and review scope requests during OAuth handshake."
              }
            ]
          },
          {
            "high_level_requirement": "Password reset and account recovery",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V2.3",
                "chapter": "Authentication Verification",
                "section": "Password Reset & Account Recovery",
                "level": "L1",
                "requirement": "Implement secure password reset flows using verified contact channels and protections against account takeover (OTP, expiring tokens, rate limiting).",
                "relevance": "Directly maps to the need for secure password reset flows and protections against abuse or account takeover.",
                "integration_tips": "Use single-use, short-lived reset tokens delivered via verified channels, add rate limiting and anomaly detection on reset attempts.",
                "priority": "Critical",
                "verification_method": "Test reset flows for token reuse, expiry, and ensure resets require verified contact; perform abuse-case testing."
              },
              {
                "standard": "NIST",
                "req_id": "IA-5 (5)",
                "chapter": "Identification and Authentication",
                "section": "Password and Recovery Credential Management",
                "level": null,
                "requirement": "Establish policies and mechanisms for managing password resets and recovery in a manner that resists credential compromise.",
                "relevance": "Provides organizational expectations for secure recovery procedures to reduce risk of credential compromise.",
                "integration_tips": "Document recovery procedures, require multi-step verification for high-risk account changes, and log recovery events for auditing.",
                "priority": "High",
                "verification_method": "Review recovery policies, validate multi-step verification for sensitive accounts, and inspect logs of recovery events."
              },
              {
                "standard": "OWASP",
                "req_id": "V5.1",
                "chapter": "Session Management",
                "section": "One-time tokens and recovery tokens",
                "level": "L2",
                "requirement": "Recovery tokens and one-time use links must be single-use, short-lived, and protected against replay attacks.",
                "relevance": "Specifies properties of recovery tokens which mitigate replay and abuse in password reset flows.",
                "integration_tips": "Implement cryptographically-random tokens, mark tokens used after redemption, and expire tokens quickly (e.g., 15 minutes).",
                "priority": "High",
                "verification_method": "Inspect token generation and storage, attempt token replay tests, and verify expiry enforcement."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.3",
                "chapter": "User Access Management",
                "section": "Management of privileged access rights",
                "level": null,
                "requirement": "Ensure controlled management of authentication data and password resets, including policies and procedures.",
                "relevance": "Supports governance over reset and recovery processes to prevent misuse, particularly for privileged accounts.",
                "integration_tips": "Apply stricter reset controls for privileged roles, require manual approvals where appropriate, and log privileged resets.",
                "priority": "Medium",
                "verification_method": "Review privileged reset controls, sampling of privileged account reset logs, and policy documentation."
              }
            ]
          },
          {
            "high_level_requirement": "Role-based access control (ADMIN, MANAGER, EMPLOYEE) and user status management",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.1",
                "chapter": "Access Control Verification",
                "section": "Role-based Access Control",
                "level": "L2",
                "requirement": "Enforce role-based access control with least privilege and separation of duties; implement role checks on both client and server sides.",
                "relevance": "Directly prescribes RBAC enforcement necessary for ADMIN/MANAGER/EMPLOYEE roles and ensures server-side enforcement to prevent privilege escalation.",
                "integration_tips": "Centralize role checks in authorization middleware, enforce least privilege for each role, and prevent client-side-only enforcement.",
                "priority": "Critical",
                "verification_method": "Review role definitions, test access control enforcement across endpoints for each role, and perform privilege escalation attempts."
              },
              {
                "standard": "NIST",
                "req_id": "AC-3",
                "chapter": "Access Enforcement",
                "section": "Access Control Policy and Enforcement",
                "level": null,
                "requirement": "Enforce access restrictions and ensure users are granted access only to authorized functions and data.",
                "relevance": "Mandates access enforcement which supports role-based controls and status-based access (active/disabled/suspended).",
                "integration_tips": "Implement centralized access control checks, map roles to permissions, and enforce account status checks before granting access.",
                "priority": "Critical",
                "verification_method": "Inspect policy-to-implementation mapping, run access matrix tests, and verify that disabled users cannot access resources."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.1.2",
                "chapter": "User Access Management",
                "section": "Access Control Policy",
                "level": null,
                "requirement": "An access control policy based on business and security requirements shall be established, documented, and reviewed.",
                "relevance": "Requires documented access control policies to define role responsibilities and status management.",
                "integration_tips": "Create and maintain an access control policy describing roles, permissions, and lifecycle procedures; align with HR onboarding/offboarding.",
                "priority": "High",
                "verification_method": "Review access control policy documentation and interview personnel to confirm implementation."
              },
              {
                "standard": "NIST",
                "req_id": "AC-2 (3)",
                "chapter": "Account Management",
                "section": "Account Status and Automation",
                "level": null,
                "requirement": "Automate account status changes (enable/disable) and maintain authoritative account state.",
                "relevance": "Supports user status management by prescribing automation and authoritative state control to prevent orphaned or active-but-disabled accounts.",
                "integration_tips": "Integrate with HR systems for status changes, implement automated disabling for inactivity or termination, and record change reasons.",
                "priority": "High",
                "verification_method": "Audit automation integrations, simulate HR-driven status changes, and verify system enforces new statuses immediately."
              }
            ]
          },
          {
            "high_level_requirement": "User profile management and company assignment",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.6",
                "chapter": "Access Control Verification",
                "section": "Authorization for Profile and Resource Assignment",
                "level": "L1",
                "requirement": "Verify that updates to user profiles and assignments (e.g., company membership) are protected by server-side authorization checks.",
                "relevance": "Directly addresses the need to protect profile updates and company assignments from unauthorized changes.",
                "integration_tips": "Enforce server-side permission checks tied to role and ownership; validate company assignment changes against authoritative sources.",
                "priority": "High",
                "verification_method": "Review code paths for profile update endpoints, perform unauthorized modification tests, and inspect audit logs."
              },
              {
                "standard": "NIST",
                "req_id": "AC-6",
                "chapter": "Least Privilege",
                "section": "Least Privilege and Separation of Duties",
                "level": null,
                "requirement": "Employ least privilege mechanisms for user profile updates and assignment of organizational attributes.",
                "relevance": "Ensures only authorized personnel or processes can assign users to companies or alter profile attributes, reducing risk of misuse.",
                "integration_tips": "Assign minimal privileges to services and operators that manage profile/company attributes and require approvals for sensitive changes.",
                "priority": "High",
                "verification_method": "Check privilege assignments for profile-management components and test unauthorized assignment attempts."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.2",
                "chapter": "User Access Management",
                "section": "User access provisioning",
                "level": null,
                "requirement": "A formal process for granting and revoking access rights and attributes should be followed, including assignment to organizational units.",
                "relevance": "Requires formal provisioning processes which should include company assignment and profile attribute handling.",
                "integration_tips": "Implement provisioning workflows with approvals and record keeping, and enforce verification of company membership during assignment.",
                "priority": "Medium",
                "verification_method": "Review provisioning records and test the end-to-end process for correctness and auditability."
              },
              {
                "standard": "OWASP",
                "req_id": "V1.1",
                "chapter": "Architecture and Design",
                "section": "Trust Boundaries and Multi-tenancy",
                "level": "L2",
                "requirement": "Design systems to maintain clear trust boundaries so profile attributes that determine access are authoritative and validated.",
                "relevance": "Ensures profile attributes like company assignment are authoritative and cannot be spoofed to gain access across boundaries.",
                "integration_tips": "Store canonical profile attributes in a trusted service or database, and validate tokens/claims used to assert company membership.",
                "priority": "High",
                "verification_method": "Inspect trust boundary design, review data flow diagrams, and test for attribute spoofing."
              }
            ]
          },
          {
            "high_level_requirement": "Company CRUD and multi-tenant scoping of data",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V14.1",
                "chapter": "Multi-Tenancy",
                "section": "Tenant Isolation and Data Separation",
                "level": "L2",
                "requirement": "Ensure logical separation of tenant data and enforce access controls to prevent cross-tenant data leakage.",
                "relevance": "Directly addresses multi-tenant scoping and the need to prevent cross-company data access when performing CRUD operations.",
                "integration_tips": "Enforce tenant checks at data access layer and include tenant_id in every query predicate; implement row-level security where possible.",
                "priority": "Critical",
                "verification_method": "Review data access code, run multi-tenant isolation tests (attempt cross-tenant reads/writes), and inspect database policies."
              },
              {
                "standard": "NIST",
                "req_id": "SC-7",
                "chapter": "System and Communications Protection",
                "section": "Boundary Protection",
                "level": null,
                "requirement": "Implement controls to separate and protect system components and data flows; apply isolation as necessary.",
                "relevance": "Supports the requirement to protect and isolate tenant data by prescribing boundary and isolation controls.",
                "integration_tips": "Segment logical components by tenant boundaries, apply network and access controls for management interfaces, and minimize shared state.",
                "priority": "High",
                "verification_method": "Assess architecture diagrams, test separation of management interfaces, and review network segmentation controls."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.13.2.1",
                "chapter": "Communications Security",
                "section": "Information transfer policies and procedures",
                "level": null,
                "requirement": "Information transfer and segregation mechanisms should be defined to protect the exchange and separation of information between entities.",
                "relevance": "Requires documented segregation mechanisms relevant to multi-tenant CRUD operations and data transfer between tenants.",
                "integration_tips": "Document transfer policies, implement enforcement controls for inter-tenant transfers, and require approvals for cross-tenant data export.",
                "priority": "Medium",
                "verification_method": "Review policy documents and sample transfer approvals; test that transfers are blocked or logged when not permitted."
              },
              {
                "standard": "NIST",
                "req_id": "AC-6 (10)",
                "chapter": "Least Privilege",
                "section": "Tenant-specific Access Controls",
                "level": null,
                "requirement": "Apply tenant-specific access restrictions and scoping to limit access to tenant resources.",
                "relevance": "Specifies tailoring of least-privilege controls to tenant-specific resources which is essential for company CRUD scoping.",
                "integration_tips": "Map permissions to tenant-scoped roles, implement enforcement in APIs and DB, and maintain per-tenant admin scopes.",
                "priority": "High",
                "verification_method": "Verify per-tenant role mappings, test scoped permissions, and run negative tests attempting cross-tenant CRUD."
              }
            ]
          },
          {
            "high_level_requirement": "Shift type management with time ranges and required skills",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V1.3",
                "chapter": "Architecture and Design",
                "section": "Data Validation and Business Logic Integrity",
                "level": "L1",
                "requirement": "Validate business input (e.g., time ranges, required skills) server-side to prevent logic abuse and ensure data integrity.",
                "relevance": "Protects shift-type definitions from malformed or malicious inputs that could break scheduling logic or grant unauthorized capabilities.",
                "integration_tips": "Implement strict server-side validation for time ranges, enforce constraints (no overlap, valid skill IDs), and canonicalize inputs.",
                "priority": "High",
                "verification_method": "Review validation code, perform fuzzing of time/skill inputs, and check DB for invalid persisted records."
              },
              {
                "standard": "NIST",
                "req_id": "SI-10",
                "chapter": "Information Integrity",
                "section": "Input Validation and Integrity Verification",
                "level": null,
                "requirement": "Employ integrity checks and input validation to ensure data consistency and correctness.",
                "relevance": "Ensures integrity of shift-type data and supports detection of tampering or corruption.",
                "integration_tips": "Apply schema validation, integrity checksums where necessary, and enforce business rule validation in services.",
                "priority": "Medium",
                "verification_method": "Inspect schema validations, run integrity checks in test harness, and verify constraints via unit tests."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.1.2",
                "chapter": "Operational Procedures and Responsibilities",
                "section": "Change Management and Data Integrity",
                "level": null,
                "requirement": "Changes to systems and data (including configuration of business objects like shift types) should be controlled to preserve integrity.",
                "relevance": "Requires controlled change processes for shift-type configurations to prevent unauthorized or erroneous changes.",
                "integration_tips": "Use controlled deployment/change processes for shift-type schema or rule changes, include review/approval steps for business-impacting changes.",
                "priority": "Medium",
                "verification_method": "Review change records for shift-type modifications and check that approvals were captured."
              },
              {
                "standard": "OWASP",
                "req_id": "V6.4",
                "chapter": "Business Logic",
                "section": "Enforce Business Rules",
                "level": "L2",
                "requirement": "Ensure business logic (e.g., required skills per shift type) is enforced server-side and cannot be bypassed by client manipulation.",
                "relevance": "Directly ensures shift-type business rules are enforced server-side to prevent client-side tampering.",
                "integration_tips": "Centralize business rules in service layer, implement tests for rule enforcement, and prevent direct DB writes that bypass logic.",
                "priority": "High",
                "verification_method": "Attempt to bypass rules via direct API/DB calls and validate server rejects inconsistent or unauthorized changes."
              }
            ]
          },
          {
            "high_level_requirement": "Manual shift creation, update, deletion, and calendar presentation",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V4.4",
                "chapter": "Access Control Verification",
                "section": "Authorization for Data Modification",
                "level": "L1",
                "requirement": "Authorize all modification endpoints and verify checks server-side to prevent unauthorized creation, update, or deletion.",
                "relevance": "Ensures only authorized users can create/update/delete shifts, which is central to manual shift management.",
                "integration_tips": "Protect endpoints via role checks and ownership checks; ensure calendar UI actions invoke server-side authorization.",
                "priority": "Critical",
                "verification_method": "Test role-based access to create/update/delete endpoints, and attempt unauthorized operations."
              },
              {
                "standard": "NIST",
                "req_id": "AU-2",
                "chapter": "Audit and Accountability",
                "section": "Audit Events",
                "level": null,
                "requirement": "Determine and log auditable events including create, modify, delete operations.",
                "relevance": "Records manual shift changes for accountability and incident investigation as required by the feature.",
                "integration_tips": "Log change events with user, timestamp, before/after state and reason; protect logs from tampering.",
                "priority": "High",
                "verification_method": "Review audit logs for shift CRUD events and validate completeness and integrity."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.1",
                "chapter": "Logging and Monitoring",
                "section": "Event Logging",
                "level": null,
                "requirement": "Event logs recording user activities, exceptions, and security events shall be produced and retained.",
                "relevance": "Mandates retaining logs for manual shift operations and UI interactions for compliance and troubleshooting.",
                "integration_tips": "Define retention periods, ensure secure storage, and include calendar-related events as auditable actions.",
                "priority": "Medium",
                "verification_method": "Inspect logs for the required events, retention configuration, and access controls around logs."
              },
              {
                "standard": "NIST",
                "req_id": "AC-6",
                "chapter": "Least Privilege",
                "section": "Enforce least privilege on modification endpoints",
                "level": null,
                "requirement": "Restrict modify/delete/create operations to roles with explicit permissions.",
                "relevance": "Supports limiting who may perform manual shift operations to defined roles, reducing misuse risk.",
                "integration_tips": "Map CRUD permissions to ADMIN/MANAGER roles and apply checks in API and UI layers.",
                "priority": "High",
                "verification_method": "Review permission mappings and test that lower-privileged roles cannot modify shifts."
              }
            ]
          },
          {
            "high_level_requirement": "Shift status tracking and filtering (SCHEDULED, CONFIRMED, COMPLETED, CANCELLED, NO_SHOW)",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AU-6",
                "chapter": "Audit and Accountability",
                "section": "Audit Review, Analysis, and Reporting",
                "level": null,
                "requirement": "Regularly review and analyze audit records for indications of unauthorized activity or changes.",
                "relevance": "Encourages review of status transitions to detect unauthorized or anomalous status changes such as NO_SHOW flags being manipulated.",
                "integration_tips": "Log status transitions with actor and context, implement periodic reviews and alerts for unusual patterns.",
                "priority": "High",
                "verification_method": "Review audit processes, sample status transition logs, and ensure alerts are configured for anomalies."
              },
              {
                "standard": "OWASP",
                "req_id": "V10.1",
                "chapter": "Logging and Monitoring",
                "section": "Tamper-resistant Logging",
                "level": "L2",
                "requirement": "Ensure logs and status transitions are recorded in tamper-resistant logs and integrity-protected storage.",
                "relevance": "Protects the integrity of status history to provide trustworthy records for scheduling outcomes.",
                "integration_tips": "Use append-only logs or secure log storage with integrity checks and restrict log modification privileges.",
                "priority": "High",
                "verification_method": "Inspect log storage protections and attempt to modify logs; verify detection of tamper attempts."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.4.3",
                "chapter": "Logging and Monitoring",
                "section": "Administrator and Operator Logs",
                "level": null,
                "requirement": "Administrator and operator activities, including status changes, should be logged and reviewed.",
                "relevance": "Mandates logging of operator actions affecting shift statuses to maintain accountability.",
                "integration_tips": "Capture operator ID and reason for manual status changes, and include review procedures for sensitive transitions.",
                "priority": "Medium",
                "verification_method": "Check logs for operator entries and review processes for manual status changes."
              },
              {
                "standard": "NIST",
                "req_id": "CM-3",
                "chapter": "Configuration Management",
                "section": "Configuration Change Control",
                "level": null,
                "requirement": "Control and document changes to system configuration and state transitions.",
                "relevance": "Ensures system state transitions for shift statuses are controlled and documented, preventing unauthorized state changes.",
                "integration_tips": "Treat status transition rules as configuration items, version them, and require approvals for rule changes.",
                "priority": "Medium",
                "verification_method": "Review change records for status transition rule updates and verify approvals were enforced."
              }
            ]
          },
          {
            "high_level_requirement": "Automated shift assignment (auto-assignment) via external solver with preview and accept/reject",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V13.1",
                "chapter": "API Security",
                "section": "Secure API Consumption and Third-party Integration",
                "level": "L2",
                "requirement": "Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.",
                "relevance": "Applies to integrating with external solver for auto-assignment and ensuring previews and accepts/rejects are securely transmitted and validated.",
                "integration_tips": "Use mutual TLS or OAuth for API calls, validate solver responses before applying changes, and implement signed payloads or record hashes for integrity.",
                "priority": "Critical",
                "verification_method": "Review API authentication configuration, test injection or malformed response handling, and verify server validates solver outputs."
              },
              {
                "standard": "NIST",
                "req_id": "SA-9",
                "chapter": "System and Services Acquisition",
                "section": "External System Interactions and API Security",
                "level": null,
                "requirement": "Ensure that external interfaces are secured and that integration with external systems follows organizational policies.",
                "relevance": "Mandates governance around external solver usage and how solver results are accepted into the system.",
                "integration_tips": "Define security requirements in supplier agreements, document expected APIs, and ensure change management for solver integration.",
                "priority": "High",
                "verification_method": "Review supplier contracts, interface security documentation, and test compliance with the defined integration policy."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.15.1.1",
                "chapter": "Supplier Relationships",
                "section": "Information Security in Supplier Relationships",
                "level": null,
                "requirement": "Establish controls for supplier relationships including security requirements for shared data and interfaces.",
                "relevance": "Supports contractual and security requirements for using an external solver service for assignments.",
                "integration_tips": "Include SLAs and security requirements in supplier agreements, require proof of secure handling, and define incident responsibilities.",
                "priority": "Medium",
                "verification_method": "Inspect supplier agreements and evidence of supplier security practices and audits."
              },
              {
                "standard": "NIST",
                "req_id": "SC-8",
                "chapter": "System and Communications Protection",
                "section": "Transmission Confidentiality and Integrity",
                "level": null,
                "requirement": "Protect the confidentiality and integrity of information during transmission to external services.",
                "relevance": "Ensures solver payloads and returned solutions are transmitted securely to prevent tampering or eavesdropping.",
                "integration_tips": "Use TLS with strong ciphers, enforce certificate validation, and consider payload signing for end-to-end integrity.",
                "priority": "High",
                "verification_method": "Inspect TLS configuration, perform MITM tests, and verify payload signatures if implemented."
              }
            ]
          },
          {
            "high_level_requirement": "Real-time asynchronous job processing, polling, and solution status tracking",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "SC-13",
                "chapter": "System and Communications Protection",
                "section": "Use of Cryptography",
                "level": null,
                "requirement": "Use cryptography to protect data in transit and at rest in asynchronous messaging systems.",
                "relevance": "Secures messages and job payloads in transit and at rest as they move through job queues and polling endpoints.",
                "integration_tips": "Encrypt messages in transit with TLS and at rest with appropriate encryption keys; protect queue access with authentication.",
                "priority": "High",
                "verification_method": "Review encryption configurations for queues and endpoints, and test interception attempts."
              },
              {
                "standard": "OWASP",
                "req_id": "V14.3",
                "chapter": "Backend and Infrastructure",
                "section": "Secure Asynchronous Processing",
                "level": "L2",
                "requirement": "Ensure job queues and background processing components enforce authentication, authorization, and message validation.",
                "relevance": "Specifies securing job processing elements to ensure only authorized jobs are enqueued/processed and status updates are validated.",
                "integration_tips": "Authenticate producers/consumers, validate job payloads schema, and authorize status-change operations based on role.",
                "priority": "Critical",
                "verification_method": "Inspect queue ACLs, test unauthorized enqueue/dequeue attempts, and validate payload schema checks."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.1.1",
                "chapter": "Operational Procedures",
                "section": "Documented operating procedures for operations including job processing",
                "level": null,
                "requirement": "Operational procedures should define and control background processing and message handling.",
                "relevance": "Mandates documented procedures around real-time job processing and polling operations.",
                "integration_tips": "Document job lifecycle, polling intervals, retry limits, and error handling; include operational runbooks for failures.",
                "priority": "Medium",
                "verification_method": "Review operational procedures and perform runbook drills to validate behavior."
              },
              {
                "standard": "NIST",
                "req_id": "SI-7",
                "chapter": "Software, Firmware, and Information Integrity",
                "section": "Integrity Check Mechanisms",
                "level": null,
                "requirement": "Implement integrity checks for data processed asynchronously to detect tampering or corruption.",
                "relevance": "Ensures the integrity of solutions and job payloads is verifiable during the asynchronous processing lifecycle.",
                "integration_tips": "Include checksums, signatures, or message authentication codes (MACs) on job payloads and verify them before processing.",
                "priority": "High",
                "verification_method": "Inspect integrity verification code paths and attempt to submit tampered payloads to confirm detection."
              }
            ]
          },
          {
            "high_level_requirement": "Solution scoring, constraint violation analysis, and reporting",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V11.2",
                "chapter": "Logging and Monitoring",
                "section": "Algorithmic Transparency and Audit Trails",
                "level": "L2",
                "requirement": "Log inputs, configuration, and outputs of automated decision algorithms to support auditing and explainability.",
                "relevance": "Directly applies to capturing evidence of scoring and constraint violations for review and dispute resolution.",
                "integration_tips": "Record solver inputs, scoring parameters, and output diffs; store logs securely with access controls for auditors.",
                "priority": "High",
                "verification_method": "Check that algorithmic inputs/outputs are logged and can be correlated to user-visible reports."
              },
              {
                "standard": "NIST",
                "req_id": "PM-22",
                "chapter": "Planning",
                "section": "Algorithmic Accountability",
                "level": null,
                "requirement": "Document and analyze how automated solutions are validated, scored, and how violations are reported.",
                "relevance": "Mandates documentation and governance around automated scoring which supports trustworthy reporting.",
                "integration_tips": "Maintain documentation of scoring methodology, test datasets, and validation results; define reporting formats and owners.",
                "priority": "Medium",
                "verification_method": "Review documentation and validation artifacts and confirm reporting pipelines produce expected outputs."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.4",
                "chapter": "Compliance",
                "section": "Privacy and Data Protection in Automated Processing",
                "level": null,
                "requirement": "Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.",
                "relevance": "Ensures scoring and reporting practices comply with privacy and regulatory requirements, especially if personal data influences scores.",
                "integration_tips": "Assess privacy impacts of scoring data, avoid unnecessary personal data in scoring logs, and provide explanations where decisions affect individuals.",
                "priority": "Medium",
                "verification_method": "Review privacy assessments and validate that logs/reporting exclude unnecessary personal data or are appropriately protected."
              },
              {
                "standard": "NIST",
                "req_id": "AU-12",
                "chapter": "Audit and Accountability",
                "section": "Audit Generation",
                "level": null,
                "requirement": "Generate audit records for security-relevant events including algorithm outputs and violations.",
                "relevance": "Ensures scoring and violation events are auditable and recorded for security/review purposes.",
                "integration_tips": "Define which scoring events are auditable, include identifiers correlating to inputs, and protect audit logs from tampering.",
                "priority": "High",
                "verification_method": "Inspect audit logs for scoring events and test correlation between algorithm runs and generated logs."
              }
            ]
          },
          {
            "high_level_requirement": "Shift preferences management (date-specific desired/undesired) and preference tracking",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.4",
                "chapter": "Compliance",
                "section": "Privacy and Data Protection in Automated Processing",
                "level": null,
                "requirement": "Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.",
                "relevance": "Preferences may be personal data; this control ensures processing complies with privacy requirements and is documented.",
                "integration_tips": "Limit retention of preference data, document how preferences are used in automated assignment, and expose preference reports for user review.",
                "priority": "High",
                "verification_method": "Review privacy documentation and confirm preference handling is aligned with policy and retention rules."
              },
              {
                "standard": "NIST",
                "req_id": "PL-4",
                "chapter": "Planning",
                "section": "Privacy Impact Assessment",
                "level": null,
                "requirement": "Conduct privacy impact assessments for systems processing personal preferences.",
                "relevance": "Requires assessing privacy risks around storing and using user shift preferences.",
                "integration_tips": "Perform PIA to identify sensitive preferences (e.g., religious holidays) and apply minimization or extra protections as needed.",
                "priority": "Medium",
                "verification_method": "Provide PIA documentation and evidence of mitigations implemented based on findings."
              },
              {
                "standard": "OWASP",
                "req_id": "V1.5",
                "chapter": "Architecture and Design",
                "section": "Privacy by Design",
                "level": "L1",
                "requirement": "Design systems to minimize collection of personal data and protect user preferences and privacy.",
                "relevance": "Encourages design choices that limit privacy exposure for preference tracking features.",
                "integration_tips": "Collect only necessary preference attributes, provide user controls to view/edit/delete preferences, and protect data at rest.",
                "priority": "High",
                "verification_method": "Inspect data schemas and UI controls for preference management and test deletion/exports to ensure removal."
              },
              {
                "standard": "NIST",
                "req_id": "AC-19",
                "chapter": "Access Control",
                "section": "Access Control for Mobile Devices and User Attributes",
                "level": null,
                "requirement": "Protect user attribute data including preferences with appropriate access controls.",
                "relevance": "Ensures preferences are only visible and editable by authorized entities to prevent privacy violations.",
                "integration_tips": "Apply attribute-level ACLs so preferences are scoped to the user or authorized managers; restrict export of sensitive preferences.",
                "priority": "Medium",
                "verification_method": "Test access to preference records from different roles and verify unauthorized reads are blocked."
              }
            ]
          },
          {
            "high_level_requirement": "Unavailable dates and leave management (multiple leave types, date ranges, reasons)",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.4",
                "chapter": "Compliance",
                "section": "Privacy and Data Protection in Automated Processing",
                "level": null,
                "requirement": "Ensure compliance with regulatory requirements for automated processing and provide documentation for decisions.",
                "relevance": "Leave reasons may contain sensitive personal data (e.g., medical reasons); this control ensures privacy compliance for processing and storage.",
                "integration_tips": "Classify leave data sensitivity, apply stricter access controls for medical leave, and document legal bases for processing.",
                "priority": "Critical",
                "verification_method": "Review data classification, access controls, and privacy handling for leave data."
              },
              {
                "standard": "NIST",
                "req_id": "PL-4",
                "chapter": "Planning",
                "section": "Privacy Impact Assessment",
                "level": null,
                "requirement": "Conduct privacy impact assessments when processing sensitive personal data such as health-related leave.",
                "relevance": "Requires evaluating privacy risks posed by collecting leave reasons and ranges and drives protective controls.",
                "integration_tips": "Conduct PIA focusing on special categories of data, implement minimization, and consider pseudonymization where possible.",
                "priority": "High",
                "verification_method": "Provide PIA output and evidence of mitigations (pseudonymization, restricted access)."
              },
              {
                "standard": "NIST",
                "req_id": "MP-6",
                "chapter": "Media Protection",
                "section": "Sanitization and Protection of Sensitive Data",
                "level": null,
                "requirement": "Protect sensitive personal data at rest and in transit, and sanitize when exporting or transferring.",
                "relevance": "Applies to exporting or transferring leave records and ensuring sensitive reasons are sanitized or redacted.",
                "integration_tips": "Encrypt leave records at rest, apply field-level redaction for exports, and limit who can download leave data.",
                "priority": "High",
                "verification_method": "Inspect encryption at rest, review export sanitization routines, and test role-based export restrictions."
              },
              {
                "standard": "OWASP",
                "req_id": "V1.5",
                "chapter": "Architecture and Design",
                "section": "Privacy by Design",
                "level": "L1",
                "requirement": "Implement privacy-by-design for sensitive employee data, minimizing collection and ensuring secure storage.",
                "relevance": "Reinforces data minimization and secure handling for leave management modules.",
                "integration_tips": "Collect only required fields for leave processing, provide limited retention, and notify users about purpose and retention periods.",
                "priority": "Medium",
                "verification_method": "Review UI/data collection forms and retention policies; verify secure storage controls in place."
              }
            ]
          },
          {
            "high_level_requirement": "Skills management and skill-based matching for assignments",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AC-3 (5)",
                "chapter": "Access Enforcement",
                "section": "Attribute-Based Access Control (ABAC)",
                "level": null,
                "requirement": "Support attribute-based access control when access decisions depend on attributes such as skills.",
                "relevance": "Directly enables using skills as attributes for matching and access decisions in assignment processes.",
                "integration_tips": "Model skills as authoritative attributes, implement ABAC policies for matching, and ensure attribute sources are validated.",
                "priority": "High",
                "verification_method": "Review ABAC policies and test that assignments respect skill attribute constraints."
              },
              {
                "standard": "OWASP",
                "req_id": "V4.2",
                "chapter": "Access Control Verification",
                "section": "Attribute-based Authorization",
                "level": "L2",
                "requirement": "Implement and verify attribute-based authorization where access and matching logic relies on user attributes (skills).",
                "relevance": "Ensures matching logic based on skills is enforced and protected from manipulation.",
                "integration_tips": "Centralize attribute evaluation, prevent client-side overrides of attributes, and audit attribute changes.",
                "priority": "High",
                "verification_method": "Attempt to alter skill attributes via API/UI and confirm authorization prevents incorrect matching."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.9.2.2",
                "chapter": "User Access Management",
                "section": "User Access Provisioning",
                "level": null,
                "requirement": "Provision access and attributes carefully to ensure accurate assignment of skills and privileges.",
                "relevance": "Requires controlled provisioning of skill attributes so matching is based on trusted data.",
                "integration_tips": "Use administrative workflows for adding/removing skills, record provenance, and require approvals for critical attributes.",
                "priority": "Medium",
                "verification_method": "Review provisioning logs and sample attribute provenance to ensure correct assignment."
              },
              {
                "standard": "NIST",
                "req_id": "PM-11",
                "chapter": "Program Management",
                "section": "Data Quality and Integrity",
                "level": null,
                "requirement": "Ensure data used for decision making (e.g., skills) is accurate and maintained.",
                "relevance": "Ensures matching results are reliable by mandating data quality controls around skills datasets.",
                "integration_tips": "Implement periodic reviews and validation of skill records and provide user workflows to correct inaccuracies.",
                "priority": "Medium",
                "verification_method": "Check data quality reports and validation procedures for skill records."
              }
            ]
          },
          {
            "high_level_requirement": "Export of data (shifts, users, companies, skills, shift types, preferences, unavailable dates) in CSV/XLSX",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "MP-6",
                "chapter": "Media Protection",
                "section": "Sanitization and Protection of Sensitive Data",
                "level": null,
                "requirement": "Protect sensitive data when exporting; sanitize or redact as required before transfer or export.",
                "relevance": "Directly applicable to preventing leakage of sensitive fields during data exports.",
                "integration_tips": "Implement export templates that redact PII or sensitive fields by role, and require explicit authorization for exports containing sensitive data.",
                "priority": "Critical",
                "verification_method": "Test exports for redaction correctness across roles and ensure sanitized outputs do not expose sensitive data."
              },
              {
                "standard": "OWASP",
                "req_id": "V3.9",
                "chapter": "Data Protection",
                "section": "Export Controls and Data Leakage Prevention",
                "level": "L2",
                "requirement": "Implement controls and authorization checks on data export features and ensure exported files do not leak sensitive data.",
                "relevance": "Specifies authorization and DLP measures for export functionality requested.",
                "integration_tips": "Require role-based export permissions, log all export operations, and throttle/alert on large exports to prevent exfiltration.",
                "priority": "High",
                "verification_method": "Review export permission mappings, audit logs of exports, and perform attempts to export restricted datasets."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.8.2.3",
                "chapter": "Asset Management",
                "section": "Handling of Assets and Sensitive Information",
                "level": null,
                "requirement": "Procedures for handling and transferring information assets including exports should be implemented.",
                "relevance": "Requires formal handling procedures for exported data assets to ensure protection and accountability.",
                "integration_tips": "Document export procedures, include approval steps for sensitive exports, and archive export copies securely if retained.",
                "priority": "Medium",
                "verification_method": "Inspect documented procedures and sample approvals for export actions."
              },
              {
                "standard": "NIST",
                "req_id": "AC-17",
                "chapter": "Remote Access",
                "section": "Controls for Remote Connection and Transfer",
                "level": null,
                "requirement": "Control remote access and transfers including file exports to prevent data exfiltration.",
                "relevance": "Applies to how exported files are transferred or downloaded to user endpoints and helps prevent exfiltration.",
                "integration_tips": "Restrict export downloads to secure channels, enforce endpoint device checks or warn about saving sensitive files, and record provenance.",
                "priority": "Medium",
                "verification_method": "Test downloads over remote sessions and verify transfer controls are enforced."
              }
            ]
          },
          {
            "high_level_requirement": "External API integration with Timefold solver including payload generation and solution parsing",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V13.1",
                "chapter": "API Security",
                "section": "Secure API Consumption and Third-party Integration",
                "level": "L2",
                "requirement": "Securely integrate with third-party APIs using mutual authentication, input/output validation, and secure error handling.",
                "relevance": "Directly addresses securing the Timefold solver integration, verifying payloads, and safely parsing responses.",
                "integration_tips": "Apply strong authentication to the Timefold API, validate all solver responses against schema, and handle errors without exposing internal details.",
                "priority": "Critical",
                "verification_method": "Inspect API authentication setup, review parsing code for schema validation, and execute malformed response tests."
              },
              {
                "standard": "NIST",
                "req_id": "SA-9",
                "chapter": "System and Services Acquisition",
                "section": "External System Interactions and API Security",
                "level": null,
                "requirement": "Ensure that external interfaces are secured and that integration with external systems follows organizational policies.",
                "relevance": "Mandates governance for integrating external solvers and ensuring compliance with internal policies.",
                "integration_tips": "Document integration requirements, include security controls in the acquisition process, and require supplier security attestations.",
                "priority": "High",
                "verification_method": "Review acquisition/integration documentation and evidence of supplier security posture checks."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.5",
                "chapter": "System Acquisition, Development and Maintenance",
                "section": "Secure development practices for interfaces",
                "level": null,
                "requirement": "Security requirements for development and integration of interfaces should be defined and implemented.",
                "relevance": "Ensures development practices for payload generation and parsing include security requirements to avoid vulnerabilities.",
                "integration_tips": "Define interface contracts, include input/output validation, and perform secure code reviews and testing for parsing logic.",
                "priority": "Medium",
                "verification_method": "Inspect interface contracts and review secure development artifacts and test results."
              },
              {
                "standard": "NIST",
                "req_id": "SC-8",
                "chapter": "System and Communications Protection",
                "section": "Transmission Confidentiality and Integrity",
                "level": null,
                "requirement": "Protect the confidentiality and integrity of information during transmission to external services.",
                "relevance": "Ensures payloads and solutions exchanged with Timefold are protected from interception or tampering.",
                "integration_tips": "Use TLS, validate certificates, and consider message signing to ensure end-to-end integrity.",
                "priority": "High",
                "verification_method": "Verify TLS config, perform MITM tests, and validate signature verification if implemented."
              }
            ]
          },
          {
            "high_level_requirement": "Internationalization (multi-language UI and localized date/time formatting)",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V9.7",
                "chapter": "Internationalization and Encoding",
                "section": "Unicode and Encoding Handling",
                "level": "L2",
                "requirement": "Properly handle Unicode, normalization, and encoding to prevent injection and XSS vulnerabilities across locales.",
                "relevance": "Directly relevant for multi-language UI and localized date/time handling to avoid injection vectors introduced by locale-specific encodings.",
                "integration_tips": "Normalize and canonicalize text inputs/outputs, apply proper encoding/escaping per output context, and validate locale-specific formats.",
                "priority": "High",
                "verification_method": "Test inputs with various Unicode characters and locale-specific formats to detect XSS or parsing issues."
              },
              {
                "standard": "NIST",
                "req_id": "SC-17",
                "chapter": "System and Communications Protection",
                "section": "Public Key Infrastructure and Localisation considerations",
                "level": null,
                "requirement": "Ensure localized data formats and time/date handling do not weaken security mechanisms and are consistently handled.",
                "relevance": "Ensures localized formatting does not break security checks like signature verification or token expiry calculations.",
                "integration_tips": "Use locale-aware libraries for date/time parsing, store timestamps in canonical format (UTC) internally, and format only at presentation layer.",
                "priority": "Medium",
                "verification_method": "Review date/time handling code and test across locales for consistent behavior of security-sensitive features."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.14.2.5",
                "chapter": "System Acquisition, Development and Maintenance",
                "section": "Secure development practices for localization",
                "level": null,
                "requirement": "Include security requirements for localized applications and data handling in development.",
                "relevance": "Mandates inclusion of localization security needs in development practices for internationalized UI.",
                "integration_tips": "Include localization security checks in SDLC, perform code reviews focused on encoding/formatting, and update test suites for locales.",
                "priority": "Low",
                "verification_method": "Inspect development checklists and localized test cases for security considerations."
              },
              {
                "standard": "OWASP",
                "req_id": "V9.1",
                "chapter": "Input Validation",
                "section": "Locale-aware Input Validation",
                "level": "L1",
                "requirement": "Validate and canonicalize input considering locale-specific encodings and formats.",
                "relevance": "Supports safe handling of user inputs in various languages and formats to prevent logic or parsing errors.",
                "integration_tips": "Implement validators that accept locale-specific formats but convert to canonical representations for processing and storage.",
                "priority": "Medium",
                "verification_method": "Run locale-specific input validation tests and check canonicalization outputs."
              }
            ]
          },
          {
            "high_level_requirement": "User interface features: responsive navigation, tables with pagination/sorting/filtering, calendar views, alerts/notifications, breadcrumbs",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "OWASP",
                "req_id": "V9.2",
                "chapter": "Injection Prevention and XSS",
                "section": "Cross-Site Scripting and Output Encoding",
                "level": "L1",
                "requirement": "Encode output and validate input to prevent XSS, especially in tables, filters, and dynamic navigation elements.",
                "relevance": "Directly applies to UI elements which render user-controlled content and are susceptible to XSS and injection attacks.",
                "integration_tips": "Escape/encode user data in the proper HTML/JS context, apply CSP headers, and avoid dangerous innerHTML patterns.",
                "priority": "Critical",
                "verification_method": "Perform XSS testing across UI components including pagination and dynamic filters."
              },
              {
                "standard": "NIST",
                "req_id": "SI-10",
                "chapter": "Software Integrity",
                "section": "Input Validation and Error Handling",
                "level": null,
                "requirement": "Validate input and handle errors gracefully to avoid exposing sensitive information in UI components.",
                "relevance": "Encourages sanitizing/filtering user inputs used for sorting/pagination and ensuring error messages do not leak internals.",
                "integration_tips": "Validate query parameters for pagination/sorting on server-side and sanitize user-visible error messages.",
                "priority": "High",
                "verification_method": "Review server-side validation for UI query parameters and inspect error messages for sensitive info."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.12.2.1",
                "chapter": "Protection from Malware",
                "section": "Controls for application security",
                "level": null,
                "requirement": "Apply secure development and application-level controls to mitigate common application threats.",
                "relevance": "Provides general secure development guidance for UI features to reduce vulnerabilities like XSS and CSRF.",
                "integration_tips": "Adopt secure UI development practices, include security tests in CI, and ensure third-party UI libs are vetted.",
                "priority": "Medium",
                "verification_method": "Check secure development artifacts, dependency scans, and UI security test results."
              },
              {
                "standard": "OWASP",
                "req_id": "V5.4",
                "chapter": "Session Management",
                "section": "CSRF Protections",
                "level": "L1",
                "requirement": "Implement CSRF protections for state-changing UI actions like shift creation or accept/reject.",
                "relevance": "Protects UI actions (calendar interactions, form submissions) from CSRF attacks that could create/change shifts.",
                "integration_tips": "Use anti-CSRF tokens for state-modifying requests and validate origin/referrer where appropriate.",
                "priority": "High",
                "verification_method": "Perform CSRF attack simulations against state-changing endpoints and verify tokens are required and validated."
              }
            ]
          },
          {
            "high_level_requirement": "Audit logging, legal documents availability (Privacy Policy, Terms of Service), and consent tracking",
            "requirement_id": null,
            "security_controls": [
              {
                "standard": "NIST",
                "req_id": "AU-2",
                "chapter": "Audit and Accountability",
                "section": "Audit Events",
                "level": null,
                "requirement": "Determine and log auditable events including user consent and policy acceptance.",
                "relevance": "Directly maps to logging consent events and availability of legal document acceptance records.",
                "integration_tips": "Log consent events with timestamp, user ID, document version, and store immutably; ensure logs are searchable for audit.",
                "priority": "Critical",
                "verification_method": "Review consent logs, verify they contain required fields, and test retrieval for audit scenarios."
              },
              {
                "standard": "ISO27001",
                "req_id": "A.18.1.4",
                "chapter": "Compliance",
                "section": "Privacy and Data Protection in Automated Processing",
                "level": null,
                "requirement": "Ensure compliance with privacy requirements and record legal consents and policy acknowledgments.",
                "relevance": "Establishes requirement to track legal consents and ensure privacy compliance for policy-driven behaviors.",
                "integration_tips": "Retain versions of legal documents, capture consent metadata, and provide user-facing access to documents and consent history.",
                "priority": "High",
                "verification_method": "Verify retention of document versions and sample consent records match user acknowledgments."
              },
              {
                "standard": "OWASP",
                "req_id": "V10.3",
                "chapter": "Logging and Monitoring",
                "section": "Consent and Legal Events Logging",
                "level": "L1",
                "requirement": "Log legal acknowledgements and consent events and ensure integrity of such records.",
                "relevance": "Specifies logging of legal events and integrity protections which are key to proving consent.",
                "integration_tips": "Use tamper-evident storage for consent records or append-only logs and ensure access controls over consent records.",
                "priority": "High",
                "verification_method": "Attempt to alter consent records in test environment and verify tamper detection and access controls."
              },
              {
                "standard": "NIST",
                "req_id": "PL-2",
                "chapter": "Planning",
                "section": "System and Communications Protection Policy",
                "level": null,
                "requirement": "Establish policies for handling legal documents and consent records.",
                "relevance": "Requires formal policies governing how legal documents and consent are managed within the system.",
                "integration_tips": "Develop policy that defines retention, access, and usage of consent records and implement controls accordingly.",
                "priority": "Medium",
                "verification_method": "Review policy documentation and evidence of policy enforcement in system practices."
              }
            ]
          }
        ],
        "cross_functional_controls": [
          {
            "control_name": "Logging and Audit Trails",
            "description": "Centralized, tamper-resistant logging of security-relevant events including authentication, authorization changes, exports, consent events, solver interactions, and algorithmic outputs.",
            "applies_to": [
              "All requirements (global)",
              "Audit logging features",
              "Automated assignment and solver integration",
              "Data export and profile changes"
            ],
            "implementation_guidance": "Implement an append-only or integrity-protected logging system (WORM or signed logs), centralize logs with access controls, and define retention and review processes. Ensure logs capture actor, timestamp, action, target resource and before/after states where applicable."
          },
          {
            "control_name": "Encryption in Transit and at Rest",
            "description": "Protect sensitive data (credentials, PII, solver payloads, exported files) with strong encryption during transit and at rest.",
            "applies_to": [
              "Authentication flows",
              "External API integrations",
              "Asynchronous job payloads",
              "Exported files and sensitive data stores"
            ],
            "implementation_guidance": "Use TLS with current best-practice cipher suites for all external and internal communication; encrypt data at rest with managed keys and apply field-level encryption for highly sensitive fields. Rotate keys and manage access to encryption keys via KMS with strict IAM controls."
          },
          {
            "control_name": "Input Validation and Output Encoding",
            "description": "Canonicalize, validate and sanitize inputs; encode outputs according to their context to prevent injection (XSS, SQLi) and logic bypass.",
            "applies_to": [
              "UI components (tables, filters, calendar)",
              "Shift/skill/leave creation and updates",
              "API payloads and external solver responses"
            ],
            "implementation_guidance": "Implement server-side canonicalization and validation for all inputs, apply context-aware encoding on outputs, and use schema validation for APIs. Include locale-aware validation for internationalized inputs and test with Unicode edge-cases."
          },
          {
            "control_name": "Access Control and Authorization",
            "description": "Centralized enforcement of role-based and attribute-based access controls, with least privilege and tenant scoping.",
            "applies_to": [
              "RBAC and user status",
              "Company CRUD/multi-tenant scoping",
              "Profile and assignment management",
              "Export and administrative functions"
            ],
            "implementation_guidance": "Use a centralized authorization service or middleware enforcing RBAC/ABAC checks at every API entrypoint, include tenant_id in access decisions, and implement policy management and review processes to keep permissions up-to-date."
          },
          {
            "control_name": "Privacy and Data Minimization",
            "description": "Assess and minimize personal data collection (preferences, leave reasons) and protect special categories of data with additional safeguards.",
            "applies_to": [
              "Preferences and leave management",
              "Exports and reporting",
              "Algorithmic scoring and solver inputs/outputs"
            ],
            "implementation_guidance": "Conduct PIAs for sensitive data, apply pseudonymization or redaction for exports, limit retention periods, and restrict access to need-to-know personnel. Record legal basis and user consent where required."
          }
        ],
        "recommended_asvs_level": "L2"
      }
    }
  ]
}